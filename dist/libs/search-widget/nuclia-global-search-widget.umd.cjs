(function(L){typeof define=="function"&&define.amd?define(L):L()})(function(){"use strict";var Lp=Object.defineProperty;var zp=(L,dt,ft)=>dt in L?Lp(L,dt,{enumerable:!0,configurable:!0,writable:!0,value:ft}):L[dt]=ft;var H=(L,dt,ft)=>(zp(L,typeof dt!="symbol"?dt+"":dt,ft),ft);function L(){}function dt(t,e){for(const n in e)t[n]=e[n];return t}function ft(t){return t()}function Hi(){return Object.create(null)}function Re(t){t.forEach(ft)}function Qt(t){return typeof t=="function"}function Pe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let On;function Fl(t,e){return On||(On=document.createElement("a")),On.href=e,t===On.href}function Wi(t){return Object.keys(t).length===0}function Cl(t,...e){if(t==null)return L;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function U(t,e,n){t.$$.on_destroy.push(Cl(e,n))}function Er(t,e,n,r){if(t){const i=Vi(t,e,n,r);return t[0](i)}}function Vi(t,e,n,r){return t[1]&&r?dt(n.ctx.slice(),t[1](r(e))):n.ctx}function Ar(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const s=[],o=Math.max(e.dirty.length,i.length);for(let a=0;a<o;a+=1)s[a]=e.dirty[a]|i[a];return s}return e.dirty|i}return e.dirty}function Ir(t,e,n,r,i,s){if(i){const o=Vi(e,n,r,s);t.p(o,i)}}function xr(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function Gi(t){return t&&Qt(t.destroy)?t.destroy:L}const Ji=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function x(t,e){t.appendChild(e)}function De(t,e,n){const r=$l(t);if(!r.getElementById(e)){const i=k("style");i.id=e,i.textContent=n,jl(r,i)}}function $l(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function jl(t,e){return x(t.head||t,e),e.sheet}function R(t,e,n){t.insertBefore(e,n||null)}function T(t){t.parentNode&&t.parentNode.removeChild(t)}function Fn(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function k(t){return document.createElement(t)}function Ki(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function de(t){return document.createTextNode(t)}function K(){return de(" ")}function Ze(){return de("")}function V(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function Ml(t){return function(e){return e.preventDefault(),t.call(this,e)}}function b(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Nl(t){return Array.from(t.childNodes)}function we(t,e){e=""+e,t.data!==e&&(t.data=e)}function Qi(t,e){t.value=e??""}function Ce(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}let Cn;function Ll(){if(Cn===void 0){Cn=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Cn=!0}}return Cn}function zl(t,e){getComputedStyle(t).position==="static"&&(t.style.position="relative");const r=k("iframe");r.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),r.setAttribute("aria-hidden","true"),r.tabIndex=-1;const i=Ll();let s;return i?(r.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",s=V(window,"message",o=>{o.source===r.contentWindow&&e()})):(r.src="about:blank",r.onload=()=>{s=V(r.contentWindow,"resize",e),e()}),x(t,r),()=>{(i||s&&r.contentWindow)&&s(),T(r)}}function G(t,e,n){t.classList[n?"add":"remove"](e)}function Dl(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}function Ul(t){const e={};for(const n of t)e[n.name]=n.value;return e}let dn;function fn(t){dn=t}function $n(){if(!dn)throw new Error("Function called outside component initialization");return dn}function hn(t){$n().$$.on_mount.push(t)}function Bl(t){$n().$$.on_destroy.push(t)}function St(){const t=$n();return(e,n,{cancelable:r=!1}={})=>{const i=t.$$.callbacks[e];if(i){const s=Dl(e,n,{cancelable:r});return i.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}function Tr(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const Xt=[],Et=[];let Yt=[];const Xi=[],Yi=Promise.resolve();let Rr=!1;function Zi(){Rr||(Rr=!0,Yi.then(ke))}function ql(){return Zi(),Yi}function Zt(t){Yt.push(t)}const Pr=new Set;let en=0;function ke(){if(en!==0)return;const t=dn;do{try{for(;en<Xt.length;){const e=Xt[en];en++,fn(e),Hl(e.$$)}}catch(e){throw Xt.length=0,en=0,e}for(fn(null),Xt.length=0,en=0;Et.length;)Et.pop()();for(let e=0;e<Yt.length;e+=1){const n=Yt[e];Pr.has(n)||(Pr.add(n),n())}Yt.length=0}while(Xt.length);for(;Xi.length;)Xi.pop()();Rr=!1,Pr.clear(),fn(t)}function Hl(t){if(t.fragment!==null){t.update(),Re(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Zt)}}function Wl(t){const e=[],n=[];Yt.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Yt=e}const jn=new Set;let Mt;function pe(){Mt={r:0,c:[],p:Mt}}function ge(){Mt.r||Re(Mt.c),Mt=Mt.p}function w(t,e){t&&t.i&&(jn.delete(t),t.i(e))}function P(t,e,n,r){if(t&&t.o){if(jn.has(t))return;jn.add(t),Mt.c.push(()=>{jn.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function Vl(t,e){P(t,1,1,()=>{e.delete(t.key)})}function Gl(t,e,n,r,i,s,o,a,l,c,u,d){let f=t.length,h=s.length,g=f;const p={};for(;g--;)p[t[g].key]=g;const _=[],v=new Map,m=new Map,C=[];for(g=h;g--;){const $=d(i,s,g),O=n($);let j=o.get(O);j?r&&C.push(()=>j.p($,e)):(j=c(O,$),j.c()),v.set(O,_[g]=j),O in p&&m.set(O,Math.abs(g-p[O]))}const y=new Set,S=new Set;function I($){w($,1),$.m(a,u),o.set($.key,$),u=$.first,h--}for(;f&&h;){const $=_[h-1],O=t[f-1],j=$.key,oe=O.key;$===O?(u=$.first,f--,h--):v.has(oe)?!o.has(j)||y.has(j)?I($):S.has(oe)?f--:m.get(j)>m.get(oe)?(S.add(j),I($)):(y.add(oe),f--):(l(O,o),f--)}for(;f--;){const $=t[f];v.has($.key)||l($,o)}for(;h;)I(_[h-1]);return Re(C),_}function ae(t){t&&t.c()}function ie(t,e,n,r){const{fragment:i,after_update:s}=t.$$;i&&i.m(e,n),r||Zt(()=>{const o=t.$$.on_mount.map(ft).filter(Qt);t.$$.on_destroy?t.$$.on_destroy.push(...o):Re(o),t.$$.on_mount=[]}),s.forEach(Zt)}function te(t,e){const n=t.$$;n.fragment!==null&&(Wl(n.after_update),Re(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Jl(t,e){t.$$.dirty[0]===-1&&(Xt.push(t),Zi(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Oe(t,e,n,r,i,s,o,a=[-1]){const l=dn;fn(t);const c=t.$$={fragment:null,ctx:[],props:s,update:L,not_equal:i,bound:Hi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Hi(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(c.root);let u=!1;if(c.ctx=n?n(t,e.props||{},(d,f,...h)=>{const g=h.length?h[0]:f;return c.ctx&&i(c.ctx[d],c.ctx[d]=g)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](g),u&&Jl(t,d)),f}):[],c.update(),u=!0,Re(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const d=Nl(e.target);c.fragment&&c.fragment.l(d),d.forEach(T)}else c.fragment&&c.fragment.c();e.intro&&w(t.$$.fragment),ie(t,e.target,e.anchor,e.customElement),ke()}fn(l)}let es;typeof HTMLElement=="function"&&(es=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(ft).filter(Qt);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){Re(this.$$.on_disconnect)}$destroy(){te(this,1),this.$destroy=L}$on(t,e){if(!Qt(e))return L;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const r=n.indexOf(e);r!==-1&&n.splice(r,1)}}$set(t){this.$$set&&!Wi(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class $e{$destroy(){te(this,1),this.$destroy=L}$on(e,n){if(!Qt(n))return L;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!Wi(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var Or=function(t,e){return Or=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Or(t,e)};function et(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Or(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Mn=function(){return Mn=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Mn.apply(this,arguments)};function Kl(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Ql(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function ts(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(n=0)),n;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function tn(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Nt(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function Lt(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}function nn(t){return this instanceof nn?(this.v=t,this):new nn(t)}function Xl(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(f){r[f]&&(i[f]=function(h){return new Promise(function(g,p){s.push([f,h,g,p])>1||a(f,h)})})}function a(f,h){try{l(r[f](h))}catch(g){d(s[0][3],g)}}function l(f){f.value instanceof nn?Promise.resolve(f.value.v).then(c,u):d(s[0][2],f)}function c(f){a("next",f)}function u(f){a("throw",f)}function d(f,h){f(h),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Yl(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof tn=="function"?tn(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,l){o=t[s](o),i(a,l,o.done,o.value)})}}function i(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}}function ne(t){return typeof t=="function"}function Fr(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Cr=Fr(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function Nn(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var pn=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,i,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var a=tn(o),l=a.next();!l.done;l=a.next()){var c=l.value;c.remove(this)}}catch(p){e={error:p}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(ne(u))try{u()}catch(p){s=p instanceof Cr?p.errors:[p]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=tn(d),h=f.next();!h.done;h=f.next()){var g=h.value;try{is(g)}catch(p){s=s??[],p instanceof Cr?s=Lt(Lt([],Nt(s)),Nt(p.errors)):s.push(p)}}}catch(p){r={error:p}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(s)throw new Cr(s)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)is(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&Nn(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&Nn(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),ns=pn.EMPTY;function rs(t){return t instanceof pn||t&&"closed"in t&&ne(t.remove)&&ne(t.add)&&ne(t.unsubscribe)}function is(t){ne(t)?t():t.unsubscribe()}var ss={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},$r={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=$r.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,Lt([t,e],Nt(n))):setTimeout.apply(void 0,Lt([t,e],Nt(n)))},clearTimeout:function(t){var e=$r.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function os(t){$r.setTimeout(function(){throw t})}function as(){}function Ln(t){t()}var jr=function(t){et(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,rs(n)&&n.add(r)):r.destination=nc,r}return e.create=function(n,r,i){return new zn(n,r,i)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(pn),Zl=Function.prototype.bind;function Mr(t,e){return Zl.call(t,e)}var ec=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){Dn(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){Dn(r)}else Dn(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){Dn(n)}},t}(),zn=function(t){et(e,t);function e(n,r,i){var s=t.call(this)||this,o;if(ne(n)||!n)o={next:n??void 0,error:r??void 0,complete:i??void 0};else{var a;s&&ss.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=function(){return s.unsubscribe()},o={next:n.next&&Mr(n.next,a),error:n.error&&Mr(n.error,a),complete:n.complete&&Mr(n.complete,a)}):o=n}return s.destination=new ec(o),s}return e}(jr);function Dn(t){os(t)}function tc(t){throw t}var nc={closed:!0,next:as,error:tc,complete:as},Nr=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function rn(t){return t}function rc(t){return t.length===0?rn:t.length===1?t[0]:function(n){return t.reduce(function(r,i){return i(r)},n)}}var ve=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var i=this,s=sc(e)?e:new zn(e,n,r);return Ln(function(){var o=i,a=o.operator,l=o.source;s.add(a?a.call(s,l):l?i._subscribe(s):i._trySubscribe(s))}),s},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=ls(n),new n(function(i,s){var o=new zn({next:function(a){try{e(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:i});r.subscribe(o)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[Nr]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return rc(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=ls(e),new e(function(r,i){var s;n.subscribe(function(o){return s=o},function(o){return i(o)},function(){return r(s)})})},t.create=function(e){return new t(e)},t}();function ls(t){var e;return(e=t??ss.Promise)!==null&&e!==void 0?e:Promise}function ic(t){return t&&ne(t.next)&&ne(t.error)&&ne(t.complete)}function sc(t){return t&&t instanceof jr||ic(t)&&rs(t)}function oc(t){return ne(t==null?void 0:t.lift)}function Ue(t){return function(e){if(oc(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Se(t,e,n,r,i){return new ac(t,e,n,r,i)}var ac=function(t){et(e,t);function e(n,r,i,s,o,a){var l=t.call(this,n)||this;return l.onFinalize=o,l.shouldUnsubscribe=a,l._next=r?function(c){try{r(c)}catch(u){n.error(u)}}:t.prototype._next,l._error=s?function(c){try{s(c)}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=i?function(){try{i()}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(jr),lc=Fr(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),zt=function(t){et(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new cs(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new lc},e.prototype.next=function(n){var r=this;Ln(function(){var i,s;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var o=tn(r.currentObservers),a=o.next();!a.done;a=o.next()){var l=a.value;l.next(n)}}catch(c){i={error:c}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}}})},e.prototype.error=function(n){var r=this;Ln(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var i=r.observers;i.length;)i.shift().error(n)}})},e.prototype.complete=function(){var n=this;Ln(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,i=this,s=i.hasError,o=i.isStopped,a=i.observers;return s||o?ns:(this.currentObservers=null,a.push(n),new pn(function(){r.currentObservers=null,Nn(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,i=r.hasError,s=r.thrownError,o=r.isStopped;i?n.error(s):o&&n.complete()},e.prototype.asObservable=function(){var n=new ve;return n.source=this,n},e.create=function(n,r){return new cs(n,r)},e}(ve),cs=function(t){et(e,t);function e(n,r){var i=t.call(this)||this;return i.destination=n,i.source=r,i}return e.prototype.next=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,n)},e.prototype.error=function(n){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&i!==void 0?i:ns},e}(zt),gn=function(t){et(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,i=n.thrownError,s=n._value;if(r)throw i;return this._throwIfClosed(),s},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(zt),Lr={now:function(){return(Lr.delegate||Date).now()},delegate:void 0},cc=function(t){et(e,t);function e(n,r,i){n===void 0&&(n=1/0),r===void 0&&(r=1/0),i===void 0&&(i=Lr);var s=t.call(this)||this;return s._bufferSize=n,s._windowTime=r,s._timestampProvider=i,s._buffer=[],s._infiniteTimeWindow=!0,s._infiniteTimeWindow=r===1/0,s._bufferSize=Math.max(1,n),s._windowTime=Math.max(1,r),s}return e.prototype.next=function(n){var r=this,i=r.isStopped,s=r._buffer,o=r._infiniteTimeWindow,a=r._timestampProvider,l=r._windowTime;i||(s.push(n),!o&&s.push(a.now()+l)),this._trimBuffer(),t.prototype.next.call(this,n)},e.prototype._subscribe=function(n){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(n),i=this,s=i._infiniteTimeWindow,o=i._buffer,a=o.slice(),l=0;l<a.length&&!n.closed;l+=s?1:2)n.next(a[l]);return this._checkFinalizedStatuses(n),r},e.prototype._trimBuffer=function(){var n=this,r=n._bufferSize,i=n._timestampProvider,s=n._buffer,o=n._infiniteTimeWindow,a=(o?1:2)*r;if(r<1/0&&a<s.length&&s.splice(0,s.length-a),!o){for(var l=i.now(),c=0,u=1;u<s.length&&s[u]<=l;u+=2)c=u;c&&s.splice(0,c+1)}},e}(zt),uc=function(t){et(e,t);function e(n,r){return t.call(this)||this}return e.prototype.schedule=function(n,r){return this},e}(pn),Un={setInterval:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Un.delegate;return i!=null&&i.setInterval?i.setInterval.apply(i,Lt([t,e],Nt(n))):setInterval.apply(void 0,Lt([t,e],Nt(n)))},clearInterval:function(t){var e=Un.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},dc=function(t){et(e,t);function e(n,r){var i=t.call(this,n,r)||this;return i.scheduler=n,i.work=r,i.pending=!1,i}return e.prototype.schedule=function(n,r){var i;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var s=this.id,o=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(o,s,r)),this.pending=!0,this.delay=r,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,r),this},e.prototype.requestAsyncId=function(n,r,i){return i===void 0&&(i=0),Un.setInterval(n.flush.bind(n,this),i)},e.prototype.recycleAsyncId=function(n,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;r!=null&&Un.clearInterval(r)},e.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(n,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,r){var i=!1,s;try{this.work(n)}catch(o){i=!0,s=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,i=n.scheduler,s=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Nn(s,this),r!=null&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(uc),us=function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(r,n)},t.now=Lr.now,t}(),fc=function(t){et(e,t);function e(n,r){r===void 0&&(r=us.now);var i=t.call(this,n,r)||this;return i.actions=[],i._active=!1,i}return e.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var i;this._active=!0;do if(i=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,i){for(;n=r.shift();)n.unsubscribe();throw i}},e}(us),ds=new fc(dc),hc=ds,Bn=new ve(function(t){return t.complete()});function fs(t){return t&&ne(t.schedule)}function zr(t){return t[t.length-1]}function hs(t){return ne(zr(t))?t.pop():void 0}function vn(t){return fs(zr(t))?t.pop():void 0}function pc(t,e){return typeof zr(t)=="number"?t.pop():e}var ps=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function gs(t){return ne(t==null?void 0:t.then)}function vs(t){return ne(t[Nr])}function _s(t){return Symbol.asyncIterator&&ne(t==null?void 0:t[Symbol.asyncIterator])}function ms(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function gc(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var ys=gc();function bs(t){return ne(t==null?void 0:t[ys])}function ws(t){return Xl(this,arguments,function(){var n,r,i,s;return ts(this,function(o){switch(o.label){case 0:n=t.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,nn(n.read())];case 3:return r=o.sent(),i=r.value,s=r.done,s?[4,nn(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,nn(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function ks(t){return ne(t==null?void 0:t.getReader)}function Qe(t){if(t instanceof ve)return t;if(t!=null){if(vs(t))return vc(t);if(ps(t))return _c(t);if(gs(t))return mc(t);if(_s(t))return Ss(t);if(bs(t))return yc(t);if(ks(t))return bc(t)}throw ms(t)}function vc(t){return new ve(function(e){var n=t[Nr]();if(ne(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function _c(t){return new ve(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function mc(t){return new ve(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,os)})}function yc(t){return new ve(function(e){var n,r;try{for(var i=tn(t),s=i.next();!s.done;s=i.next()){var o=s.value;if(e.next(o),e.closed)return}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()})}function Ss(t){return new ve(function(e){wc(t,e).catch(function(n){return e.error(n)})})}function bc(t){return Ss(ws(t))}function wc(t,e){var n,r,i,s;return Ql(this,void 0,void 0,function(){var o,a;return ts(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=Yl(t),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(o=r.value,e.next(o),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),i={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function ht(t,e,n,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Es(t,e){return e===void 0&&(e=0),Ue(function(n,r){n.subscribe(Se(r,function(i){return ht(r,t,function(){return r.next(i)},e)},function(){return ht(r,t,function(){return r.complete()},e)},function(i){return ht(r,t,function(){return r.error(i)},e)}))})}function As(t,e){return e===void 0&&(e=0),Ue(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function kc(t,e){return Qe(t).pipe(As(e),Es(e))}function Sc(t,e){return Qe(t).pipe(As(e),Es(e))}function Ec(t,e){return new ve(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Ac(t,e){return new ve(function(n){var r;return ht(n,e,function(){r=t[ys](),ht(n,e,function(){var i,s,o;try{i=r.next(),s=i.value,o=i.done}catch(a){n.error(a);return}o?n.complete():n.next(s)},0,!0)}),function(){return ne(r==null?void 0:r.return)&&r.return()}})}function Is(t,e){if(!t)throw new Error("Iterable cannot be null");return new ve(function(n){ht(n,e,function(){var r=t[Symbol.asyncIterator]();ht(n,e,function(){r.next().then(function(i){i.done?n.complete():n.next(i.value)})},0,!0)})})}function Ic(t,e){return Is(ws(t),e)}function xc(t,e){if(t!=null){if(vs(t))return kc(t,e);if(ps(t))return Ec(t,e);if(gs(t))return Sc(t,e);if(_s(t))return Is(t,e);if(bs(t))return Ac(t,e);if(ks(t))return Ic(t,e)}throw ms(t)}function fe(t,e){return e?xc(t,e):Qe(t)}function B(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=vn(t);return fe(t,n)}function Dr(t,e){var n=ne(t)?t:function(){return t},r=function(i){return i.error(n())};return new ve(e?function(i){return e.schedule(r,0,i)}:r)}var Tc=Fr(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}});function Rc(t,e){var n=typeof e=="object";return new Promise(function(r,i){var s=new zn({next:function(o){r(o),s.unsubscribe()},error:i,complete:function(){n?r(e.defaultValue):i(new Tc)}});t.subscribe(s)})}function Pc(t){return t instanceof Date&&!isNaN(t)}function E(t,e){return Ue(function(n,r){var i=0;n.subscribe(Se(r,function(s){r.next(t.call(e,s,i++))}))})}var Oc=Array.isArray;function Fc(t,e){return Oc(e)?t.apply(void 0,Lt([],Nt(e))):t(e)}function xs(t){return E(function(e){return Fc(t,e)})}var Cc=Array.isArray,$c=Object.getPrototypeOf,jc=Object.prototype,Mc=Object.keys;function Ts(t){if(t.length===1){var e=t[0];if(Cc(e))return{args:e,keys:null};if(Nc(e)){var n=Mc(e);return{args:n.map(function(r){return e[r]}),keys:n}}}return{args:t,keys:null}}function Nc(t){return t&&typeof t=="object"&&$c(t)===jc}function Rs(t,e){return t.reduce(function(n,r,i){return n[r]=e[i],n},{})}function tt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=vn(t),r=hs(t),i=Ts(t),s=i.args,o=i.keys;if(s.length===0)return fe([],n);var a=new ve(Lc(s,n,o?function(l){return Rs(o,l)}:rn));return r?a.pipe(xs(r)):a}function Lc(t,e,n){return n===void 0&&(n=rn),function(r){Ps(e,function(){for(var i=t.length,s=new Array(i),o=i,a=i,l=function(u){Ps(e,function(){var d=fe(t[u],e),f=!1;d.subscribe(Se(r,function(h){s[u]=h,f||(f=!0,a--),a||r.next(n(s.slice()))},function(){--o||r.complete()}))},r)},c=0;c<i;c++)l(c)},r)}}function Ps(t,e,n){t?ht(n,t,e):e()}function zc(t,e,n,r,i,s,o,a){var l=[],c=0,u=0,d=!1,f=function(){d&&!l.length&&!c&&e.complete()},h=function(p){return c<r?g(p):l.push(p)},g=function(p){s&&e.next(p),c++;var _=!1;Qe(n(p,u++)).subscribe(Se(e,function(v){i==null||i(v),s?h(v):e.next(v)},function(){_=!0},void 0,function(){if(_)try{c--;for(var v=function(){var m=l.shift();o?ht(e,o,function(){return g(m)}):g(m)};l.length&&c<r;)v();f()}catch(m){e.error(m)}}))};return t.subscribe(Se(e,h,function(){d=!0,f()})),function(){a==null||a()}}function _n(t,e,n){return n===void 0&&(n=1/0),ne(e)?_n(function(r,i){return E(function(s,o){return e(r,s,i,o)})(Qe(t(r,i)))},n):(typeof e=="number"&&(n=e),Ue(function(r,i){return zc(r,i,t,n)}))}function Os(t){return t===void 0&&(t=1/0),_n(rn,t)}function Dc(){return Os(1)}function Fs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Dc()(fe(t,vn(t)))}function qn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=hs(t),r=Ts(t),i=r.args,s=r.keys,o=new ve(function(a){var l=i.length;if(!l){a.complete();return}for(var c=new Array(l),u=l,d=l,f=function(g){var p=!1;Qe(i[g]).subscribe(Se(a,function(_){p||(p=!0,d--),c[g]=_},function(){return u--},void 0,function(){(!u||!p)&&(d||a.next(s?Rs(s,c):c),a.complete())}))},h=0;h<l;h++)f(h)});return n?o.pipe(xs(n)):o}function Cs(t,e,n){t===void 0&&(t=0),n===void 0&&(n=hc);var r=-1;return e!=null&&(fs(e)?n=e:r=e),new ve(function(i){var s=Pc(t)?+t-n.now():t;s<0&&(s=0);var o=0;return n.schedule(function(){i.closed||(i.next(o++),0<=r?this.schedule(void 0,r):i.complete())},s)})}function $s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=vn(t),r=pc(t,1/0),i=t;return i.length?i.length===1?Qe(i[0]):Os(r)(fe(i,n)):Bn}function le(t,e){return Ue(function(n,r){var i=0;n.subscribe(Se(r,function(s){return t.call(e,s,i++)&&r.next(s)}))})}function Uc(t,e,n){if(e==null&&(e=t,t=0),e<=0)return Bn;var r=e+t;return new ve(n?function(i){var s=t;return n.schedule(function(){s<r?(i.next(s++),this.schedule()):i.complete()})}:function(i){for(var s=t;s<r&&!i.closed;)i.next(s++);i.complete()})}function Be(t){return Ue(function(e,n){var r=null,i=!1,s;r=e.subscribe(Se(n,void 0,void 0,function(o){s=Qe(t(o,Be(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function Ur(t,e){return ne(e)?_n(t,e,1):_n(t,1)}function js(t,e){return e===void 0&&(e=ds),Ue(function(n,r){var i=null,s=null,o=null,a=function(){if(i){i.unsubscribe(),i=null;var c=s;s=null,r.next(c)}};function l(){var c=o+t,u=e.now();if(u<c){i=this.schedule(void 0,c-u),r.add(i);return}a()}n.subscribe(Se(r,function(c){s=c,o=e.now(),i||(i=e.schedule(l,t),r.add(i))},function(){a(),r.complete()},void 0,function(){s=i=null}))})}function se(t){return t<=0?function(){return Bn}:Ue(function(e,n){var r=0;e.subscribe(Se(n,function(i){++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function At(t,e){return e===void 0&&(e=rn),t=t??Bc,Ue(function(n,r){var i,s=!0;n.subscribe(Se(r,function(o){var a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function Bc(t,e){return t===e}function Ms(t){var e,n=1/0,r;return t!=null&&(typeof t=="object"?(e=t.count,n=e===void 0?1/0:e,r=t.delay):n=t),n<=0?function(){return Bn}:Ue(function(i,s){var o=0,a,l=function(){if(a==null||a.unsubscribe(),a=null,r!=null){var u=typeof r=="number"?Cs(r):Qe(r(o)),d=Se(s,function(){d.unsubscribe(),c()});u.subscribe(d)}else c()},c=function(){var u=!1;a=i.subscribe(Se(s,void 0,function(){++o<n?a?l():u=!0:s.complete()})),u&&l()};c()})}function Ns(t){return le(function(e,n){return t<=n})}function qc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=vn(t);return Ue(function(r,i){(n?Fs(t,r,n):Fs(t,r)).subscribe(i)})}function z(t,e){return Ue(function(n,r){var i=null,s=0,o=!1,a=function(){return o&&!i&&r.complete()};n.subscribe(Se(r,function(l){i==null||i.unsubscribe();var c=0,u=s++;Qe(t(l,u)).subscribe(i=Se(r,function(d){return r.next(e?e(l,d,u,c++):d)},function(){i=null,a()}))},function(){o=!0,a()}))})}function qe(t,e,n){var r=ne(t)||e||n?{next:t,error:e,complete:n}:t;return r?Ue(function(i,s){var o;(o=r.subscribe)===null||o===void 0||o.call(r);var a=!0;i.subscribe(Se(s,function(l){var c;(c=r.next)===null||c===void 0||c.call(r,l),s.next(l)},function(){var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),s.complete()},function(l){var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,l),s.error(l)},function(){var l,c;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):rn}function Ls(t,e){e===void 0&&(e={});var n=e.selector,r=Kl(e,["selector"]);return new ve(function(i){var s=new AbortController,o=s.signal,a=!0,l=r.signal;if(l)if(l.aborted)s.abort();else{var c=function(){o.aborted||s.abort()};l.addEventListener("abort",c),i.add(function(){return l.removeEventListener("abort",c)})}var u=Mn(Mn({},r),{signal:o}),d=function(f){a=!1,i.error(f)};return fetch(t,u).then(function(f){n?Qe(n(f)).subscribe(Se(i,void 0,function(){a=!1,i.complete()},d)):(a=!1,i.next(f),i.complete())}).catch(d),function(){a&&s.abort()}})}class zs{constructor(e){H(this,"token");this.token=e}urlBase64Decode(e){let n=e.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:{n+="==";break}case 3:{n+="=";break}default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(n)}b64decode(e){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let r="";if(e=String(e).replace(/=+$/,""),e.length%4===1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let i=0,s,o,a=0;o=e.charAt(a++);~o&&(s=i%4?s*64+o:o,i++%4)?r+=String.fromCharCode(255&s>>(-2*i&6)):0)o=n.indexOf(o);return r}b64DecodeUnicode(e){return decodeURIComponent(Array.prototype.map.call(this.b64decode(e),n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(e=this.token){if(e===null)return null;const n=e.split(".");if(n.length!==3)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");const r=this.urlBase64Decode(n[1]);if(!r)throw new Error("Cannot decode the token.");return JSON.parse(r)}getJWTUser(e=this.token){let n;try{n=this.decodeToken(e)}catch{return null}return n}getTokenExpirationDate(e=this.token){const n=this.getJWTUser(e);if(!n)return null;const r=new Date(0);return r.setUTCSeconds(n.exp),r}isTokenExpired(e=this.token,n){if(e===null||e==="")return!0;const r=this.getTokenExpirationDate(e);return n=n||0,r===null?!0:r.valueOf()<=new Date().valueOf()+n*1e3}}const Br="JWT_KEY",qr="JWT_REFRESH_KEY",Ds=5*60*1e3;class Hc{constructor(e){H(this,"nuclia");H(this,"_isAuthenticated",new cc(1));H(this,"timerSubscription");this.nuclia=e,this.nuclia.options.knowledgeBox?this._isAuthenticated.next(!0):this.checkTokenExpiration()}getAuthHeaders(e,n){return this.nuclia.options.standalone?{"X-NUCLIADB-ROLES":this.getNucliaDbRole(e,n)}:this.nuclia.options.apiKey?{"X-NUCLIA-SERVICEACCOUNT":`Bearer ${this.nuclia.options.apiKey}`}:this.getToken()?{Authorization:`Bearer ${this.getToken()}`}:{}}getNucliaDbRole(e,n){let r;switch(e){case"PUT":case"PATCH":case"POST":case"DELETE":r="WRITER";break;default:r="READER"}return n==="/kbs"||e==="PATCH"&&(n!=null&&n.startsWith("/kb"))&&(n==null?void 0:n.split("/").length)===3?r="MANAGER":(n!=null&&n.endsWith("/search")||n!=null&&n.endsWith("/find")||n!=null&&n.endsWith("/catalog")||n!=null&&n.endsWith("/chat"))&&(r="READER"),r}isAuthenticated(){return this._isAuthenticated.asObservable()}hasLoggedOut(){return this.isAuthenticated().pipe(Ns(1),le(e=>!e))}login(e,n,r){return this.fetch("/auth/login",{username:e,password:n},!1,r?{"X-STF-VALIDATION":r}:{}).pipe(E(i=>this.authenticate(i)))}authenticate(e){return e.access_token?(this.storeTokens(e),this._isAuthenticated.next(!0),!0):(this._isAuthenticated.next(!1),!1)}logout(){this.fetch("/auth/logout",{},!0,{}).subscribe(),localStorage.removeItem(Br),localStorage.removeItem(qr),this._isAuthenticated.next(!1)}refresh(){return this.fetch("/auth/refresh",{refresh_token:this.getRefreshToken()},!0,{}).pipe(Be(e=>(this.logout(),Dr(e))),E(e=>e.access_token?(this.storeTokens(e),!0):(this.logout(),!1)))}getToken(){return this.nuclia.options.public?"":localStorage.getItem(Br)||""}setPassword(e){return this.fetch("/auth/setpassword",{password:e},!0,{}).pipe(E(n=>this.authenticate(n)))}deleteAuthenticatedUser(){return this.nuclia.rest.delete("/user").pipe(qe(()=>this.storeTokens({access_token:"",refresh_token:""})))}getJWTUser(){const e=this.getToken();return e?new zs(e).getJWTUser():null}getRefreshToken(){return localStorage.getItem(qr)||""}storeTokens(e){localStorage.setItem(Br,e.access_token),localStorage.setItem(qr,e.refresh_token),this.checkTokenExpiration()}checkTokenExpiration(){var n,r;const e=this.getToken();if(e){const s=(n=new zs(e).getTokenExpirationDate())==null?void 0:n.getTime();if(s){const o=new Date().getTime();if(s<o)this.logout();else{this._isAuthenticated.next(!0);const a=s-o<Ds?0:Ds;(r=this.timerSubscription)==null||r.unsubscribe(),this.timerSubscription=Cs(a).pipe(z(()=>this.refresh())).subscribe()}}else this._isAuthenticated.next(!1)}else this._isAuthenticated.next(!1)}fetch(e,n,r,i){const s={"content-type":"application/json",...i};return r&&(s.Authorization=`Bearer ${this.getToken()}`),Ls(`${this.nuclia.backend}${e}`,{method:"POST",selector:o=>Promise.resolve(o),headers:s,body:JSON.stringify(n)}).pipe(z(o=>o.ok?fe(o.clone().json()):Dr(o)))}}const Wc="NUCLIA_NUA_KEY";var Us=(t=>(t.DAY="day",t.WEEK="week",t.MONTH="month",t.YEAR="year",t))(Us||{}),q=(t=>(t.BASIC="basic",t.ORIGIN="origin",t.RELATIONS="relations",t.VALUES="values",t.EXTRACTED="extracted",t.ERRORS="errors",t.EXTRA="extra",t))(q||{});const Hr=512*1024,Vc=new RegExp(/[^a-z0-9_-]/g),Wr=(t,e,n,r,i={})=>(!i.contentType&&!(n instanceof ArrayBuffer)&&(i.contentType=(n==null?void 0:n.type)!=="null"?n==null?void 0:n.type:void 0),!i.filename&&!(n instanceof ArrayBuffer)&&(i.filename=n==null?void 0:n.name),!i.lang&&!(n instanceof ArrayBuffer)&&(i.lang=n.lang),!i.md5&&!(n instanceof ArrayBuffer)&&(i.md5=n.md5),(n instanceof ArrayBuffer?B(n):fe(n.arrayBuffer())).pipe(z(s=>r?Jc(t,e,s,i,n.payload):Gc(t,e,s,i)))),Gc=(t,e,n,r)=>{const i={"content-type":(r==null?void 0:r.contentType)||"application/octet-stream",...qs(r)};let s=1;const o=r!=null&&r.rslug?`?rslug=${r.rslug}`:"";return t.rest.post(`${e}/upload${o}`,n,i,!0).pipe(Ms(),le(a=>s--===0||a.status!==503),se(1),z(a=>{try{switch(a.status){case 201:return fe(a.json()).pipe(E(l=>({resource:l.uuid||"",field:l.field_id||"",completed:!0})));case 409:return B({conflict:!0});default:return B({failed:!0})}}catch{return B({failed:!0})}}))},Jc=(t,e,n,r,i)=>{let s=0,o=0,a=!1;const l=n.byteLength,c=Math.ceil(l/Hr),u={"upload-length":`${l}`,"tus-resumable":"1.0.0"},d=[];r!=null&&r.filename&&d.push(`filename ${btoa(encodeURIComponent(r.filename))}`),r!=null&&r.lang&&d.push(`language ${btoa(r.lang)}`),r!=null&&r.md5&&d.push(`md5 ${btoa(r.md5)}`),d.push(`content_type ${btoa((r==null?void 0:r.contentType)||"application/octet-stream")}`),d.length>0&&(u["upload-metadata"]=d.join(","));let f=1;return t.rest.post(`${e}/tusupload`,i,u,!0).pipe(Ms(),le(h=>f--===0||h.status!==503),Be(h=>B(h)),se(1),Ur(h=>$s(B(h).pipe(le(g=>g.status!==201||!g.headers.get("location")),E(g=>g.status===409?{conflict:!0,failed:!0}:{failed:!0})),B(h).pipe(le(g=>g.status===201&&!!g.headers.get("location")),E(g=>g.headers.get("location")),Ur(g=>Uc(0,c).pipe(Ur(()=>{const p=n.slice(s,s+Hr);return o+=1,a?B({failed:a}):t.rest.patch(g,p,{"content-type":(r==null?void 0:r.contentType)||"application/octet-stream","upload-offset":`${s}`,"content-length":`${p.byteLength}`},!0).pipe(E(_=>_.status!==200?(a=!0,{failed:a}):(s+=Hr,{completed:o===c,progress:s>=l?100:Math.min(Math.floor(s/l*100),100)})),Be(()=>(a=!0,B({failed:!0}))))})))))))},Bs=(t,e,n,r=!1)=>{const i=Array.from(n),s=i.reduce((c,u)=>c+(u.size||0),0),o=[],a=i.map(c=>({file:c,progress:0,uploaded:!1,failed:!1})),l=i.map(c=>{let u=e;if(r){let f=c.name.toLowerCase().replace(Vc,"_");o.includes(f)&&(f+="_"+o.filter(h=>h.startsWith(f)).length),o.push(f),u=`${u}/file/${f}`}const d=c.lang;if(d){const f=c.payload||{};c.payload={...f,metadata:{...f==null?void 0:f.metadata,language:d}}}return Wr(t,u,c,!0,{}).pipe(qc({progress:0,completed:!1}),E(f=>({status:f,file:c})))});return fe(l).pipe(_n(c=>c,6),E(c=>{const u=a.find(_=>_.file===c.file);c.status.failed&&(u.failed=!0),c.status.conflict&&(u.conflicts=!0),c.status.completed&&(u.uploaded=!0),!c.status.failed&&!c.status.conflict&&!c.status.completed?u.progress=c.status.progress||0:u.progress=100;const d=a.filter(_=>_.failed).length,f=a.filter(_=>_.conflicts).length,h=a.filter(_=>_.uploaded).length,g=a.filter(_=>!_.failed&&!_.uploaded).length===0,p=Math.round(a.reduce((_,v)=>_+v.file.size*v.progress/100,0)/s*100);return{files:a,progress:p,completed:g,uploaded:h,failed:d,conflicts:f}}))},Kc=(t,e,n,r)=>{const i={"x-stf-nuakey":`Bearer ${e}`,"content-type":(r==null?void 0:r.contentType)||"application/octet-stream",...qs(r)};return t.rest.post("/processing/upload",n,i)},qs=t=>{const e={};return t!=null&&t.filename&&(e["x-filename"]=encodeURIComponent(t.filename)),t!=null&&t.md5&&(e["x-md5"]=t.md5),t!=null&&t.lang&&(e["x-language"]=t.lang),e};var D=(t=>(t.text="text",t.file="file",t.link="link",t.layout="layout",t.conversation="conversation",t.keywordset="keywordset",t.datetime="datetime",t.generic="generic",t))(D||{}),Hs=(t=>(t.VALUE="value",t.EXTRACTED="extracted",t.ERROR="error",t))(Hs||{}),Ee=(t=>(t.TEXT="text",t.METADATA="metadata",t.SHORTENED_METADATA="shortened_metadata",t.LARGE_METADATA="large_metadata",t.VECTOR="vectors",t.LINK="link",t.FILE="file",t))(Ee||{});function Qc(t){return`/l/${t.labelset}/${t.label}`}function Xc(t){const e=t.split("/");return{labelset:e[2],label:e[3]}}function Yc(t){return`/e/${t.family}/${t.entity}`}function Ws(t){const e=t.split("/");return{family:e[2],entity:e[3]}}var nt=(t=>(t.layout="l",t.text="t",t.file="f",t.link="u",t.datetime="d",t.keywordset="k",t.generic="a",t.conversation="c",t))(nt||{}),pt;(t=>{(e=>{e.PARAGRAPH="paragraph",e.DOCUMENT="document",e.RELATIONS="relations",e.VECTOR="vector"})(t.Features||(t.Features={})),(e=>{e.PARAGRAPH="paragraph",e.RELATIONS="relations",e.VECTOR="vector"})(t.ResourceFeatures||(t.ResourceFeatures={})),(e=>{e.PARAGRAPH="paragraph",e.ENTITIES="entities",e.INTENT="intent"})(t.SuggestionFeatures||(t.SuggestionFeatures={})),(e=>{e.VECTOR="VECTOR",e.BM25="BM25",e.BOTH="BOTH"})(t.FindScoreType||(t.FindScoreType={}))})(pt||(pt={}));const Vs=(t,e,n,r,i=[],s,o)=>{var f;const{inTitleOnly:a,...l}=s||{},c={query:r||"",features:i};a&&(c.fields=["a/title"]),c.shards=((f=t.currentShards)==null?void 0:f[e])||[];const u=`${n}/find`;return(o?t.rest.get(`${u}?${Hn(c,l)}`,void 0,!0):t.rest.post(u,{...c,...l},void 0,!0)).pipe(z(h=>{var p;const g=h.headers.get("X-Nuclia-Trace-Id")||"";return!h.ok||h.status===206?(h.status===206&&((p=t.events)==null||p.emit("partial",{...c,...l})),fe(h.json().then(_=>{throw{status:h.status,body:_}},()=>{throw{status:h.status}}))):fe(h.json().then(_=>({..._,searchId:g}),()=>{console.warn(`${u} did not return a valid JSON`)}))}),Be(h=>B({type:"error",status:h.status,detail:h.detail,body:h.body})),E(h=>h.type==="error"?h:{...h,type:"findResults"}),qe(h=>{h.type==="findResults"&&h.shards&&(t.currentShards={...t.currentShards,[e]:h.shards})}))},Gs=(t,e,n,r,i=[],s,o)=>{var d;const{inTitleOnly:a,...l}=s||{},c={query:r||"",features:i};a&&(c.fields=["a/title"]),c.shards=((d=t.currentShards)==null?void 0:d[e])||[];const u=o?t.rest.get(`${n}/search?${Hn(c,l)}`):t.rest.post(`${n}/search`,{...c,...l});return Js(t,e,u)},Zc=(t,e,n,r)=>{var o;const i={};i.query=n||"",i.shards=((o=t.currentShards)==null?void 0:o[e])||[];const s=t.rest.get(`/kb/${e}/catalog?${r?Hn(i,r):""}`);return Js(t,e,s)},eu=(t,e,n,r,i,s)=>{const o={query:r||"",features:s};return i&&(o.fields=["a/title"]),t.rest.get(`${n}/suggest?${Hn(o,{})}`).pipe(Be(a=>B({type:"error",status:a.status,detail:a.detail})),E(a=>a.type==="error"?a:{...a,type:"suggestions"}))};function Js(t,e,n){return n.pipe(Be(r=>B({type:"error",status:r.status,detail:r.detail})),E(r=>r.type==="error"?r:{...r,type:"searchResults"}),qe(r=>{r.type==="searchResults"&&r.shards&&(t.currentShards={...t.currentShards,[e]:r.shards})}))}const Hn=(t,e)=>{Object.entries(e||{}).forEach(([r,i])=>{i!=null&&(Array.isArray(i)?t[r]=i.map(s=>`${s}`):typeof i=="object"?Object.entries(i).forEach(([s,o])=>t[`${r}_${s}`]=`${o}`):t[r]=`${i}`)});const n=new URLSearchParams;return Object.entries(t).forEach(([r,i])=>Array.isArray(i)?i.forEach(s=>n.append(r,s)):n.append(r,i)),n.toString()};var It;(t=>{(e=>{e.PARAGRAPHS="paragraphs",e.RELATIONS="relations"})(t.Features||(t.Features={})),(e=>{e.USER="USER",e.NUCLIA="NUCLIA"})(t.Author||(t.Author={}))})(It||(It={}));const Ks="_END_";function tu(t,e,n,r=[],i=[It.Features.PARAGRAPHS],s={}){let o=0,a,l,c="";return t.rest.getStream(`${e}/chat`,{query:n,context:r,show:[q.BASIC,q.VALUES],features:i.length>0?i:void 0,...s}).pipe(E(({data:u,incomplete:d,headers:f})=>{const h=f.get("X-Nuclia-Trace-Id")||"",g=f.get("NUCLIA-LEARNING-ID")||"";if(o===0&&u.length>=4&&(o=new DataView(u.buffer.slice(0,4)).getUint32(0)),!a&&o>0&&u.length>o+4){const p=u.slice(4,o+4);a=JSON.parse(atob(new TextDecoder().decode(p.buffer)))}if(a&&(a.searchId=h),a&&u.length>o+4&&(c=new TextDecoder().decode(u.slice(o+4).buffer),c.includes(Ks))){let p;if([c,p]=c.split(Ks),p)try{l=JSON.parse(atob(p)),a.relations=l}catch(_){console.warn(_)}}return{type:"answer",text:c,sources:a,incomplete:d,id:g}}),Be(u=>B({type:"error",status:u.status,detail:u.detail||""})))}const Vr=t=>[...new Set([...t].map(e=>JSON.stringify(e)))].map(e=>JSON.parse(e)),nu=(t,e,n,r,i)=>{const s=Vr(i.filter(u=>iu(u,t,e)).map(u=>u.token).reduce((u,d)=>u.concat(d),[])),a=Vr(i.filter(u=>Qs(u,t,e)).map(u=>u.paragraphs).reduce((u,d)=>u.concat(d),[])).filter(u=>u.key!==n),l=i.filter(u=>u.field.field!==t||u.field.field_type!==e),c=r.length>0?[...a,{key:n,classifications:r}]:a;return s.length>0||c.length>0?[...l,{field:{field:t,field_type:e},token:s.length>0?s:void 0,paragraphs:c.length>0?c:void 0}]:l},ru=(t,e,n,r)=>{const i=Vr(r.filter(o=>Qs(o,t,e)).map(o=>o.paragraphs).reduce((o,a)=>o.concat(a),[])),s=r.filter(o=>o.field.field!==t||o.field.field_type!==e);return n.length>0||i.length>0?[...s,{field:{field:t,field_type:e},token:n.length>0?n:void 0,paragraphs:i.length>0?i:void 0}]:s},iu=(t,e,n)=>t.field.field===e&&t.field.field_type===n&&t.token&&t.token.length>0,Qs=(t,e,n)=>t.field.field===e&&t.field.field_type===n&&t.paragraphs&&t.paragraphs.length>0,Xs=(t,e,n)=>t?(Array.isArray(t)||(t=Array.from(t)),t.slice(e,n).join("")):"";class su{constructor(e){H(this,"data",{});H(this,"fieldTextsCache",{});e.data||(e.data={}),Object.assign(this,{...e,title:this.formatTitle(e.title)})}getFields(e=["files","links","texts","keywordsets"]){return Object.entries(this.data).filter(([n])=>e.includes(n)).map(([,n])=>n).filter(n=>!!n).map(n=>Object.values(n)).reduce((n,r)=>n.concat(r),[])}getFieldData(e,n){var i;const r=(i=this.data[e])==null?void 0:i[n];return r||void 0}getExtractedSummaries(){return this.getFields().filter(e=>{var n,r,i;return(i=(r=(n=e.extracted)==null?void 0:n.metadata)==null?void 0:r.metadata)==null?void 0:i.summary}).map(e=>e.extracted.metadata.metadata.summary)}getExtractedTexts(){return this.getFields().filter(e=>{var n;return(n=e.extracted)==null?void 0:n.text}).map(e=>e.extracted.text)}getFiles(){return this.getFields(["files"]).filter(e=>!!e&&!!e.value&&!!e.value.file).map(e=>e.value.file)}getThumbnails(){return this.getFields(["files"]).map(e=>{var n,r;return(r=(n=e.extracted)==null?void 0:n.file)==null?void 0:r.file_thumbnail}).concat(this.getFields(["links"]).map(e=>{var n,r;return(r=(n=e.extracted)==null?void 0:n.link)==null?void 0:r.link_thumbnail})).filter(e=>!!e)}getAnnotatedEntities(){return(this.fieldmetadata||[]).filter(n=>n.token&&n.token.length>0).map(n=>n.token).reduce((n,r)=>(r.filter(i=>!i.cancelled_by_user).forEach(i=>{n[i.klass]||(n[i.klass]=[]),n[i.klass].push(i.token)}),n),{})}getNamedEntities(){return this.getFields().filter(e=>{var n,r,i;return(i=(r=(n=e.extracted)==null?void 0:n.metadata)==null?void 0:r.metadata)==null?void 0:i.ner}).map(e=>Object.entries(e.extracted.metadata.metadata.ner).reduce((n,[r,i])=>(n[i]=(n[i]||[]).concat([r]),n),{})).reduce((e,n)=>(Object.entries(n).forEach(([r,i])=>{e[r]=(e[r]||[]).concat(i)}),e),{})}getClassifications(){var r,i,s;const e=(((r=this.usermetadata)==null?void 0:r.classifications)||[]).filter(o=>!o.cancelled_by_user),n=(((i=this.usermetadata)==null?void 0:i.classifications)||[]).filter(o=>o.cancelled_by_user);return(((s=this.computedmetadata)==null?void 0:s.field_classifications)||[]).reduce((o,a)=>(a.classifications.forEach(l=>{const c=o.find(d=>d.label===l.label&&d.labelset===l.labelset),u=n.find(d=>d.label===l.label&&d.labelset===l.labelset);!c&&!u&&o.push({...l,immutable:!0})}),o),e)}getPositionedNamedEntities(e,n){var i,s,o,a;const r=(a=(o=(s=(i=this.data[e])==null?void 0:i[n])==null?void 0:s.extracted)==null?void 0:o.metadata)==null?void 0:a.metadata.positions;return r?Object.entries(r).reduce((l,[c,u])=>{const d=c.split("/")[0];return u.position.forEach(f=>{l.push({entity:u.entity,family:d,...f})}),l},[]):[]}formatTitle(e){e=e||"";try{return decodeURIComponent(e)}catch{return e}}getParagraphText(e,n,r){return Xs(this.getFieldText(e,n),r.start,r.end)}getSentenceText(e,n,r){return Xs(this.getFieldText(e,n),r.start,r.end)}getFieldText(e,n){var i,s;const r=`${e}-${n}`;if(!this.fieldTextsCache[r]){const o=this.getFieldData(`${e}s`,n);this.fieldTextsCache[r]=Array.from(((s=(i=o==null?void 0:o.extracted)==null?void 0:i.text)==null?void 0:s.text)||"")}return this.fieldTextsCache[r]}}class Gr extends su{constructor(n,r,i){super(i);H(this,"kb");H(this,"uuid");H(this,"nuclia");this.nuclia=n,this.kb=r,this.uuid=i.id}get kbPath(){return`/kb/${this.kb}`}get path(){if(!this.uuid&&!this.slug)throw new Error("Resource must have either uuid or slug");return this.uuid?`${this.kbPath}/resource/${this.uuid}`:`${this.kbPath}/slug/${this.slug}`}modify(n,r=!0){return this.nuclia.rest.patch(this.path,n,void 0,void 0,r)}delete(n=!0){return this.nuclia.rest.delete(this.path,void 0,n)}reprocess(){return this.nuclia.rest.post(`${this.path}/reprocess`,{},void 0,void 0,!0)}getField(n,r,i=[Hs.VALUE],s=[Ee.TEXT,Ee.SHORTENED_METADATA,Ee.LINK,Ee.FILE]){const o=[...i.map(a=>`show=${a}`),...s.map(a=>`extracted=${a}`)];return this.nuclia.rest.get(`${this.path}/${n}/${r}?${o.join("&")}`)}getThumbnailsUrl(){return qn(this.getThumbnails().filter(n=>n.uri).map(n=>this.nuclia.rest.getObjectURL(n.uri)))}deleteField(n,r){return this.nuclia.rest.delete(`${this.path}/${n}/${r}`)}setField(n,r,i){return this.nuclia.rest.put(`${this.path}/${n}/${r}`,i)}upload(n,r,i,s){return Wr(this.nuclia,`${this.path}/file/${n}`,r,!!i,s)}batchUpload(n){return Bs(this.nuclia,this.path,n,!0)}search(n,r=[],i){return Gs(this.nuclia,this.kb,this.path,n,r,i,!0)}find(n,r=[],i){return Vs(this.nuclia,this.kb,this.kbPath,n,r,this.uuid?{...i,resource_filters:[this.uuid]}:i)}setLabels(n,r,i,s){const o=nu(n,r,i,s,this.fieldmetadata||[]);return this.modify({fieldmetadata:o}).pipe(qe(()=>this.fieldmetadata=o))}setEntities(n,r,i){const s=ru(n,r,i,this.fieldmetadata||[]);return this.modify({fieldmetadata:s}).pipe(qe(()=>this.fieldmetadata=s))}}const ou=t=>{switch(t){case D.text:case D.file:case D.link:case D.keywordset:return`${t}s`;default:return null}};function Ys(t){switch(t){case nt.conversation:return D.conversation;case nt.datetime:return D.datetime;case nt.file:return D.file;case nt.layout:return D.layout;case nt.keywordset:return D.keywordset;case nt.link:return D.link;case nt.text:return D.text;case nt.generic:return D.generic;default:return null}}function Jr(t){switch(t){case D.file:return D.file;case D.link:return D.link;case D.text:return D.text;case D.layout:return D.layout;case D.conversation:return D.conversation;case D.datetime:return D.datetime;case D.generic:return D.generic;default:return null}}var Zs=(t=>(t.finished="finished",t.not_running="not_running",t.running="running",t.started="started",t.stopped="stopped",t))(Zs||{});class au{constructor(e,n){H(this,"kb");H(this,"nuclia");this.kb=e,this.nuclia=n}start(e,n){return this.nuclia.rest.post(`${this.kb.path}/train/${e}/start`,n||{})}stop(e){return this.nuclia.rest.post(`${this.kb.path}/train/${e}/stop`,{})}getStatus(e){return this.nuclia.rest.get(`${this.kb.path}/train/${e}/inspect`).pipe(Be(()=>B({task:"",status:Zs.not_running})))}getExecutions(e=0){return this.nuclia.rest.get(`${this.kb.path}/train/executions?page=${e}`)}hasModel(e){return this.nuclia.rest.get(`${this.kb.path}/train/${e}/model/model/nuclia.json`).pipe(E(()=>!0),Be(()=>B(!1)))}}class eo{constructor(e,n,r){H(this,"account");H(this,"nuclia");this.nuclia=e,this.account=n,Object.assign(this,r),!r.id&&r.uuid&&(this.id=r.uuid),!r.title&&r.slug&&(this.title=r.slug)}get path(){return`/kb/${this.id}`}get fullpath(){return`${this.nuclia.regionalBackend}/v1/kb/${this.id}`}getEntities(e=!1){return this.nuclia.rest.get(`${this.path}/entitiesgroups?show_entities=${e}`).pipe(E(n=>n.groups))}getEntitiesGroup(e){return this.nuclia.rest.get(`${this.path}/entitiesgroup/${e}`)}getSynonyms(){return this.nuclia.rest.get(`${this.path}/custom-synonyms`).pipe(E(e=>e.synonyms))}getLabels(){return this.nuclia.rest.get(`${this.path}/labelsets`).pipe(E(e=>(e==null?void 0:e.labelsets)||{}),Be(()=>B({})))}getResource(e,n=[q.BASIC,q.ORIGIN,q.RELATIONS,q.VALUES,q.EXTRACTED,q.ERRORS],r=[Ee.TEXT,Ee.METADATA,Ee.LINK,Ee.FILE]){return this._getResource(e,void 0,n,r)}getResourceBySlug(e,n=[q.BASIC,q.ORIGIN,q.RELATIONS,q.VALUES,q.EXTRACTED,q.ERRORS],r=[Ee.TEXT,Ee.METADATA,Ee.LINK,Ee.FILE]){return this._getResource(void 0,e,n,r)}_getResource(e,n,r=[q.BASIC,q.ORIGIN,q.RELATIONS,q.VALUES,q.EXTRACTED,q.ERRORS],i=[Ee.TEXT,Ee.METADATA,Ee.LINK,Ee.FILE]){const s=[...r.map(o=>`show=${o}`),...i.map(o=>`extracted=${o}`)];return this.nuclia.rest.get(`${this._getPath(e,n)}?${s.join("&")}`).pipe(E(o=>new Gr(this.nuclia,this.id,o)))}_getPath(e,n){return e?`${this.path}/resource/${e}`:`${this.path}/slug/${n}`}getResourceFromData(e){return new Gr(this.nuclia,this.id,e)}chat(e,n,r,i){return tu(this.nuclia,this.path,e,n,r,i)}find(e,n=[],r){return Vs(this.nuclia,this.id,this.path,e,n,r)}search(e,n=[],r){return Gs(this.nuclia,this.id,this.path,e,n,r)}catalog(e,n){return Zc(this.nuclia,this.id,e,n)}suggest(e,n=!1,r=[]){return eu(this.nuclia,this.id,this.path,e,n,r)}feedback(e,n){return this.nuclia.rest.post(`${this.path}/feedback`,{ident:e,good:n,task:"CHAT",feedback:""})}counters(){return this.nuclia.rest.get(`/kb/${this.id}/counters`)}listResources(e,n){const r=[e?`page=${e}`:"",n?`size=${n}`:""].filter(i=>i).join("&");return this.nuclia.rest.get(`/kb/${this.id}/resources${r?"?"+r:""}`).pipe(E(i=>({resources:i.resources.map(s=>new Gr(this.nuclia,this.id,s)),pagination:i.pagination})))}getTempToken(){const e=this.account||this.nuclia.options.account,n=this.slug||this.nuclia.options.kbSlug;if(this.nuclia.options.standalone)return this.nuclia.rest.get("/temp-access-token").pipe(E(r=>r.token));if(!e||!n)throw new Error("Account and KB slug are required to get a temp token");return this.nuclia.rest.post(`/account/${e}/kb/${n}/ephemeral_tokens`,{}).pipe(E(r=>r.token))}listActivity(e,n,r){const i=[e?`type=${e}`:"",n?`page=${n}`:"",r?`size=${r}`:""].filter(s=>s).join("&");return this.nuclia.rest.get(`/kb/${this.id}/activity${i?"?"+i:""}`)}listActivityDownloads(e){return this.nuclia.rest.get(`/kb/${this.id}/activity/downloads?type=${e}`)}downloadActivity(e,n){return this.nuclia.rest.get(`/kb/${this.id}/activity/download?type=${e}&month=${n}`,{},!0).pipe(z(r=>fe(r.blob())))}getConfiguration(){return this.nuclia.rest.get(`/kb/${this.id}/configuration`)}}class to extends eo{constructor(){super(...arguments);H(this,"admin");H(this,"contrib");H(this,"_training")}get training(){return this._training||(this._training=new au(this,this.nuclia)),this._training}modify(n){const r=this.account==="local"?`/kb/${this.id}`:`/account/${this.account}/kb/${this.slug}`;return this.nuclia.rest.patch(r,n)}publish(n){return this.modify({state:n?"PUBLISHED":"PRIVATE"})}delete(){return this.nuclia.rest.delete(`/account/${this.account}/kb/${this.slug}`)}createEntitiesGroup(n,r){return this.nuclia.rest.post(`${this.path}/entitiesgroups`,{...r,group:n})}updateEntitiesGroup(n,r){return this.nuclia.rest.patch(`${this.path}/entitiesgroup/${n}`,r)}deleteEntitiesGroup(n){return this.nuclia.rest.delete(`${this.path}/entitiesgroup/${n}`)}setLabelSet(n,r){return this.nuclia.rest.post(`${this.path}/labelset/${n}`,r)}deleteLabelSet(n){return this.nuclia.rest.delete(`${this.path}/labelset/${n}`)}setSynonyms(n){return this.nuclia.rest.put(`${this.path}/custom-synonyms`,{synonyms:n})}deleteAllSynonyms(){return this.nuclia.rest.delete(`${this.path}/custom-synonyms`)}createResource(n,r=!0){return this.nuclia.rest.post(`${this.path}/resources`,n,void 0,void 0,r)}createLinkResource(n,r,i=!0,s){return this.createResource({links:{link:n},usermetadata:r,title:n.uri,icon:"application/stf-link",...s?{origin:s}:{}},i)}hasResource(n){return this.nuclia.rest.get(`${this.path}/slug/${n}`).pipe(E(()=>!0),Be(()=>B(!1)))}createOrUpdateResource(n,r=!0){return(n.slug?this.hasResource(n.slug):B(!1)).pipe(z(s=>s?this.getResourceFromData({id:"",slug:n.slug}).modify(n,r):this.createResource(n,r)))}upload(n,r,i){return Wr(this.nuclia,`/kb/${this.id}`,n,!!r,i)}batchUpload(n){return Bs(this.nuclia,`/kb/${this.id}`,n,!1)}getServiceAccounts(){return this.nuclia.rest.get(`/account/${this.account}/kb/${this.slug}/service_accounts`)}createServiceAccount(n){return this.nuclia.rest.post(`/account/${this.account}/kb/${this.slug}/service_accounts`,n)}deleteServiceAccount(n){return this.nuclia.rest.delete(`/account/${this.account}/kb/${this.slug}/service_account/${n}`)}createKey(n,r){return this.nuclia.rest.post(`/account/${this.account}/kb/${this.slug}/service_account/${n}/keys`,{expires:r})}createKeyForService(n,r){return this.getServiceAccounts().pipe(z(i=>{const s=i.find(o=>o.title===n.title&&o.role===n.role);return s?B(s):this.createServiceAccount(n).pipe(z(()=>this.getServiceAccounts()),E(o=>o.find(a=>a.title===n.title&&a.role===n.role)))}),z(i=>i?this.createKey(i.id,r):B({token:""})))}deleteKey(n,r){return this.nuclia.rest.delete(`/account/${this.account}/kb/${this.slug}/service_account/${n}/key/${r}`)}setConfiguration(n){return this.nuclia.rest.patch(`/kb/${this.id}/configuration`,n)}}var Wn=(t=>(t.RESOURCES="RESOURCES",t.PARAGRAPHS="PARAGRAPHS",t.SELECTIONS="SELECTIONS",t))(Wn||{});class lu{constructor(e){H(this,"nuclia");this.nuclia=e}getAccounts(){return this.nuclia.rest.get("/accounts")}createAccount(e){return this.nuclia.rest.post("/accounts",e)}modifyAccount(e,n){return this.nuclia.rest.patch(`/account/${e}`,n)}deleteAccount(e){return this.nuclia.rest.delete(`/account/${e}`)}getAccountStatus(e){return this.nuclia.rest.get(`/account/${e}/status`)}getWelcome(){return this.nuclia.rest.get("/user/welcome")}getAccount(e){if(e=e||this.nuclia.options.account,!e)throw new Error("Account is not set");return this.nuclia.rest.get(`/account/${e}`)}getStandaloneKbs(){return this.nuclia.rest.get("/kbs").pipe(E(e=>e.kbs))}getKnowledgeBoxes(e){return this.nuclia.rest.get(`/account/${e}/kbs`)}getKnowledgeBox(e,n){if(e=e||this.nuclia.options.account,e){const r=n||this.nuclia.options.knowledgeBox||this.nuclia.options.kbSlug;if(!r)throw new Error("account and knowledgeBox must be defined in the Nuclia options");const i=this.nuclia.options.standalone?`/kb/${n}`:`/account/${e}/kb/${r}`;return this.nuclia.rest.get(i).pipe(z(s=>this.nuclia.options.zone||this.nuclia.options.standalone?B(s):this.nuclia.rest.getZoneSlug(s.zone).pipe(qe(o=>this.nuclia.options.zone=o),E(()=>s))),E(s=>new to(this.nuclia,e,s)))}else{if(!this.nuclia.options.knowledgeBox||!this.nuclia.options.zone)throw new Error("zone must be defined in the Nuclia options");return B(new to(this.nuclia,"",{id:this.nuclia.options.knowledgeBox,zone:this.nuclia.options.zone}))}}createKnowledgeBox(e,n){return this.nuclia.rest.post(this.nuclia.options.standalone?"/kbs":`/account/${e}/kbs`,n).pipe(z(r=>{const i=r.id||r.uuid;if(!i)throw"KnowledgeBox creation failed";return this.getKnowledgeBox(e,this.nuclia.options.standalone?i:n.slug)}))}getStats(e,n,r,i=Us.DAY,s){const o=[`period=${i}`,`stats=${n}`];return s&&o.push(`utctime=${s}`),r&&o.push(`knowledgebox=${r}`),this.nuclia.rest.get(`/account/${e}/stats?${o.join("&")}`).pipe(E(a=>a.data),le(a=>!!a))}upload(e){if(!this.hasNUAClient())throw new Error("NUA key is needed to be able to call /process");return Kc(this.nuclia,this.getNUAKey(),e,{md5:e.md5}).pipe(z(n=>this.nuclia.rest.post("/processing/push",{filefield:{file:n}},this.getNUAHeader())))}pull(){if(!this.hasNUAClient())throw new Error("NUA key is needed to be able to call /processing");return this.nuclia.rest.get("/processing/pull",this.getNUAHeader())}getProcessingStatus(e){if(!e&&!this.hasNUAClient())throw new Error("NUA key or account id is needed to be able to call /processing/status");const n=e?`/processing/status?account_id=${e}`:"/processing/status",r=e?void 0:this.getNUAHeader();return this.nuclia.rest.get(n,r)}getProcessingStats(e,n){const r=this.hasNUAClient();if(!n&&!r)throw new Error("NUA key or account id is needed to be able to call /processing/stats");const i=r?`/processing/stats${e?"?period="+e:""}`:`/processing/stats?account_id=${n}${e?"&period="+e:""}`,s=r?this.getNUAHeader():void 0;return this.nuclia.rest.get(i,s).pipe(E(o=>o.data))}getNUAActivity(e,n,r=0){return this.nuclia.rest.get(`/account/${e}/nua_client/${n}/activity?page=${r}`)}getNUAClients(e){return this.nuclia.rest.get(`/account/${e}/nua_clients`).pipe(E(n=>n.clients))}getNUAClient(e,n){return this.nuclia.rest.get(`/account/${e}/nua_client/${n}`)}hasNUAClient(){return!!this.getNUAKey()}getNUAKey(){return this.nuclia.options.nuaKey||""}getNUAHeader(){return{"x-stf-nuakey":`Bearer ${this.getNUAKey()}`}}createNUAClient(e,n){const r={...n};return r.webhook&&(r.processing_webhook={uri:r.webhook},delete r.webhook),this.nuclia.rest.post(`/account/${e}/nua_clients`,r).pipe(Be(i=>{if(i.status===409&&n.client_id)return this.renewNUAClient(e,n.client_id);throw i}),qe(i=>{this.nuclia.options.client==="desktop"&&(this.nuclia.options.nuaKey=i.token,localStorage.setItem(Wc,i.token))}))}renewNUAClient(e,n){return this.nuclia.rest.put(`/account/${e}/nua_client/${n}/key`,{})}deleteNUAClient(e,n){return this.nuclia.rest.delete(`/account/${e}/nua_client/${n}`)}getLearningConfigurations(){return this.nuclia.rest.get("/learning/configuration/schema")}predictTokens(e){if(!this.hasNUAClient())throw new Error("NUA key is needed to be able to call /predict");return this.nuclia.rest.get(`/predict/tokens?text=${encodeURIComponent(e)}`,this.getNUAHeader()).pipe(E(n=>n.tokens))}}class cu{constructor(e){H(this,"nuclia");H(this,"zones");this.nuclia=e}get(e,n,r){return this.fetch("GET",e,void 0,n,r)}post(e,n,r,i,s){return this.fetch("POST",e,n,r,i,s)}put(e,n,r,i,s){return this.fetch("PUT",e,n,r,i,s)}patch(e,n,r,i,s){return this.fetch("PATCH",e,n,r,i,s)}delete(e,n,r){return this.fetch("DELETE",e,void 0,n,!0,r)}head(e,n){return this.fetch("HEAD",e,void 0,n,!0)}getHeaders(e,n,r,i=!1){const s=r&&r["x-stf-nuakey"]?{}:this.nuclia.auth.getAuthHeaders(e,n),o={"content-type":"application/json","x-ndb-client":this.nuclia.options.client||"web",...s};return i&&(o["x-synchronous"]=`${i}`),{...o,...r}}fetch(e,n,r,i,s,o=!1){const a=i&&i["content-type"];return fe(fetch(this.getFullUrl(n),{method:e,headers:this.getHeaders(e,n,i,o),body:a?r:JSON.stringify(r)}).then(l=>{var c;return l.ok?s?l:l.json().then(u=>u,()=>{console.warn(`${n} did not return a valid JSON`)}):((c=this.nuclia.events)==null||c.emit("api-error",{status:l.status,path:this.getFullUrl(n)}),l.json().then(u=>{throw{status:l.status,body:u}},()=>{throw{status:l.status}}))}))}getFullUrl(e){const r=e.startsWith("/account")||e.startsWith("/user")||e.startsWith("/auth")||e.startsWith("/zones")||e.startsWith("/billing")||e.startsWith("/configuration")||e.startsWith("/manage")||e.includes("/activity")&&!e.includes("/activity/download")||this.nuclia.options.standalone?this.nuclia.backend:this.nuclia.regionalBackend,i=e.startsWith("/auth")||e.startsWith("/export")||e.startsWith("/billing")||e.startsWith("/configuration")||e.startsWith("/manage")?"":"/v1";return`${r}${i}${e}`}getZones(){return this.zones?B(this.zones):this.get("/zones").pipe(E(e=>{const n=e.reduce((r,i)=>(r[i.id]=i.slug,r),{});return this.zones=n,n}))}getZoneSlug(e){return this.getZones().pipe(E(n=>n[e]))}getObjectURL(e){return this.get(e,void 0,!0).pipe(z(n=>fe(n.blob())),E(n=>URL.createObjectURL(n)))}getStream(e,n){return e=this.getFullUrl(e),new ve(r=>{fetch(e,{method:"POST",headers:this.getHeaders("POST",e),body:JSON.stringify(n)}).then(i=>{var l;const s=(l=i.body)==null?void 0:l.getReader(),o=i.headers,a=i.status;if(!s||!i.ok)r.error({status:a}),r.complete();else{let c=new Uint8Array;const u=()=>{s.read().then(({done:d,value:f})=>{d&&(r.next({data:c,incomplete:!1,headers:o}),r.complete()),f&&(c=this.concat(c,f),r.next({data:c,incomplete:!0,headers:o}),u())})};u()}})})}concat(e,n){const r=new Uint8Array(e.length+n.length);return r.set(e),r.set(n,e.length),r}}class uu{constructor(){H(this,"messages",new zt)}emit(e,n){this.messages.next({name:e,data:n})}on(e){return this.messages.asObservable().pipe(le(n=>n.name===e),E(n=>n.data))}}class du{constructor(e){H(this,"options");H(this,"auth");H(this,"rest");H(this,"db");H(this,"currentShards",{});H(this,"events",new uu);H(this,"readKb");this.options=e,this.auth=new Hc(this),this.rest=new cu(this),this.db=new lu(this)}get backend(){return this.options.backend}get regionalBackend(){return this.options.backend.replace("//",`//${this.options.zone}.`)}get knowledgeBox(){if(!this.options.knowledgeBox||!this.options.zone&&!this.options.standalone)throw new Error("zone and knowledge box id must be defined in the Nuclia options");return this.readKb||(this.readKb=new eo(this,"",{id:this.options.knowledgeBox,zone:this.options.zone||""})),this.readKb}get asyncKnowledgeBox(){return new Proxy(this.knowledgeBox,{get(e,n){const r=Reflect.get(e,n);return typeof r=="function"?(...i)=>Rc(r.bind(e)(...i)):r}})}}let no="https://cdn.nuclia.cloud/";const fu=t=>no=t,Vn=()=>no,hu=()=>{const t="nuclia-fonts-link";if(!document.getElementById(t)){const e=document.createElement("link");e.id=t,e.href="https://fonts.googleapis.com/css?family=Inter:300,400,600,700",e.rel="stylesheet",(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}},pu=()=>Ls(`${Vn()}icons/glyphs-sprite.svg`).pipe(z(t=>t.text())),Gn=t=>`__nuclia_${t}__`,Jn=t=>{const e=t.toString(),n=`${location.pathname}${location.hash.split("?")[0]}`,r=e?`${n}?${e}`:n;history.replaceState(null,"",r)};function mn(){const t=window.location.hash&&window.location.hash.includes("?")?window.location.hash.slice(window.location.hash.indexOf("?")):window.location.search;return new URLSearchParams(t)}const gu=t=>{const e=/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,n=t.match(e);return n&&n[2].length===11?n[2]:""},vu=t=>!!gu(t),_u={DATE:"#FF8989",EVENT:"#CBA2DA",FAC:"#81D8AC",GPE:"#6EB0EC",LANGUAGE:"#D1D3FF",LAW:"#9295E7",LOC:"#D1BEA9",MAIL:"#D2F1E1",MONEY:"#FF8C4B",NORP:"#CFE8FF",ORG:"#A0E3FF",PERCENT:"#FBDBB9",PERSON:"#FFDA69",PRODUCT:"#FF6363",QUANTITY:"#E7D2EF",TIME:"#21B8A6",WORK_OF_ART:"#ffc7c7"};function Kr(t,e){const n=new URL(t);if(n.protocol.startsWith("http")){let r="";const i="fragmentDirective"in document;e&&i&&!n.hash&&(r=mu(e),r&&(t=t+r)),window.location.href=t}else console.info(`Invalid URL: ${t}`)}function mu(t){const e=s=>encodeURIComponent(s).replace(/-/g,"%2D");t=t.replace(/<mark>/g,"").replace(/<\/mark>/g,"");const r=/\s+\n\s+/,i=t.trim().split(r).filter(s=>s.length>0).map(s=>s.split(/\s+/));if(i.length===1)return`#:~:text=${e(i[0].join(" "))}`;{const s=i[0],o=i[i.length-1];if(s.length>=4&&o.length>=4)return`#:~:text=${e(s.slice(0,6).join(" "))},${e(o.slice(-6).join(" "))}`}return""}const ro=new gn("en"),Qr=new gn({}),yu=(t,e)=>{const n=Qr.getValue();Qr.next({...n,[t]:{...n[t]||{},...e}})},bu=t=>fetch(`${Vn()}i18n/${t}.json`).then(e=>e.json()).then(e=>yu(t,e)),io=t=>{bu(t).then(()=>ro.next(t),()=>{t!=="en"&&io("en")})},wu=new RegExp(/[<>]/gim),ku=(t,e,n,r)=>{var s,o;let i=((s=e[t])==null?void 0:s[n])||((o=e.en)==null?void 0:o[n]);return i&&r&&Object.keys(r).forEach(a=>{let l=r[a];typeof l=="string"&&(l=l.replace(wu,c=>"&#"+c.charCodeAt(0)+";")),i=i.replace(new RegExp(`{{${a}}}`,"g"),l)}),i||n},xt=tt([ro,Qr]).pipe(E(([t,e])=>(n,r)=>ku(t,e,n,r)));class Dt{constructor(e){H(this,"store");H(this,"initialState");this.initialState=e,this.store=new gn(e)}reader(e){const n=this.store.asObservable().pipe(E(e));return n.getValue=()=>e(this.store.getValue()),n}writer(e,n){const r=this.reader(e);return r.set=i=>{const s=this.store.getValue();this.store.next(n(s,i))},r}action(e){const n=this.reader(()=>{});return n.do=()=>{const r=this.store.getValue();this.store.next(e(r))},n}reset(){this.store.next(this.initialState)}}class Su extends gn{set(e){super.next(e)}update(e){super.next(e(super.value))}}function yn(t){return new Su(t)}const so={...{type:"findResults",total:0,page_number:0,next_page:!1,page_size:0,query:""},resultList:[]},Xr={type:"suggestions",paragraphs:{}},Me=yn(null),oo=yn("input.placeholder");Me.pipe(E(t=>!!(t!=null&&t.navigateToLink))),Me.pipe(E(t=>!!(t!=null&&t.navigateToFile))),Me.pipe(E(t=>!!(t!=null&&t.filter)));const bn=Me.pipe(E(t=>!!(t!=null&&t.answers)));Me.pipe(E(t=>!!(t!=null&&t.knowledgeGraph)));const Eu=Me.pipe(E(t=>!!(t!=null&&t.suggestEntities)));Me.pipe(E(t=>!!(t!=null&&t.displayMetadata))),Me.pipe(E(t=>!!(t!=null&&t.hideThumbnails)));const ao=tt([bn,Me.pipe(E(t=>!!(t!=null&&t.onlyAnswers)))]).pipe(E(([t,e])=>t&&e)),Au=tt([bn,Me.pipe(E(t=>!!(t!=null&&t.hideSources)))]).pipe(E(([t,e])=>t&&e)),Iu=()=>{Me.set({...Me.value||{},answers:!1})},gt=new Dt({typeAhead:"",suggestions:{results:Xr}}),lo=new zt,sn=gt.writer(t=>t.typeAhead,(t,e)=>({...t,typeAhead:e})),xu=gt.writer(t=>t.suggestions,(t,e)=>({...t,suggestions:e,error:void 0})),co=gt.writer(t=>t.error,(t,e)=>({...t,error:e})),uo=gt.reader(t=>!!t.error),fo=gt.reader(t=>{var e;return((e=t.suggestions.results.paragraphs)==null?void 0:e.results)||[]}),Tu=gt.reader(t=>t.suggestions.labels||[]),Ru=gt.reader(t=>{var e;return((e=t.suggestions.results.entities)==null?void 0:e.entities)||[]}),Pu=tt([fo,Tu,Ru,Eu]).pipe(E(([t,e,n,r])=>t.length>0||e.length>0||n.length>0&&r));let ho="https://cdn.nuclia.cloud/";const Ou=t=>ho=t,Fu=()=>ho,wn=Cu()&&localStorage.getItem("nuclia_debug")==="true"?console.log:()=>{};function Cu(){try{return localStorage.getItem("nuclia_debug"),!0}catch{return!1}}async function $u(t,e,n){return new qu(t,e,n)}class po{constructor(e){e&&(this.key=e),this.children={},this.end=!1}}class ju{constructor(){this.root=new po(void 0)}insert(e,n,r){let i=this.root;const s=[];for(const o of e)s.push(o);for(let o=0;o<s.length;o++)i.children[s[o]]||(i.children[s[o]]=new po(s[o]),i.children[s[o]].parent=i),i=i.children[s[o]],o===s.length-1&&(i.end=!0,i.score=n,i.index=r)}find(e){let n=this.root,r=0;for(;r<e.length&&n!=null;)n=n.children[e[r]],r++;return n}}class Mu{constructor(e,n){this.vocab=[],this.separator="",this.UNK_INDEX=100,this.doLowerCase=e,this.multilingual=n}load(e){this.vocab=this.loadVocab(e),this.trie=new ju,this.trie.insert("[CLS]",1,101),this.trie.insert("[SEP]",1,102);const n=this.multilingual?106:999;for(let r=n;r<this.vocab.length;r++){const i=this.vocab[r];this.trie.insert(i,1,r)}}loadVocab(e){const n=new XMLHttpRequest;return n.open("GET",e,!1),n.send(null),JSON.parse(n.responseText)}processInput(e){return e.split(" ").map(r=>r!=="[CLS]"&&r!=="[SEP]"?this.doLowerCase?this.separator+r.toLowerCase().normalize("NFKC"):this.separator+r.normalize("NFKC"):r)}tokenize(e){var i;let n=[];const r=this.processInput(e);for(let s=0;s<r.length;s++){const o=[];for(const d of r[s])o.push(d);let a=!1,l=0;const c=[],u=o.length;for(;l<u;){let d=u,f;for(;l<d;){const h=o.slice(l,d).join(""),g=(i=this.trie)==null?void 0:i.find(h);if(g&&g.end&&g.index){f=g.index;break}d=d-1}if(!f){a=!0;break}c.push(f),l=d}a?n.push(this.UNK_INDEX):n=n.concat(c)}return wn("tokenizer",n),n}}function Nu(t){return Wu.indexOf(t)!==-1}function Lu(t){return t=t.normalize("NFD"),Hu.forEach(e=>{t=t.replace(String.fromCodePoint(e),"")}),t}function zu(t){return t===32||t===9||t===10||t===13||Gu.indexOf(t)!==-1}function Du(t){return Vu.indexOf(t)!==-1&&t!==9&&t!==10&&t!==13}function Uu(t){const e=[];let n=-1,r=!1;for(let i=0;i<t.length;i++){const s=t.charCodeAt(i),o=Nu(s);(o&&n!==32||r&&s!==32)&&e.push(32),e.push(s),n=s,r=o}return String.fromCodePoint(...e)}function Bu(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r===0||r===65533||Du(r)||(zu(r)?e.push(32):e.push(r))}return String.fromCharCode(...e)}class qu{constructor(e,n=!1,r=!1,i=128){this.doLowerCase=n,this.tokenizer=new Mu(this.doLowerCase,r),this.tokenizer.load(e),this.maxSeqLength=i,this.clsId=this.convertTokensToId("[CLS]")[0],this.sepId=this.convertTokensToId("[SEP]")[0]}tokenize(e){return e=Bu(e),e=Uu(e),e=Lu(e),this.doLowerCase&&(e=e.toLowerCase()),this.tokenizer.tokenize(e)}convertIdsToTokens(e){const n=[];return e.forEach(r=>{n.push(this.tokenizer.vocab[r])}),n}convertTokensToId(e){return this.tokenizer.tokenize(e)}encodeText(e){const n=[],r=[],i=[],s=this.tokenize(e);n.push(this.clsId),r.push(1),i.push(0),n.push(...s),s.forEach(a=>{r.push(1),i.push(0)}),n.push(this.sepId),r.push(1),i.push(0);const o=n.length;for(let a=0;a<this.maxSeqLength-o;a++)n.push(0),r.push(0),i.push(0);return{inputIds:n,segmentIds:i,inputMask:r}}}const Hu=[768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,1155,1156,1157,1158,1159,1425,1426,1427,1428,1429,1430,1431,1432,1433,1434,1435,1436,1437,1438,1439,1440,1441,1442,1443,1444,1445,1446,1447,1448,1449,1450,1451,1452,1453,1454,1455,1456,1457,1458,1459,1460,1461,1462,1463,1464,1465,1466,1467,1468,1469,1471,1473,1474,1476,1477,1479,1552,1553,1554,1555,1556,1557,1558,1559,1560,1561,1562,1611,1612,1613,1614,1615,1616,1617,1618,1619,1620,1621,1622,1623,1624,1625,1626,1627,1628,1629,1630,1631,1648,1750,1751,1752,1753,1754,1755,1756,1759,1760,1761,1762,1763,1764,1767,1768,1770,1771,1772,1773,1809,1840,1841,1842,1843,1844,1845,1846,1847,1848,1849,1850,1851,1852,1853,1854,1855,1856,1857,1858,1859,1860,1861,1862,1863,1864,1865,1866,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,2027,2028,2029,2030,2031,2032,2033,2034,2035,2045,2070,2071,2072,2073,2075,2076,2077,2078,2079,2080,2081,2082,2083,2085,2086,2087,2089,2090,2091,2092,2093,2137,2138,2139,2259,2260,2261,2262,2263,2264,2265,2266,2267,2268,2269,2270,2271,2272,2273,2275,2276,2277,2278,2279,2280,2281,2282,2283,2284,2285,2286,2287,2288,2289,2290,2291,2292,2293,2294,2295,2296,2297,2298,2299,2300,2301,2302,2303,2304,2305,2306,2362,2364,2369,2370,2371,2372,2373,2374,2375,2376,2381,2385,2386,2387,2388,2389,2390,2391,2402,2403,2433,2492,2497,2498,2499,2500,2509,2530,2531,2558,2561,2562,2620,2625,2626,2631,2632,2635,2636,2637,2641,2672,2673,2677,2689,2690,2748,2753,2754,2755,2756,2757,2759,2760,2765,2786,2787,2810,2811,2812,2813,2814,2815,2817,2876,2879,2881,2882,2883,2884,2893,2902,2914,2915,2946,3008,3021,3072,3076,3134,3135,3136,3142,3143,3144,3146,3147,3148,3149,3157,3158,3170,3171,3201,3260,3263,3270,3276,3277,3298,3299,3328,3329,3387,3388,3393,3394,3395,3396,3405,3426,3427,3530,3538,3539,3540,3542,3633,3636,3637,3638,3639,3640,3641,3642,3655,3656,3657,3658,3659,3660,3661,3662,3761,3764,3765,3766,3767,3768,3769,3770,3771,3772,3784,3785,3786,3787,3788,3789,3864,3865,3893,3895,3897,3953,3954,3955,3956,3957,3958,3959,3960,3961,3962,3963,3964,3965,3966,3968,3969,3970,3971,3972,3974,3975,3981,3982,3983,3984,3985,3986,3987,3988,3989,3990,3991,3993,3994,3995,3996,3997,3998,3999,4e3,4001,4002,4003,4004,4005,4006,4007,4008,4009,4010,4011,4012,4013,4014,4015,4016,4017,4018,4019,4020,4021,4022,4023,4024,4025,4026,4027,4028,4038,4141,4142,4143,4144,4146,4147,4148,4149,4150,4151,4153,4154,4157,4158,4184,4185,4190,4191,4192,4209,4210,4211,4212,4226,4229,4230,4237,4253,4957,4958,4959,5906,5907,5908,5938,5939,5940,5970,5971,6002,6003,6068,6069,6071,6072,6073,6074,6075,6076,6077,6086,6089,6090,6091,6092,6093,6094,6095,6096,6097,6098,6099,6109,6155,6156,6157,6277,6278,6313,6432,6433,6434,6439,6440,6450,6457,6458,6459,6679,6680,6683,6742,6744,6745,6746,6747,6748,6749,6750,6752,6754,6757,6758,6759,6760,6761,6762,6763,6764,6771,6772,6773,6774,6775,6776,6777,6778,6779,6780,6783,6832,6833,6834,6835,6836,6837,6838,6839,6840,6841,6842,6843,6844,6845,6912,6913,6914,6915,6964,6966,6967,6968,6969,6970,6972,6978,7019,7020,7021,7022,7023,7024,7025,7026,7027,7040,7041,7074,7075,7076,7077,7080,7081,7083,7084,7085,7142,7144,7145,7149,7151,7152,7153,7212,7213,7214,7215,7216,7217,7218,7219,7222,7223,7376,7377,7378,7380,7381,7382,7383,7384,7385,7386,7387,7388,7389,7390,7391,7392,7394,7395,7396,7397,7398,7399,7400,7405,7412,7416,7417,7616,7617,7618,7619,7620,7621,7622,7623,7624,7625,7626,7627,7628,7629,7630,7631,7632,7633,7634,7635,7636,7637,7638,7639,7640,7641,7642,7643,7644,7645,7646,7647,7648,7649,7650,7651,7652,7653,7654,7655,7656,7657,7658,7659,7660,7661,7662,7663,7664,7665,7666,7667,7668,7669,7670,7671,7672,7673,7675,7676,7677,7678,7679,8400,8401,8402,8403,8404,8405,8406,8407,8408,8409,8410,8411,8412,8417,8421,8422,8423,8424,8425,8426,8427,8428,8429,8430,8431,8432,11503,11504,11505,11647,11744,11745,11746,11747,11748,11749,11750,11751,11752,11753,11754,11755,11756,11757,11758,11759,11760,11761,11762,11763,11764,11765,11766,11767,11768,11769,11770,11771,11772,11773,11774,11775,12330,12331,12332,12333,12441,12442,42607,42612,42613,42614,42615,42616,42617,42618,42619,42620,42621,42654,42655,42736,42737,43010,43014,43019,43045,43046,43204,43205,43232,43233,43234,43235,43236,43237,43238,43239,43240,43241,43242,43243,43244,43245,43246,43247,43248,43249,43263,43302,43303,43304,43305,43306,43307,43308,43309,43335,43336,43337,43338,43339,43340,43341,43342,43343,43344,43345,43392,43393,43394,43443,43446,43447,43448,43449,43452,43453,43493,43561,43562,43563,43564,43565,43566,43569,43570,43573,43574,43587,43596,43644,43696,43698,43699,43700,43703,43704,43710,43711,43713,43756,43757,43766,44005,44008,44013,64286,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65056,65057,65058,65059,65060,65061,65062,65063,65064,65065,65066,65067,65068,65069,65070,65071,66045,66272,66422,66423,66424,66425,66426,68097,68098,68099,68101,68102,68108,68109,68110,68111,68152,68153,68154,68159,68325,68326,68900,68901,68902,68903,69446,69447,69448,69449,69450,69451,69452,69453,69454,69455,69456,69633,69688,69689,69690,69691,69692,69693,69694,69695,69696,69697,69698,69699,69700,69701,69702,69759,69760,69761,69811,69812,69813,69814,69817,69818,69888,69889,69890,69927,69928,69929,69930,69931,69933,69934,69935,69936,69937,69938,69939,69940,70003,70016,70017,70070,70071,70072,70073,70074,70075,70076,70077,70078,70089,70090,70091,70092,70191,70192,70193,70196,70198,70199,70206,70367,70371,70372,70373,70374,70375,70376,70377,70378,70400,70401,70459,70460,70464,70502,70503,70504,70505,70506,70507,70508,70512,70513,70514,70515,70516,70712,70713,70714,70715,70716,70717,70718,70719,70722,70723,70724,70726,70750,70835,70836,70837,70838,70839,70840,70842,70847,70848,70850,70851,71090,71091,71092,71093,71100,71101,71103,71104,71132,71133,71219,71220,71221,71222,71223,71224,71225,71226,71229,71231,71232,71339,71341,71344,71345,71346,71347,71348,71349,71351,71453,71454,71455,71458,71459,71460,71461,71463,71464,71465,71466,71467,71727,71728,71729,71730,71731,71732,71733,71734,71735,71737,71738,72148,72149,72150,72151,72154,72155,72160,72193,72194,72195,72196,72197,72198,72199,72200,72201,72202,72243,72244,72245,72246,72247,72248,72251,72252,72253,72254,72263,72273,72274,72275,72276,72277,72278,72281,72282,72283,72330,72331,72332,72333,72334,72335,72336,72337,72338,72339,72340,72341,72342,72344,72345,72752,72753,72754,72755,72756,72757,72758,72760,72761,72762,72763,72764,72765,72767,72850,72851,72852,72853,72854,72855,72856,72857,72858,72859,72860,72861,72862,72863,72864,72865,72866,72867,72868,72869,72870,72871,72874,72875,72876,72877,72878,72879,72880,72882,72883,72885,72886,73009,73010,73011,73012,73013,73014,73018,73020,73021,73023,73024,73025,73026,73027,73028,73029,73031,73104,73105,73109,73111,73459,73460,92912,92913,92914,92915,92916,92976,92977,92978,92979,92980,92981,92982,94031,94095,94096,94097,94098,113821,113822,119143,119144,119145,119163,119164,119165,119166,119167,119168,119169,119170,119173,119174,119175,119176,119177,119178,119179,119210,119211,119212,119213,119362,119363,119364,121344,121345,121346,121347,121348,121349,121350,121351,121352,121353,121354,121355,121356,121357,121358,121359,121360,121361,121362,121363,121364,121365,121366,121367,121368,121369,121370,121371,121372,121373,121374,121375,121376,121377,121378,121379,121380,121381,121382,121383,121384,121385,121386,121387,121388,121389,121390,121391,121392,121393,121394,121395,121396,121397,121398,121403,121404,121405,121406,121407,121408,121409,121410,121411,121412,121413,121414,121415,121416,121417,121418,121419,121420,121421,121422,121423,121424,121425,121426,121427,121428,121429,121430,121431,121432,121433,121434,121435,121436,121437,121438,121439,121440,121441,121442,121443,121444,121445,121446,121447,121448,121449,121450,121451,121452,121461,121476,121499,121500,121501,121502,121503,121505,121506,121507,121508,121509,121510,121511,121512,121513,121514,121515,121516,121517,121518,121519,122880,122881,122882,122883,122884,122885,122886,122888,122889,122890,122891,122892,122893,122894,122895,122896,122897,122898,122899,122900,122901,122902,122903,122904,122907,122908,122909,122910,122911,122912,122913,122915,122916,122918,122919,122920,122921,122922,123184,123185,123186,123187,123188,123189,123190,123628,123629,123630,123631,125136,125137,125138,125139,125140,125141,125142,125252,125253,125254,125255,125256,125257,125258,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999],Wu=[33,34,35,37,38,39,40,41,42,44,45,46,47,58,59,63,64,91,92,93,95,123,125,161,167,171,182,183,187,191,894,903,1370,1371,1372,1373,1374,1375,1417,1418,1470,1472,1475,1478,1523,1524,1545,1546,1548,1549,1563,1566,1567,1642,1643,1644,1645,1748,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,2039,2040,2041,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2142,2404,2405,2416,2557,2678,2800,3191,3204,3572,3663,3674,3675,3844,3845,3846,3847,3848,3849,3850,3851,3852,3853,3854,3855,3856,3857,3858,3860,3898,3899,3900,3901,3973,4048,4049,4050,4051,4052,4057,4058,4170,4171,4172,4173,4174,4175,4347,4960,4961,4962,4963,4964,4965,4966,4967,4968,5120,5742,5787,5788,5867,5868,5869,5941,5942,6100,6101,6102,6104,6105,6106,6144,6145,6146,6147,6148,6149,6150,6151,6152,6153,6154,6468,6469,6686,6687,6816,6817,6818,6819,6820,6821,6822,6824,6825,6826,6827,6828,6829,7002,7003,7004,7005,7006,7007,7008,7164,7165,7166,7167,7227,7228,7229,7230,7231,7294,7295,7360,7361,7362,7363,7364,7365,7366,7367,7379,8208,8209,8210,8211,8212,8213,8214,8215,8216,8217,8218,8219,8220,8221,8222,8223,8224,8225,8226,8227,8228,8229,8230,8231,8240,8241,8242,8243,8244,8245,8246,8247,8248,8249,8250,8251,8252,8253,8254,8255,8256,8257,8258,8259,8261,8262,8263,8264,8265,8266,8267,8268,8269,8270,8271,8272,8273,8275,8276,8277,8278,8279,8280,8281,8282,8283,8284,8285,8286,8317,8318,8333,8334,8968,8969,8970,8971,9001,9002,10088,10089,10090,10091,10092,10093,10094,10095,10096,10097,10098,10099,10100,10101,10181,10182,10214,10215,10216,10217,10218,10219,10220,10221,10222,10223,10627,10628,10629,10630,10631,10632,10633,10634,10635,10636,10637,10638,10639,10640,10641,10642,10643,10644,10645,10646,10647,10648,10712,10713,10714,10715,10748,10749,11513,11514,11515,11516,11518,11519,11632,11776,11777,11778,11779,11780,11781,11782,11783,11784,11785,11786,11787,11788,11789,11790,11791,11792,11793,11794,11795,11796,11797,11798,11799,11800,11801,11802,11803,11804,11805,11806,11807,11808,11809,11810,11811,11812,11813,11814,11815,11816,11817,11818,11819,11820,11821,11822,11824,11825,11826,11827,11828,11829,11830,11831,11832,11833,11834,11835,11836,11837,11838,11839,11840,11841,11842,11843,11844,11845,11846,11847,11848,11849,11850,11851,11852,11853,11854,11855,12289,12290,12291,12296,12297,12298,12299,12300,12301,12302,12303,12304,12305,12308,12309,12310,12311,12312,12313,12314,12315,12316,12317,12318,12319,12336,12349,12448,12539,42238,42239,42509,42510,42511,42611,42622,42738,42739,42740,42741,42742,42743,43124,43125,43126,43127,43214,43215,43256,43257,43258,43260,43310,43311,43359,43457,43458,43459,43460,43461,43462,43463,43464,43465,43466,43467,43468,43469,43486,43487,43612,43613,43614,43615,43742,43743,43760,43761,44011,64830,64831,65040,65041,65042,65043,65044,65045,65046,65047,65048,65049,65072,65073,65074,65075,65076,65077,65078,65079,65080,65081,65082,65083,65084,65085,65086,65087,65088,65089,65090,65091,65092,65093,65094,65095,65096,65097,65098,65099,65100,65101,65102,65103,65104,65105,65106,65108,65109,65110,65111,65112,65113,65114,65115,65116,65117,65118,65119,65120,65121,65123,65128,65130,65131,65281,65282,65283,65285,65286,65287,65288,65289,65290,65292,65293,65294,65295,65306,65307,65311,65312,65339,65340,65341,65343,65371,65373,65375,65376,65377,65378,65379,65380,65381,65792,65793,65794,66463,66512,66927,67671,67871,67903,68176,68177,68178,68179,68180,68181,68182,68183,68184,68223,68336,68337,68338,68339,68340,68341,68342,68409,68410,68411,68412,68413,68414,68415,68505,68506,68507,68508,69461,69462,69463,69464,69465,69703,69704,69705,69706,69707,69708,69709,69819,69820,69822,69823,69824,69825,69952,69953,69954,69955,70004,70005,70085,70086,70087,70088,70093,70107,70109,70110,70111,70200,70201,70202,70203,70204,70205,70313,70731,70732,70733,70734,70735,70747,70749,70854,71105,71106,71107,71108,71109,71110,71111,71112,71113,71114,71115,71116,71117,71118,71119,71120,71121,71122,71123,71124,71125,71126,71127,71233,71234,71235,71264,71265,71266,71267,71268,71269,71270,71271,71272,71273,71274,71275,71276,71484,71485,71486,71739,72162,72255,72256,72257,72258,72259,72260,72261,72262,72346,72347,72348,72350,72351,72352,72353,72354,72769,72770,72771,72772,72773,72816,72817,73463,73464,73727,74864,74865,74866,74867,74868,92782,92783,92917,92983,92984,92985,92986,92987,92996,93847,93848,93849,93850,94178,113823,121479,121480,121481,121482,121483,125278,125279],Vu=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159],Gu=[32,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288];class Ju{constructor(e){this.options={executionProviders:["wasm"],graphOptimizationLevel:"all"},this.session=void 0,this.labels=[],this.isReady=!1,this.scriptsInjected=new gn(!1),Ou(e),this.injectScript("onnxruntime-web","https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js",()=>this.scriptsInjected.next(!0))}loadModels(e,n){fe(this.loadLabelSets(e,n)).subscribe(),this.scriptsInjected.pipe(le(r=>r),se(1),z(()=>fe(this.loadModelDefinition(e,n))),z(r=>r.ok?fe(r.json()):Dr(()=>new Error("Unable to load modelType"))),z(r=>{const i=`${Fu()}models/classifier/${r.model}/vocab.json`,s=`${e}/train/classifier/model/onnx_models/model-int8.onnx`,o=ort.InferenceSession.create(s,this.options);return qn([fe($u(i,!1,!0)),fe(o.then(a=>this.session=a))])})).subscribe(([r,i])=>{this.tokenizer=r,this.isReady=!0})}predict(e){return this.isReady?fe(this.lm_inference(e)).pipe(E(n=>n.filter(r=>r.score>.5).map(r=>{const[i,s]=r.label.split("/");return{labelset:i,label:s}}))):(wn("Model not loaded yet"),B([]))}async lm_inference(e){var l;const n=(l=this.tokenizer)==null?void 0:l.tokenize(e);if(wn(n),!n||n.length===0)return Promise.resolve([]);const r=performance.now(),i=this.create_model_input(n),s=await this.session.run(i),o=(performance.now()-r).toFixed(1),a=[];for(let c=0;c<this.labels.length;c++)a[c]={label:this.labels[c][0],score:s.probabilities.data[c]};return a.sort((c,u)=>c.score===u.score?0:c.score<u.score?1:-1),wn("duration",o),wn("result",a),a}create_model_input(e){const n=new Array(e.length+1),r=new Array(e.length+1),i=new Array(e.length+1);n[0]=BigInt(101),r[0]=BigInt(1),i[0]=BigInt(0);for(let c=0;c<e.length;c++)n[c+1]=BigInt(e[c]),r[c+1]=BigInt(1),i[c+1]=BigInt(0);n[e.length]=BigInt(102),r[e.length]=BigInt(1),i[e.length]=BigInt(0);const s=n.length,o=new ort.Tensor("int64",BigInt64Array.from(n),[1,s]),a=new ort.Tensor("int64",BigInt64Array.from(r),[1,s]),l=new ort.Tensor("int64",BigInt64Array.from(i),[1,s]);return{input_ids:o,attention_mask:a,token_type_ids:l}}async loadLabelSets(e,n){return fetch(`${e}/train/classifier/model/model_files/pos_to_lab.json`,{headers:n}).then(r=>{r.ok?r.json().then(i=>this.labels=i.labels):console.info("No trained labels in knowledge box")})}injectScript(e,n,r){if(!document.getElementById(e)){const i=window.document.createElement("script");i.id=e,i.type="text/javascript",i.async=!0,i.defer=!0,i.src=n,i.onload=r,window.document.body.appendChild(i)}}async loadModelDefinition(e,n){const r=`${e}/train/classifier/model/model/nuclia.json`;return fetch(r,{headers:n})}}const X=new Dt({query:"",filters:{},options:{inTitleOnly:!1,highlight:!0,page_number:0},show:[q.BASIC,q.VALUES,q.ORIGIN],results:so,pending:!1,showResults:!1,tracking:{startTime:0,resultsReceived:!1,searchId:void 0,engagement:{}}}),Ut=X.writer(t=>t.query,(t,e)=>{const n=e.trim();return n!==t.query?{...t,query:n,error:void 0,autofilerDisabled:!1}:t}),Kn=X.writer(t=>t.results,(t,e)=>{const n=So(Object.values(e.results.resources||{})),{resources:r,...i}=e.results;return{...t,results:{...i,resultList:e.append?t.results.resultList.concat(n):n},pending:!1,showResults:!0,filters:{...t.filters,autofilters:e.append?t.filters.autofilters:(e.results.autofilters||[]).map(s=>Ws(s))}}}),Yr=X.reader(t=>t.results.resultList),Qn=X.writer(t=>t.showResults,(t,e)=>({...t,showResults:e})),Ku=X.reader(t=>!!t.error),Qu=X.reader(t=>!!t.error&&t.error.status===206),go=X.writer(t=>t.error,(t,e)=>({...t,error:e,pending:!1,showResults:!0})),vo=X.writer(t=>t.options,(t,e)=>({...t,options:e})),Xu=X.writer(t=>t.show,(t,e)=>({...t,show:e})),Xn=X.writer(t=>[...(t.filters.labels||[]).map(e=>Qc(e.classification)),...(t.filters.entities||[]).map(e=>Yc(e))],(t,e)=>{const n={};return e.filters.forEach(r=>{const i=r.split("/").filter(s=>!!s);if(i[0]==="l"){const s={classification:Xc(r),kind:e.titleOnly?Wn.RESOURCES:Wn.PARAGRAPHS};n.labels?n.labels.push(s):n.labels=[s]}else if(i[0]==="e"){const s=Ws(r);n.entities?n.entities.push(s):n.entities=[s]}}),{...t,filters:n}}),Yu=X.writer(t=>t.filters.labels||[],(t,e)=>({...t,filters:{...t.filters,labels:e}})),Zu=X.writer(t=>t.filters.entities||[],(t,e)=>({...t,filters:{...t.filters,entities:e}}));X.writer(t=>t.filters.autofilters||[],(t,e)=>({...t,filters:{...t.filters,autofilters:e}}));const _o=X.writer(t=>t.autofilerDisabled,(t,e)=>({...t,autofilerDisabled:e})),Yn=X.reader(t=>!t.query&&(!t.filters.labels||t.filters.labels.length===0)&&(!t.filters.entities||t.filters.entities.length===0)),ed=X.reader(t=>t.results.next_page),mo=X.writer(t=>t.options.page_number||0,t=>({...t,options:{...t.options,page_number:(t.options.page_number||0)+1}})),td=X.writer(t=>t.options.page_number||0,(t,e)=>({...t,options:{...t.options,page_number:e}})),Zn=X.writer(t=>t.pending,(t,e)=>({...t,pending:e})),yo=X.writer(t=>t.tracking.startTime,(t,e)=>({...t,tracking:{startTime:e,resultsReceived:!1,searchId:"",engagement:{}}})),Zr=X.writer(t=>t.tracking.searchId,(t,e)=>({...t,tracking:{...t.tracking,searchId:e}})),bo=X.writer(t=>t.tracking.resultsReceived,(t,e)=>({...t,tracking:{...t.tracking,resultsReceived:e}})),nd=X.writer(()=>{},t=>({...t,tracking:{...t.tracking,startTime:0,resultsReceived:!1}})),rd=tt([bo,yo,Zr]).pipe(le(([t,e])=>t&&e>0),E(([,t,e])=>({startTime:t,searchId:e}))),wo=X.writer(t=>t.tracking.engagement,(t,e)=>{var i,s,o;const n=t.results.resultList,r=e.rid?n.find(a=>a.id===e.rid):void 0;return{...t,tracking:{...t.tracking,engagement:{type:e.type,resourceRank:r?n.findIndex(a=>a.id===e.rid):void 0,paragraphRank:r&&e.paragraph?(i=r.paragraphs)==null?void 0:i.findIndex(a=>{var l;return a.id===((l=e.paragraph)==null?void 0:l.id)}):void 0,paragraphType:(s=e.paragraph)==null?void 0:s.score_type,paragraphOrder:(o=e.paragraph)==null?void 0:o.order,searchId:t.tracking.searchId}}}}),id=X.reader(t=>{var e;return Object.entries(((e=t.results.relations)==null?void 0:e.entities)||{}).map(([n,r])=>({entity:n,relations:r.related_to.filter(i=>i.entity_type==="entity"&&i.relation_label.length>0).reduce((i,s)=>(i[s.relation_label]?i[s.relation_label].push(s.entity):i[s.relation_label]=[s.entity],i),{})})).filter(n=>Object.keys(n.relations).length>0)}),ko=tt([Ut,Yu,Zu]).pipe(E(([t,e,n])=>!t&&!!e&&e.every(r=>r.kind===Wn.RESOURCES)&&(n||[]).length===0)),vt=new zt;function So(t){if(!t)return[];const e=[];return t.filter(n=>{var r;return!!((r=n.origin)!=null&&r.url)}).reduce((n,r)=>{const i=Object.keys(r.fields).length,s=Object.entries(r.fields).filter(([o])=>{const a=o.split("/")[1];return i===1?!0:o!=="/a/title"&&Ys(a)!==null}).map(([o,a])=>{let[,l,c]=o.split("/"),u;if(l===nt.generic&&r.data)u=Object.entries(r.data).filter(([,_])=>!!_).map(([_,v])=>({field_type:Jr(_.substring(0,_.length-1)),field_id:Object.keys(v)[0]})).filter(_=>_.field_type!==D.generic)[0];else{const _=Ys(l);u={field_id:c,field_type:_}}const d={...r,field:u,fieldData:Eo(r,u),paragraphs:o!=="/a/title"?Object.values(a.paragraphs).sort((_,v)=>_.order-v.order):[]},{resultType:f,resultIcon:h}=Io(d),g={...d,resultType:f,resultIcon:h},p=Ao(g);return e.includes(p)?null:(e.push(p),g)}).filter(o=>!!o).map(o=>o);return n=n.concat(s),n},[])}function Eo(t,e){var r,i;const n=ou(e.field_type);return n?(i=(r=t.data)==null?void 0:r[n])==null?void 0:i[e.field_id]:void 0}function Ao(t){return t.paragraphs&&t.paragraphs.length>0?`${(t.paragraphs||[]).reduce((e,n)=>`${e}${e.length>0?"__":""}${n.id}`,"")}`:t.id}const sd=["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.oasis.opendocument.spreadsheet"];function Io(t){var s,o,a,l,c,u,d,f,h,g;const e=(s=t==null?void 0:t.field)==null?void 0:s.field_type,n=(o=t==null?void 0:t.fieldData)==null?void 0:o.value;let r,i="";if(e===D.link&&n){const p=(a=t.fieldData.value)==null?void 0:a.uri;r=p!=null&&p.includes("youtube.com")||p!=null&&p.includes("youtu.be")?"video":"text"}else if(e===D.conversation)r="conversation";else if(e===D.file&&n){const p=(l=t.fieldData.value)==null?void 0:l.file;(c=p==null?void 0:p.content_type)!=null&&c.startsWith("audio")?r="audio":(u=p==null?void 0:p.content_type)!=null&&u.startsWith("video")?r="video":(d=p==null?void 0:p.content_type)!=null&&d.startsWith("image")?r="image":(f=p==null?void 0:p.content_type)!=null&&f.startsWith("text")?r="text":sd.includes((p==null?void 0:p.content_type)||"")?r="spreadsheet":(h=p==null?void 0:p.content_type)!=null&&h.startsWith("application/octet-stream")?r="text":(g=p==null?void 0:p.content_type)!=null&&g.startsWith("application")?(r="pdf",i=(p==null?void 0:p.content_type)==="application/pdf"?"pdf":"generic"):r="text"}else r="text";return{resultType:r,resultIcon:i||r}}function xo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xo(Object(n),!0).forEach(function(r){N(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xo(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Tt(t){return Tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tt(t)}function ce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function To(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ue(t,e,n){return e&&To(t.prototype,e),n&&To(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function N(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ro(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ei(t,e)}function er(t){return er=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},er(t)}function ei(t,e){return ei=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},ei(t,e)}function od(t,e){if(t==null)return{};var n,r,i=function(o,a){if(o==null)return{};var l,c,u={},d=Object.keys(o);for(c=0;c<d.length;c++)l=d[c],a.indexOf(l)>=0||(u[l]=o[l]);return u}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function ad(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(t)}function Po(t){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var n,r=er(t);if(e){var i=er(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ad(this,n)}}function Rt(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var i=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(i!=null){var s,o,a=[],l=!0,c=!1;try{for(i=i.call(n);!(l=(s=i.next()).done)&&(a.push(s.value),!r||a.length!==r);l=!0);}catch(u){c=!0,o=u}finally{try{l||i.return==null||i.return()}finally{if(c)throw o}}return a}}(t,e)||ni(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ti(t){return function(e){if(Array.isArray(e))return ri(e)}(t)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(t)||ni(t)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ni(t,e){if(t){if(typeof t=="string")return ri(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ri(t,e):void 0}}function ri(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _t(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=ni(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{o||n.return==null||n.return()}finally{if(a)throw s}}}}var rt={DEBUG:!1,LIB_VERSION:"1.68.4"};/**
 * uuidv7: An experimental implementation of the proposed UUID Version 7
 *
 * @license Apache-2.0
 * @copyright 2021-2023 LiosK
 * @packageDocumentation
 *
 * from https://github.com/LiosK/uuidv7/blob/e501462ea3d23241de13192ceae726956f9b3b7d/src/index.ts
 */Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Number.isInteger||(Number.isInteger=function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t});var Oo="0123456789abcdef",ld=function(){function t(e){if(ce(this,t),this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}return ue(t,[{key:"toString",value:function(){for(var e="",n=0;n<this.bytes.length;n++)e+=Oo.charAt(this.bytes[n]>>>4),e+=Oo.charAt(15&this.bytes[n]),n!==3&&n!==5&&n!==7&&n!==9||(e+="-");return e}},{key:"clone",value:function(){return new t(this.bytes.slice(0))}},{key:"equals",value:function(e){return this.compareTo(e)===0}},{key:"compareTo",value:function(e){for(var n=0;n<16;n++){var r=this.bytes[n]-e.bytes[n];if(r!==0)return Math.sign(r)}return 0}}],[{key:"fromFieldsV7",value:function(e,n,r,i){if(!Number.isInteger(e)||!Number.isInteger(n)||!Number.isInteger(r)||!Number.isInteger(i)||e<0||n<0||r<0||i<0||e>0xffffffffffff||n>4095||r>1073741823||i>4294967295)throw new RangeError("invalid field value");var s=new Uint8Array(16);return s[0]=e/Math.pow(2,40),s[1]=e/Math.pow(2,32),s[2]=e/Math.pow(2,24),s[3]=e/Math.pow(2,16),s[4]=e/Math.pow(2,8),s[5]=e,s[6]=112|n>>>8,s[7]=n,s[8]=128|r>>>24,s[9]=r>>>16,s[10]=r>>>8,s[11]=r,s[12]=i>>>24,s[13]=i>>>16,s[14]=i>>>8,s[15]=i,new t(s)}}]),t}(),cd=function(){function t(){ce(this,t),N(this,"timestamp",0),N(this,"counter",0),N(this,"random",new ud)}return ue(t,[{key:"generate",value:function(){var e=this.generateOrAbort();if(e!==void 0)return e;this.timestamp=0;var n=this.generateOrAbort();if(n===void 0)throw new Error("Could not generate UUID after timestamp reset");return n}},{key:"generateOrAbort",value:function(){var e=Date.now();if(e>this.timestamp)this.timestamp=e,this.resetCounter();else{if(!(e+1e4>this.timestamp))return;this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter())}return ld.fromFieldsV7(this.timestamp,Math.trunc(this.counter/Math.pow(2,30)),this.counter&Math.pow(2,30)-1,this.random.nextUint32())}},{key:"resetCounter",value:function(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}}]),t}(),Fo=function(t){if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<t.length;e++)t[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return t};typeof crypto<"u"&&crypto.getRandomValues&&(Fo=function(t){return crypto.getRandomValues(t)});var Co,ud=function(){function t(){ce(this,t),N(this,"buffer",new Uint32Array(8)),N(this,"cursor",1/0)}return ue(t,[{key:"nextUint32",value:function(){return this.cursor>=this.buffer.length&&(Fo(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}]),t}(),dd=function(){return(Co||(Co=new cd)).generate()},$o=Array.prototype,jo=Object.prototype,tr=jo.toString,fd=jo.hasOwnProperty,F=typeof window<"u"?window:{},Bt=F.navigator||{userAgent:""},_e=F.document||{},Je=Bt.userAgent,hd=["localhost","127.0.0.1"],Mo=$o.forEach,No=$o.indexOf,pd=Array.isArray,ii={},re={log:function(){if(rt.DEBUG&&!Xe(window.console)&&window.console){for(var t=("__rrweb_original__"in window.console.log)?window.console.log.__rrweb_original__:window.console.log,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];try{t.apply(window.console,n)}catch{mt(n,function(s){t(s)})}}},error:function(){if(rt.DEBUG&&!Xe(window.console)&&window.console){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=["PostHog error:"].concat(e),i="__rrweb_original__"in window.console.error?window.console.error.__rrweb_original__:window.console.error;try{i.apply(window.console,r)}catch{mt(r,function(o){i(o)})}}},critical:function(){if(!Xe(window.console)&&window.console){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=["PostHog error:"].concat(e),i="__rrweb_original__"in window.console.error?window.console.error.__rrweb_original__:window.console.error;try{i.apply(window.console,r)}catch{mt(r,function(o){i(o)})}}}},si=function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function mt(t,e,n){if(Array.isArray(t)){if(Mo&&t.forEach===Mo)t.forEach(e,n);else if("length"in t&&t.length===+t.length){for(var r=0,i=t.length;r<i;r++)if(r in t&&e.call(n,t[r],r)===ii)return}}}function W(t,e,n){if(t!=null){if(Array.isArray(t))return mt(t,e,n);for(var r in t)if(fd.call(t,r)&&e.call(n,t[r],r)===ii)return}}var Ae=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return mt(n,function(i){for(var s in i)i[s]!==void 0&&(t[s]=i[s])}),t},yt=pd||function(t){return tr.call(t)==="[object Array]"},Lo=function(t){try{return/^\s*\bfunction\b/.test(t)}catch{return!1}};function Q(t,e){return t.indexOf(e)!==-1}var qt=function(t){return t===Object(t)&&!yt(t)},Xe=function(t){return t===void 0},zo=function(t){return tr.call(t)=="[object String]"},gd=function(t){return tr.call(t)=="[object Number]"},vd=function t(e){return W(e,function(n,r){(function(i){return tr.call(i)=="[object Date]"})(n)?e[r]=_d(n):qt(n)&&(e[r]=t(n))}),e},_d=function(t){function e(n){return n<10?"0"+n:n}return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())},Do=function(t){return function(){try{for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(this,n)}catch(i){re.critical("Implementation error. Please turn on debug and contact support@posthog.com."),re.critical(i)}}},oi=function(t){var e={};return W(t,function(n,r){zo(n)&&n.length>0&&(e[r]=n)}),e},md=["$performance_raw"];function Uo(t,e){return n=t,r=function(s,o){return o&&md.indexOf(o)>-1?s:typeof s=="string"&&e!==null?s.slice(0,e):s},i=new Set,function s(o,a){return o!==Object(o)?r?r(o,a):o:i.has(o)?void 0:(i.add(o),yt(o)?(l=[],mt(o,function(c){l.push(s(c))})):(l={},W(o,function(c,u){i.has(c)||(l[u]=s(c,u))})),l);var l}(n);var n,r,i}function nr(t){var e,n,r,i,s,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,l=0,c="",u=[];if(!t)return t;t=yd(t);do e=(s=t.charCodeAt(a++)<<16|t.charCodeAt(a++)<<8|t.charCodeAt(a++))>>18&63,n=s>>12&63,r=s>>6&63,i=63&s,u[l++]=o.charAt(e)+o.charAt(n)+o.charAt(r)+o.charAt(i);while(a<t.length);switch(c=u.join(""),t.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c}var ai,yd=function(t){var e,n,r,i,s="";for(e=n=0,r=(t=(t+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,i=0;i<r;i++){var o=t.charCodeAt(i),a=null;o<128?n++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),a!==null&&(n>e&&(s+=t.substring(e,n)),s+=a,e=n=i+1)}return n>e&&(s+=t.substring(e,t.length)),s},bt=(ai=function(){for(var t=new Date().valueOf(),e=0;t==new Date().valueOf();)e++;return t.toString(16)+e.toString(16)},function(t){if(t==="v7")return dd().toString();var e=typeof window<"u"?(window.screen.height*window.screen.width).toString(16):"0";return ai()+"-"+Math.random().toString(16).replace(".","")+"-"+function(){var n,r,i=Je,s=0,o=[];function a(l,c){var u,d=0;for(u=0;u<c.length;u++)d|=o[u]<<8*u;return l^d}for(n=0;n<i.length;n++)r=i.charCodeAt(n),o.unshift(255&r),o.length>=4&&(s=a(s,o),o=[]);return o.length>0&&(s=a(s,o)),s.toString(16)}()+"-"+e+"-"+ai()}),bd=function(t){return!!/(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp|ahrefsbot|facebookexternalhit|facebookcatalog|applebot|semrushbot|duckduckbot|twitterbot|rogerbot|linkedinbot|mj12bot|sitebulb|bot.htm|bot.php|hubspot|crawler|prerender)/i.test(t)},Bo=function(t,e){var n=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]"),r=new RegExp("[\\?&]"+n+"=([^&#]*)").exec(t);if(r===null||r&&typeof r[1]!="string"&&r[1].length)return"";var i=r[1];try{i=decodeURIComponent(i)}catch{re.error("Skipping decoding for malformed query param: "+i)}return i.replace(/\+/g," ")},qo=function(t,e){var n=t.match(new RegExp(e+"=([^&]*)"));return n?n[1]:null},kn=function(){function t(e){return e&&(e.preventDefault=t.preventDefault,e.stopPropagation=t.stopPropagation),e}return t.preventDefault=function(){this.returnValue=!1},t.stopPropagation=function(){this.cancelBubble=!0},function(e,n,r,i,s){if(e)if(e.addEventListener&&!i)e.addEventListener(n,r,!!s);else{var o="on"+n,a=e[o];e[o]=function(l,c,u){return function(d){if(d=d||t(window.event)){var f,h=!0;Lo(u)&&(f=u(d));var g=c.call(l,d);return f!==!1&&g!==!1||(h=!1),h}}}(e,r,a)}else re.error("No valid element provided to register_event")}}();function li(t,e){var n=function(){var r=_e.createElement("script");r.type="text/javascript",r.src=t,r.onload=function(o){return e(void 0,o)},r.onerror=function(o){return e(o)};var i,s=_e.querySelectorAll("body > script");s.length>0?(i=s[0].parentNode)===null||i===void 0||i.insertBefore(r,s[0]):_e.body.appendChild(r)};_e.body?n():_e.addEventListener("DOMContentLoaded",n)}var me={campaignParams:function(t){var e=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gclid","fbclid","msclkid"].concat(t||[]),n={};return W(e,function(r){var i=Bo(_e.URL,r);i.length&&(n[r]=i)}),n},searchEngine:function(){var t=_e.referrer;return t?t.search("https?://(.*)google.([^/?]*)")===0?"google":t.search("https?://(.*)bing.com")===0?"bing":t.search("https?://(.*)yahoo.com")===0?"yahoo":t.search("https?://(.*)duckduckgo.com")===0?"duckduckgo":null:null},searchInfo:function(){var t=me.searchEngine(),e=t!="yahoo"?"q":"p",n={};if(t!==null){n.$search_engine=t;var r=Bo(_e.referrer,e);r.length&&(n.ph_keyword=r)}return n},browser:function(t,e,n){return e=e||"",n||Q(t," OPR/")?Q(t,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(t)?"BlackBerry":Q(t,"IEMobile")||Q(t,"WPDesktop")?"Internet Explorer Mobile":Q(t,"SamsungBrowser/")?"Samsung Internet":Q(t,"Edge")||Q(t,"Edg/")?"Microsoft Edge":Q(t,"FBIOS")?"Facebook Mobile":Q(t,"Chrome")?"Chrome":Q(t,"CriOS")?"Chrome iOS":Q(t,"UCWEB")||Q(t,"UCBrowser")?"UC Browser":Q(t,"FxiOS")?"Firefox iOS":Q(e,"Apple")?Q(t,"Mobile")?"Mobile Safari":"Safari":Q(t,"Android")?"Android Mobile":Q(t,"Konqueror")?"Konqueror":Q(t,"Firefox")?"Firefox":Q(t,"MSIE")||Q(t,"Trident/")?"Internet Explorer":Q(t,"Gecko")?"Mozilla":""},browserVersion:function(t,e,n){var r={"Internet Explorer Mobile":/rv:(\d+(\.\d+)?)/,"Microsoft Edge":/Edge?\/(\d+(\.\d+)?)/,Chrome:/Chrome\/(\d+(\.\d+)?)/,"Chrome iOS":/CriOS\/(\d+(\.\d+)?)/,"UC Browser":/(UCBrowser|UCWEB)\/(\d+(\.\d+)?)/,Safari:/Version\/(\d+(\.\d+)?)/,"Mobile Safari":/Version\/(\d+(\.\d+)?)/,Opera:/(Opera|OPR)\/(\d+(\.\d+)?)/,Firefox:/Firefox\/(\d+(\.\d+)?)/,"Firefox iOS":/FxiOS\/(\d+(\.\d+)?)/,Konqueror:/Konqueror:(\d+(\.\d+)?)/,BlackBerry:/BlackBerry (\d+(\.\d+)?)/,"Android Mobile":/android\s(\d+(\.\d+)?)/,"Samsung Internet":/SamsungBrowser\/(\d+(\.\d+)?)/,"Internet Explorer":/(rv:|MSIE )(\d+(\.\d+)?)/,Mozilla:/rv:(\d+(\.\d+)?)/}[me.browser(t,e,n)];if(r===void 0)return null;var i=t.match(r);return i?parseFloat(i[i.length-2]):null},browserLanguage:function(){return Bt.language||Bt.userLanguage},os:function(t){if(/Windows/i.test(t)){if(/Phone/.test(t)||/WPDesktop/.test(t))return{os_name:"Windows Phone",os_version:""};var e=/Windows NT ([0-9.]+)/i.exec(t);return e&&e[1]?{os_name:"Windows",os_version:e[1]}:{os_name:"Windows",os_version:""}}if(/(iPhone|iPad|iPod)/.test(t)){var n=/OS (\d+)_(\d+)_?(\d+)?/i.exec(t);return n&&n[1]?{os_name:"iOS",os_version:[n[1],n[2],n[3]||"0"].join(".")}:{os_name:"iOS",os_version:""}}if(/Android/.test(t)){var r=/Android (\d+)\.(\d+)\.?(\d+)?/i.exec(t);return r&&r[1]?{os_name:"Android",os_version:[r[1],r[2],r[3]||"0"].join(".")}:{os_name:"Android",os_version:""}}if(/(BlackBerry|PlayBook|BB10)/i.test(t))return{os_name:"BlackBerry",os_version:""};if(/Mac/i.test(t)){var i=/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i.exec(t);return i&&i[1]?{os_name:"Mac OS X",os_version:[i[1],i[2],i[3]||"0"].join(".")}:{os_name:"Mac OS X",os_version:""}}return/Linux/.test(t)?{os_name:"Linux",os_version:""}:/CrOS/.test(t)?{os_name:"Chrome OS",os_version:""}:{os_name:"",os_version:""}},device:function(t){return/Windows Phone/i.test(t)||/WPDesktop/.test(t)?"Windows Phone":/iPad/.test(t)?"iPad":/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(t)?"BlackBerry":/Android/.test(t)&&!/Mobile/.test(t)?"Android Tablet":/Android/.test(t)?"Android":""},deviceType:function(t){var e=this.device(t);return e==="iPad"||e==="Android Tablet"?"Tablet":e?"Mobile":"Desktop"},referrer:function(){return _e.referrer||"$direct"},referringDomain:function(){if(!_e.referrer)return"$direct";var t=_e.createElement("a");return t.href=_e.referrer,t.host},properties:function(){var t=me.os(Je),e=t.os_name,n=t.os_version;return Ae(oi({$os:e,$os_version:n,$browser:me.browser(Je,Bt.vendor,F.opera),$device:me.device(Je),$device_type:me.deviceType(Je)}),{$current_url:F==null?void 0:F.location.href,$host:F==null?void 0:F.location.host,$pathname:F==null?void 0:F.location.pathname,$browser_version:me.browserVersion(Je,Bt.vendor,F.opera),$browser_language:me.browserLanguage(),$screen_height:F==null?void 0:F.screen.height,$screen_width:F==null?void 0:F.screen.width,$viewport_height:F==null?void 0:F.innerHeight,$viewport_width:F==null?void 0:F.innerWidth,$lib:"web",$lib_version:rt.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:(Date.now=Date.now||function(){return+new Date},Date.now()/1e3)})},people_properties:function(){var t=me.os(Je),e=t.os_name,n=t.os_version;return Ae(oi({$os:e,$os_version:n,$browser:me.browser(Je,Bt.vendor,F.opera)}),{$browser_version:me.browserVersion(Je,Bt.vendor,F.opera)})}};function rr(t){switch(Tt(t.className)){case"string":return t.className;case"object":return("baseVal"in t.className?t.className.baseVal:null)||t.getAttribute("class")||"";default:return""}}function ir(t){var e="";return sr(t)&&!Go(t)&&t.childNodes&&t.childNodes.length&&W(t.childNodes,function(n){Wo(n)&&n.textContent&&(e+=si(n.textContent).split(/(\s+)/).filter(on).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255))}),si(e)}function Ho(t){return!!t&&t.nodeType===1}function Ht(t,e){return!!t&&!!t.tagName&&t.tagName.toLowerCase()===e.toLowerCase()}function Wo(t){return!!t&&t.nodeType===3}function Vo(t){return!!t&&t.nodeType===11}var ci=["a","button","form","input","select","textarea","label"];function sr(t){for(var e=t;e.parentNode&&!Ht(e,"body");e=e.parentNode){var n=rr(e).split(" ");if(Q(n,"ph-sensitive")||Q(n,"ph-no-capture"))return!1}if(Q(rr(t).split(" "),"ph-include"))return!0;var r=t.type||"";if(typeof r=="string")switch(r.toLowerCase()){case"hidden":case"password":return!1}var i=t.name||t.id||"";return!(typeof i=="string"&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(i.replace(/[^a-zA-Z0-9]/g,"")))}function Go(t){return!!(Ht(t,"input")&&!["button","checkbox","submit","reset"].includes(t.type)||Ht(t,"select")||Ht(t,"textarea")||t.getAttribute("contenteditable")==="true")}function on(t){return!(t===null||Xe(t)||typeof t=="string"&&(t=si(t),/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/.test((t||"").replace(/[- ]/g,""))||/(^\d{3}-?\d{2}-?\d{4}$)/.test(t)))}function Jo(t){var e=ir(t);return on(e="".concat(e," ").concat(Ko(t)).trim())?e:""}function Ko(t){var e="";return t&&t.childNodes&&t.childNodes.length&&W(t.childNodes,function(n){var r;if(n&&((r=n.tagName)===null||r===void 0?void 0:r.toLowerCase())==="span")try{var i=ir(n);e="".concat(e," ").concat(i).trim(),n.childNodes&&n.childNodes.length&&(e="".concat(e," ").concat(Ko(n)).trim())}catch(s){console.error(s)}}),e}var wd=function(){function t(e){ce(this,t),this.clicks=[],this.enabled=e}return ue(t,[{key:"isRageClick",value:function(e,n,r){if(!this.enabled)return!1;var i=this.clicks[this.clicks.length-1];if(i&&Math.abs(e-i.x)+Math.abs(n-i.y)<30&&r-i.timestamp<1e3){if(this.clicks.push({x:e,y:n,timestamp:r}),this.clicks.length===3)return!0}else this.clicks=[{x:e,y:n,timestamp:r}];return!1}}]),t}(),kd=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,it={is_supported:function(){return!0},error:function(t){re.error("cookieStore error: "+t)},get:function(t){try{for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];i.charAt(0)==" ";)i=i.substring(1,i.length);if(i.indexOf(e)===0)return decodeURIComponent(i.substring(e.length,i.length))}}catch{}return null},parse:function(t){var e;try{e=JSON.parse(it.get(t))||{}}catch{}return e},set:function(t,e,n,r,i){try{var s="",o="",a="";if(r){var l=document.location.hostname.match(kd),c=l?l[0]:"";s=c?"; domain=."+c:""}if(n){var u=new Date;u.setTime(u.getTime()+24*n*60*60*1e3),o="; expires="+u.toUTCString()}i&&(a="; secure");var d=t+"="+encodeURIComponent(JSON.stringify(e))+o+"; SameSite=Lax; path=/"+s+a;return document.cookie=d,d}catch{return}},remove:function(t,e){try{it.set(t,"",-1,e)}catch{return}}},ui=null,he={is_supported:function(){if(ui!==null)return ui;var t=!0;if(typeof window<"u")try{var e="__mplssupport__";he.set(e,"xyz"),he.get(e)!=='"xyz"'&&(t=!1),he.remove(e)}catch{t=!1}else t=!1;return t||re.error("localStorage unsupported; falling back to cookie store"),ui=t,t},error:function(t){re.error("localStorage error: "+t)},get:function(t){try{return window.localStorage.getItem(t)}catch(e){he.error(e)}return null},parse:function(t){try{return JSON.parse(he.get(t))||{}}catch{}return null},set:function(t,e){try{window.localStorage.setItem(t,JSON.stringify(e))}catch(n){he.error(n)}},remove:function(t){try{window.localStorage.removeItem(t)}catch(e){he.error(e)}}},di=M(M({},he),{},{parse:function(t){try{var e={};try{(e=it.parse(t)||{}).distinct_id&&it.set(t,{distinct_id:e.distinct_id})}catch{}var n=Ae(e,JSON.parse(he.get(t)||"{}"));return he.set(t,n),n}catch{}return null},set:function(t,e,n,r,i){try{he.set(t,e),e.distinct_id&&it.set(t,{distinct_id:e.distinct_id},n,r,i)}catch(s){he.error(s)}},remove:function(t,e){try{window.localStorage.removeItem(t),it.remove(t,e)}catch(n){he.error(n)}}}),or={},Sd={is_supported:function(){return!0},error:function(t){re.error("memoryStorage error: "+t)},get:function(t){return or[t]||null},parse:function(t){return or[t]||null},set:function(t,e){or[t]=e},remove:function(t){delete or[t]}},Wt=null,Ie={is_supported:function(){if(Wt!==null)return Wt;if(Wt=!0,typeof window<"u")try{var t="__support__";Ie.set(t,"xyz"),Ie.get(t)!=='"xyz"'&&(Wt=!1),Ie.remove(t)}catch{Wt=!1}else Wt=!1;return Wt},error:function(t){rt.DEBUG&&re.error("sessionStorage error: ",t)},get:function(t){try{return window.sessionStorage.getItem(t)}catch(e){Ie.error(e)}return null},parse:function(t){try{return JSON.parse(Ie.get(t))||null}catch{}return null},set:function(t,e){try{window.sessionStorage.setItem(t,JSON.stringify(e))}catch(n){Ie.error(n)}},remove:function(t){try{window.sessionStorage.removeItem(t)}catch(e){Ie.error(e)}}},Qo="$people_distinct_id",ar="__alias",Sn="__timers",Xo="$autocapture_disabled_server_side",fi="$session_recording_enabled_server_side",Yo="$console_log_recording_enabled_server_side",Zo="$session_recording_recorder_version_server_side",hi="$sesid",an="$enabled_feature_flags",pi="$early_access_features",ln="$stored_person_properties",Pt="$stored_group_properties",gi="$surveys",lr="$flag_call_reported",vi="$user_state",Ed=[Qo,ar,"__cmpns",Sn,fi,hi,an,vi,pi,Pt,ln,gi,lr],Ad=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"],ea=function(){function t(e){ce(this,t);var n="";e.token&&(n=e.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),this.props={},this.campaign_params_saved=!1,this.custom_campaign_params=e.custom_campaign_params||[],e.persistence_name?this.name="ph_"+e.persistence_name:this.name="ph_"+n+"_posthog",Ad.indexOf(e.persistence.toLowerCase())===-1&&(re.critical("Unknown persistence type "+e.persistence+"; falling back to cookie"),e.persistence="cookie");var r=e.persistence.toLowerCase();r==="localstorage"&&he.is_supported()?this.storage=he:r==="localstorage+cookie"&&di.is_supported()?this.storage=di:r==="sessionstorage"&&Ie.is_supported()?this.storage=Ie:this.storage=r==="memory"?Sd:it,this.user_state="anonymous",this.load(),this.update_config(e),this.save()}return ue(t,[{key:"properties",value:function(){var e={};return W(this.props,function(n,r){if(r===an&&Tt(n)==="object")for(var i=Object.keys(n),s=0;s<i.length;s++)e["$feature/".concat(i[s])]=n[i[s]];else a=r,l=!1,((o=Ed)===null?l:No&&o.indexOf===No?o.indexOf(a)!=-1:(W(o,function(c){if(l||(l=c===a))return ii}),l))||(e[r]=n);var o,a,l}),e}},{key:"load",value:function(){if(!this.disabled){var e=this.storage.parse(this.name);e&&(this.props=Ae({},e))}}},{key:"save",value:function(){this.disabled||this.storage.set(this.name,this.props,this.expire_days,this.cross_subdomain,this.secure)}},{key:"remove",value:function(){this.storage.remove(this.name,!1),this.storage.remove(this.name,!0)}},{key:"clear",value:function(){this.remove(),this.props={}}},{key:"register_once",value:function(e,n,r){var i=this;if(qt(e)){n===void 0&&(n="None"),this.expire_days=r===void 0?this.default_expiry:r;var s=!1;if(W(e,function(o,a){i.props.hasOwnProperty(a)&&i.props[a]!==n||(i.props[a]=o,s=!0)}),s)return this.save(),!0}return!1}},{key:"register",value:function(e,n){var r=this;if(qt(e)){this.expire_days=n===void 0?this.default_expiry:n;var i=!1;if(W(e,function(s,o){e.hasOwnProperty(o)&&r.props[o]!==s&&(r.props[o]=s,i=!0)}),i)return this.save(),!0}return!1}},{key:"unregister",value:function(e){e in this.props&&(delete this.props[e],this.save())}},{key:"update_campaign_params",value:function(){this.campaign_params_saved||(this.register(me.campaignParams(this.custom_campaign_params)),this.campaign_params_saved=!0)}},{key:"update_search_keyword",value:function(){this.register(me.searchInfo())}},{key:"update_referrer_info",value:function(){this.register({$referrer:this.props.$referrer||me.referrer(),$referring_domain:this.props.$referring_domain||me.referringDomain()})}},{key:"get_referrer_info",value:function(){return oi({$referrer:this.props.$referrer,$referring_domain:this.props.$referring_domain})}},{key:"safe_merge",value:function(e){return W(this.props,function(n,r){r in e||(e[r]=n)}),e}},{key:"update_config",value:function(e){this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie)}},{key:"set_disabled",value:function(e){this.disabled=e,this.disabled?this.remove():this.save()}},{key:"set_cross_subdomain",value:function(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())}},{key:"get_cross_subdomain",value:function(){return!!this.cross_subdomain}},{key:"set_secure",value:function(e){e!==this.secure&&(this.secure=e,this.remove(),this.save())}},{key:"set_event_timer",value:function(e,n){var r=this.props[Sn]||{};r[e]=n,this.props[Sn]=r,this.save()}},{key:"remove_event_timer",value:function(e){var n=(this.props[Sn]||{})[e];return Xe(n)||(delete this.props[Sn][e],this.save()),n}},{key:"get_user_state",value:function(){return this.props[vi]||"anonymous"}},{key:"set_user_state",value:function(e){this.props[vi]=e,this.save()}}]),t}(),Ot={_initializedTokens:[],_isAutocaptureEnabled:!1,_setIsAutocaptureEnabled:function(t){var e=!!t.get_property(Xo),n=!!t.get_config("autocapture");this._isAutocaptureEnabled=n&&!e},_previousElementSibling:function(t){if(t.previousElementSibling)return t.previousElementSibling;var e=t;do e=e.previousSibling;while(e&&!Ho(e));return e},_getAugmentPropertiesFromElement:function(t){if(!sr(t))return{};var e={};return W(t.attributes,function(n){if(n.name.indexOf("data-ph-capture-attribute")===0){var r=n.name.replace("data-ph-capture-attribute-",""),i=n.value;r&&i&&on(i)&&(e[r]=i)}}),e},_getPropertiesFromElement:function(t,e,n){var r=t.tagName.toLowerCase(),i={tag_name:r};ci.indexOf(r)>-1&&!n&&(r.toLowerCase()==="a"||r.toLowerCase()==="button"?i.$el_text=Jo(t):i.$el_text=ir(t));var s=rr(t);s.length>0&&(i.classes=s.split(" ").filter(function(c){return c!==""})),W(t.attributes,function(c){var u;Go(t)&&["name","id","class"].indexOf(c.name)===-1||!e&&on(c.value)&&(typeof(u=c.name)!="string"||u.substring(0,10)!=="_ngcontent"&&u.substring(0,7)!=="_nghost")&&(i["attr__"+c.name]=c.value)});for(var o=1,a=1,l=t;l=this._previousElementSibling(l);)o++,l.tagName===t.tagName&&a++;return i.nth_child=o,i.nth_of_type=a,i},_getDefaultProperties:function(t){return{$event_type:t,$ce_version:1}},_extractCustomPropertyValue:function(t){var e=[];return W(document.querySelectorAll(t.css_selector),function(n){var r;["input","select"].indexOf(n.tagName.toLowerCase())>-1?r=n.value:n.textContent&&(r=n.textContent),on(r)&&e.push(r)}),e.join(", ")},_getCustomProperties:function(t){var e=this,n={};return W(this._customProperties,function(r){W(r.event_selectors,function(i){W(document.querySelectorAll(i),function(s){Q(t,s)&&sr(s)&&(n[r.name]=e._extractCustomPropertyValue(r))})})}),n},_getEventTarget:function(t){return t.target===void 0?t.srcElement||null:(e=t.target)!==null&&e!==void 0&&e.shadowRoot?t.composedPath()[0]||null:t.target||null;var e},_captureEvent:function(t,e){var n,r=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"$autocapture",s=this._getEventTarget(t);if(Wo(s)&&(s=s.parentNode||null),i==="$autocapture"&&t.type==="click"&&t instanceof MouseEvent&&(n=this.rageclicks)!==null&&n!==void 0&&n.isRageClick(t.clientX,t.clientY,new Date().getTime())&&this._captureEvent(t,e,"$rageclick"),s&&function(h,g){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(!h||Ht(h,"html")||!Ho(h))return!1;if(p!=null&&p.url_allowlist){var _=window.location.href,v=p.url_allowlist;if(v&&!v.some(function(Z){return _.match(Z)}))return!1}if(p!=null&&p.dom_event_allowlist){var m=p.dom_event_allowlist;if(m&&!m.some(function(Z){return g.type===Z}))return!1}if(p!=null&&p.element_allowlist){var C=p.element_allowlist;if(C&&!C.some(function(Z){return h.tagName.toLowerCase()===Z}))return!1}if(p!=null&&p.css_selector_allowlist){var y=p.css_selector_allowlist;if(y&&!y.some(function(Z){return h.matches(Z)}))return!1}for(var S=!1,I=[h],$=!0,O=h;O.parentNode&&!Ht(O,"body");)if(Vo(O.parentNode))I.push(O.parentNode.host),O=O.parentNode.host;else{if(!($=O.parentNode||!1))break;if(ci.indexOf($.tagName.toLowerCase())>-1)S=!0;else{var j=window.getComputedStyle($);j&&j.getPropertyValue("cursor")==="pointer"&&(S=!0)}I.push($),O=$}var oe=window.getComputedStyle(h);if(oe&&oe.getPropertyValue("cursor")==="pointer"&&g.type==="click")return!0;var Le=h.tagName.toLowerCase();switch(Le){case"html":return!1;case"form":return g.type==="submit";case"input":case"select":case"textarea":return g.type==="change"||g.type==="click";default:return S?g.type==="click":g.type==="click"&&(ci.indexOf(Le)>-1||h.getAttribute("contenteditable")==="true")}}(s,t,this.config)){for(var o=[s],a=s;a.parentNode&&!Ht(a,"body");)Vo(a.parentNode)?(o.push(a.parentNode.host),a=a.parentNode.host):(o.push(a.parentNode),a=a.parentNode);var l,c=[],u={},d=!1;if(W(o,function(h){var g=sr(h);h.tagName.toLowerCase()==="a"&&(l=h.getAttribute("href"),l=g&&on(l)&&l),Q(rr(h).split(" "),"ph-no-capture")&&(d=!0),c.push(r._getPropertiesFromElement(h,e.get_config("mask_all_element_attributes"),e.get_config("mask_all_text")));var p=r._getAugmentPropertiesFromElement(h);Ae(u,p)}),e.get_config("mask_all_text")||(s.tagName.toLowerCase()==="a"||s.tagName.toLowerCase()==="button"?c[0].$el_text=Jo(s):c[0].$el_text=ir(s)),l&&(c[0].attr__href=l),d)return!1;var f=Ae(this._getDefaultProperties(t.type),{$elements:c},this._getCustomProperties(o),u);return e.capture(i,f),!0}},_navigate:function(t){window.location.href=t},_addDomEventHandlers:function(t){var e=this,n=function(r){r=r||window.event,e._captureEvent(r,t)};kn(document,"submit",n,!1,!0),kn(document,"change",n,!1,!0),kn(document,"click",n,!1,!0)},_customProperties:[],rageclicks:null,config:void 0,init:function(t){var e;typeof t.__autocapture!="boolean"&&(this.config=t.__autocapture),(e=this.config)!==null&&e!==void 0&&e.url_allowlist&&(this.config.url_allowlist=this.config.url_allowlist.map(function(n){return new RegExp(n)})),this.rageclicks=new wd(t.get_config("rageclick"))},afterDecideResponse:function(t,e){this._setIsAutocaptureEnabled(e);var n=e.get_config("token");this._initializedTokens.indexOf(n)>-1?re.log('autocapture already initialized for token "'+n+'"'):(e.persistence&&e.persistence.register(N({},Xo,!!t.autocapture_opt_out)),this._initializedTokens.push(n),t&&t.config&&t.config.enable_collect_everything&&this._isAutocaptureEnabled?(t.custom_properties&&(this._customProperties=t.custom_properties),this._addDomEventHandlers(e)):e.__autocapture=!1)},enabledForProject:function(t,e,n){if(!t)return!0;e=Xe(e)?10:e,n=Xe(n)?10:n;for(var r=0,i=0;i<t.length;i++)r+=t.charCodeAt(i);return r%e<n},isBrowserSupported:function(){return Lo(document.querySelectorAll)}};(function(t){for(var e in t)typeof t[e]=="function"&&(t[e]=t[e].bind(t))})(Ot),function(t){for(var e in t)typeof t[e]=="function"&&(t[e]=Do(t[e]))}(Ot);var Id="__ph_opt_in_out_";function xd(t,e){ra(!0,t,e)}function Td(t,e){ra(!1,t,e)}function Rd(t,e){return na(t,e)==="1"}function ta(t,e){return!!function(n){if(n&&n.respectDnt){var r=n&&n.window||F,i=r.navigator||{},s=!1;return W([i.doNotTrack,i.msDoNotTrack,r.doNotTrack],function(o){Q([!0,1,"1","yes"],o)&&(s=!0)}),s}return!1}(e)||na(t,e)==="0"}function Pd(t,e){_i(e=e||{}).remove(mi(t,e),!!e.crossSubdomainCookie)}function _i(t){return(t=t||{}).persistenceType==="localStorage"?he:t.persistenceType==="localStorage+cookie"?di:it}function mi(t,e){return((e=e||{}).persistencePrefix||Id)+t}function na(t,e){return _i(e).get(mi(t,e))}function ra(t,e,n){zo(e)&&e.length?(_i(n=n||{}).set(mi(e,n),t?1:0,gd(n.cookieExpiration)?n.cookieExpiration:null,n.crossSubdomainCookie,n.secureCookie),n.capture&&t&&n.capture(n.captureEventName||"$opt_in",n.captureProperties||{},{send_instantly:!0})):console.error("gdpr."+(t?"optIn":"optOut")+" called with an invalid token")}function ia(t,e){var n=!1;try{var r=t.get_config("token"),i=t.get_config("respect_dnt"),s=t.get_config("opt_out_capturing_persistence_type"),o=t.get_config("opt_out_capturing_cookie_prefix")||void 0,a=t.get_config("window");r&&(n=ta(r,{respectDnt:i,persistenceType:s,persistencePrefix:o,window:a}))}catch(l){e||console.error("Unexpected error when checking capturing opt-out status: "+l)}return n}function sa(t,e,n){return function(){for(var r=ia(t,n),i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];if(!r)return e.apply(this,s);var a=s[s.length-1];typeof a=="function"&&a(0)}}var yi="$set",Od=function(){function t(e){var n=this;ce(this,t),this._posthog=e,this.set=sa(e,function(r,i,s){var o=n.set_action(r,i);return n._posthog.setPersonPropertiesForFlags(o.$set||{}),qt(r)&&(s=i),n._get_config("save_referrer")&&n._posthog.sessionPersistence.update_referrer_info(),o[yi]=Ae({},me.people_properties(),n._posthog.sessionPersistence.get_referrer_info(),o[yi]),n._send_request(o,s)}),this.set_once=sa(e,function(r,i,s){var o=n.set_once_action(r,i);return qt(r)&&(s=i),n._send_request(o,s)})}return ue(t,[{key:"toString",value:function(){return this._posthog.toString()+".people"}},{key:"_send_request",value:function(e,n){e.$token=this._get_config("token"),e.$distinct_id=this._posthog.get_distinct_id();var r=this._posthog.get_property("$device_id"),i=this._posthog.get_property("$user_id"),s=this._posthog.get_property("$had_persisted_distinct_id");r&&(e.$device_id=r),i&&(e.$user_id=i),s&&(e.$had_persisted_distinct_id=s);var o=vd(e),a=Uo(o,this._get_config("properties_string_max_length")),l=nr(JSON.stringify(o));return this._posthog._send_request(this._get_config("api_host")+"/engage/",{data:l},{},this._posthog._prepare_callback(n,a)),a}},{key:"_get_config",value:function(e){return this._posthog.get_config(e)}},{key:"_is_reserved_property",value:function(e){return e==="$distinct_id"||e==="$token"||e==="$device_id"||e==="$user_id"||e==="$had_persisted_distinct_id"}},{key:"set_action",value:function(e,n){return this.apiActionParser(yi,e,n)}},{key:"set_once_action",value:function(e,n){return this.apiActionParser("$set_once",e,n)}},{key:"apiActionParser",value:function(e,n,r){var i=this,s={},o={};return qt(n)?W(n,function(a,l){i._is_reserved_property(l)||(o[l]=a)}):o[n]=r,s[e]=o,s}}]),t}(),bi="$active_feature_flags",cr="$override_feature_flags",oa="$feature_flag_payloads",aa=function(t){var e,n={},r=_t(function(a){for(var l=Object.keys(a),c=l.length,u=new Array(c);c--;)u[c]=[l[c],a[l[c]]];return u}(t||{}));try{for(r.s();!(e=r.n()).done;){var i=Rt(e.value,2),s=i[0],o=i[1];o&&(n[s]=o)}}catch(a){r.e(a)}finally{r.f()}return n},Fd=function(){function t(e){ce(this,t),this.instance=e,this._override_warning=!1,this.featureFlagEventHandlers=[],this.reloadFeatureFlagsQueued=!1,this.reloadFeatureFlagsInAction=!1}return ue(t,[{key:"getFlags",value:function(){return Object.keys(this.getFlagVariants())}},{key:"getFlagVariants",value:function(){var e=this.instance.get_property(an),n=this.instance.get_property(cr);if(!n)return e||{};for(var r=Ae({},e),i=Object.keys(n),s=0;s<i.length;s++)n[i[s]]===!1?delete r[i[s]]:r[i[s]]=n[i[s]];return this._override_warning||(console.warn("[PostHog] Overriding feature flags!",{enabledFlags:e,overriddenFlags:n,finalFlags:r}),this._override_warning=!0),r}},{key:"getFlagPayloads",value:function(){return this.instance.get_property(oa)||{}}},{key:"reloadFeatureFlags",value:function(){this.reloadFeatureFlagsQueued||(this.reloadFeatureFlagsQueued=!0,this._startReloadTimer())}},{key:"setAnonymousDistinctId",value:function(e){this.$anon_distinct_id=e}},{key:"setReloadingPaused",value:function(e){this.reloadFeatureFlagsInAction=e}},{key:"resetRequestQueue",value:function(){this.reloadFeatureFlagsQueued=!1}},{key:"_startReloadTimer",value:function(){var e=this;this.reloadFeatureFlagsQueued&&!this.reloadFeatureFlagsInAction&&setTimeout(function(){!e.reloadFeatureFlagsInAction&&e.reloadFeatureFlagsQueued&&(e.reloadFeatureFlagsQueued=!1,e._reloadFeatureFlagsRequest())},5)}},{key:"_reloadFeatureFlagsRequest",value:function(){var e=this;this.setReloadingPaused(!0);var n=this.instance.get_config("token"),r=this.instance.get_property(ln),i=this.instance.get_property(Pt),s=nr(JSON.stringify({token:n,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:r,group_properties:i}));this.instance._send_request(this.instance.get_config("api_host")+"/decide/?v=3",{data:s},{method:"POST"},this.instance._prepare_callback(function(o){e.$anon_distinct_id=void 0,e.receivedFeatureFlags(o),e.setReloadingPaused(!1),e._startReloadTimer()}))}},{key:"getFeatureFlag",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.getFlags()&&this.getFlags().length!==0){var r=this.getFlagVariants()[e],i="".concat(r),s=this.instance.get_property(lr)||{};return!n.send_event&&"send_event"in n||e in s&&s[e].includes(i)||(Array.isArray(s[e])?s[e].push(i):s[e]=[i],this.instance.persistence.register(N({},lr,s)),this.instance.capture("$feature_flag_called",{$feature_flag:e,$feature_flag_response:r})),r}console.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}},{key:"getFeatureFlagPayload",value:function(e){return this.getFlagPayloads()[e]}},{key:"isFeatureEnabled",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.getFlags()&&this.getFlags().length!==0)return!!this.getFeatureFlag(e,n);console.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}},{key:"addFeatureFlagsHandler",value:function(e){this.featureFlagEventHandlers.push(e)}},{key:"removeFeatureFlagsHandler",value:function(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(function(n){return n!==e})}},{key:"receivedFeatureFlags",value:function(e){this.instance.decideEndpointWasHit=!0;var n=this.getFlagVariants(),r=this.getFlagPayloads();(function(i,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=i.featureFlags,c=i.featureFlagPayloads;if(l)if(Array.isArray(l)){var u,d={};if(l)for(var f=0;f<l.length;f++)d[l[f]]=!0;s&&s.register((N(u={},bi,l),N(u,an,d),u))}else{var h,g=l,p=c;i.errorsWhileComputingFlags&&(g=M(M({},o),g),p=M(M({},a),p)),s&&s.register((N(h={},bi,Object.keys(aa(g))),N(h,an,g||{}),N(h,oa,p||{}),h))}})(e,this.instance.persistence,n,r),this._fireFeatureFlagsCallbacks()}},{key:"override",value:function(e){if(this._override_warning=!1,e===!1)this.instance.persistence.unregister(cr);else if(Array.isArray(e)){for(var n={},r=0;r<e.length;r++)n[e[r]]=!0;this.instance.persistence.register(N({},cr,n))}else this.instance.persistence.register(N({},cr,e))}},{key:"onFeatureFlags",value:function(e){var n=this;if(this.addFeatureFlagsHandler(e),this.instance.decideEndpointWasHit){var r=this._prepareFeatureFlagsForCallbacks(),i=r.flags,s=r.flagVariants;e(i,s)}return function(){return n.removeFeatureFlagsHandler(e)}}},{key:"updateEarlyAccessFeatureEnrollment",value:function(e,n){var r,i=N({},"$feature_enrollment/".concat(e),n);this.instance.capture("$feature_enrollment_update",{$feature_flag:e,$feature_enrollment:n,$set:i}),this.setPersonPropertiesForFlags(i,!1);var s=M(M({},this.getFlagVariants()),{},N({},e,n));this.instance.persistence.register((N(r={},bi,Object.keys(aa(s))),N(r,an,s),r)),this._fireFeatureFlagsCallbacks()}},{key:"getEarlyAccessFeatures",value:function(e){var n=this,r=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.instance.get_property(pi);if(i&&!r)return e(i);this.instance._send_request("".concat(this.instance.get_config("api_host"),"/api/early_access_features/?token=").concat(this.instance.get_config("token")),{},{method:"GET"},function(s){var o=s.earlyAccessFeatures;return n.instance.persistence.register(N({},pi,o)),e(o)})}},{key:"_prepareFeatureFlagsForCallbacks",value:function(){var e=this.getFlags(),n=this.getFlagVariants();return{flags:e.filter(function(r){return n[r]}),flagVariants:Object.keys(n).filter(function(r){return n[r]}).reduce(function(r,i){return r[i]=n[i],r},{})}}},{key:"_fireFeatureFlagsCallbacks",value:function(){var e=this._prepareFeatureFlagsForCallbacks(),n=e.flags,r=e.flagVariants;this.featureFlagEventHandlers.forEach(function(i){return i(n,r)})}},{key:"setPersonPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],r=this.instance.get_property(ln)||{};this.instance.register(N({},ln,M(M({},r),e))),n&&this.instance.reloadFeatureFlags()}},{key:"resetPersonPropertiesForFlags",value:function(){this.instance.unregister(ln)}},{key:"setGroupPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],r=this.instance.get_property(Pt)||{};Object.keys(r).length!==0&&Object.keys(r).forEach(function(i){r[i]=M(M({},r[i]),e[i]),delete e[i]}),this.instance.register(N({},Pt,M(M({},r),e))),n&&this.instance.reloadFeatureFlags()}},{key:"resetGroupPropertiesForFlags",value:function(e){if(e){var n=this.instance.get_property(Pt)||{};this.instance.register(N({},Pt,M(M({},n),{},N({},e,{}))))}else this.instance.unregister(Pt)}}]),t}(),Cd="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNOCAwSDE2TDAgMTZWOEw4IDBaIiBmaWxsPSIjMkQyRDJEIi8+CjxwYXRoIGQ9Ik0xNiA4VjE2SDhMMTYgOFoiIGZpbGw9IiMyRDJEMkQiLz4KPC9zdmc+Cg==",la=2,$d=4,jd=6,Md=5e6,Nd="rrweb/console@1",st,Ld="/s/";(function(t){t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet"})(st||(st={}));var zd=[st.MouseMove,st.MouseInteraction,st.Scroll,st.ViewportResize,st.Input,st.TouchMove,st.MediaInteraction,st.Drag],Dd=function(){function t(e){var n=this;ce(this,t),N(this,"lastActivityTimestamp",Date.now()),N(this,"isIdle",!1),this.instance=e,this.captureStarted=!1,this.snapshots=[],this.emit=!1,this.endpoint=Ld,this.stopRrweb=void 0,this.windowId=null,this.sessionId=null,this.receivedDecide=!1,window.addEventListener("beforeunload",function(){n._flushBuffer()})}return ue(t,[{key:"startRecordingIfEnabled",value:function(){this.isRecordingEnabled()?this.startCaptureAndTrySendingQueuedSnapshots():this.stopRecording()}},{key:"started",value:function(){return this.captureStarted}},{key:"stopRecording",value:function(){this.captureStarted&&this.stopRrweb&&(this.stopRrweb(),this.stopRrweb=void 0,this.captureStarted=!1)}},{key:"isRecordingEnabled",value:function(){var e=!!this.instance.get_property(fi),n=!this.instance.get_config("disable_session_recording");return e&&n}},{key:"isConsoleLogCaptureEnabled",value:function(){var e=!!this.instance.get_property(Yo),n=this.instance.get_config("enable_recording_console_log");return n??e}},{key:"getRecordingVersion",value:function(){var e,n=this.instance.get_property(Zo);return((e=this.instance.get_config("session_recording"))===null||e===void 0?void 0:e.recorderVersion)||n||"v1"}},{key:"afterDecideResponse",value:function(e){var n,r,i,s,o,a;this.receivedDecide=!0,this.instance.persistence&&this.instance.persistence.register((N(o={},fi,!!e.sessionRecording),N(o,Yo,(i=e.sessionRecording)===null||i===void 0?void 0:i.consoleLogRecordingEnabled),N(o,Zo,(s=e.sessionRecording)===null||s===void 0?void 0:s.recorderVersion),o)),(n=e.sessionRecording)!==null&&n!==void 0&&n.endpoint&&(this.endpoint=(a=e.sessionRecording)===null||a===void 0?void 0:a.endpoint),(r=e.sessionRecording)!==null&&r!==void 0&&r.recorderVersion&&(this.recorderVersion=e.sessionRecording.recorderVersion),this.startRecordingIfEnabled()}},{key:"startCaptureAndTrySendingQueuedSnapshots",value:function(){var e=this;this.receivedDecide&&(this.emit=!0,this.snapshots.forEach(function(n){return e._captureSnapshotBuffered(n)})),this._startCapture()}},{key:"_startCapture",value:function(){var e=this;if(Object.assign!==void 0&&!this.captureStarted&&!this.instance.get_config("disable_session_recording")){this.captureStarted=!0,this.instance.sessionManager.checkAndGetSessionAndWindowId();var n=this.getRecordingVersion()==="v2"?"recorder-v2.js":"recorder.js";this.instance.__loaded_recorder_version!==this.getRecordingVersion()?li(this.instance.get_config("api_host")+"/static/".concat(n,"?v=").concat(rt.LIB_VERSION),function(r){if(r)return re.error("Could not load ".concat(n),r);e._onScriptLoaded()}):this._onScriptLoaded()}}},{key:"_isInteractiveEvent",value:function(e){var n;return e.type===3&&zd.indexOf((n=e.data)===null||n===void 0?void 0:n.source)!==-1}},{key:"_updateWindowAndSessionIds",value:function(e){var n=this._isInteractiveEvent(e);if(n||this.isIdle||e.timestamp-this.lastActivityTimestamp>3e5&&(this.isIdle=!0),n&&(this.lastActivityTimestamp=e.timestamp,this.isIdle&&(this.isIdle=!1,this._tryTakeFullSnapshot())),!this.isIdle){var r=this.instance.sessionManager.checkAndGetSessionAndWindowId(!n,e.timestamp),i=r.windowId,s=r.sessionId;[la,$d].indexOf(e.type)!==-1||this.windowId===i&&this.sessionId===s||this._tryTakeFullSnapshot(),this.windowId=i,this.sessionId=s}}},{key:"_tryTakeFullSnapshot",value:function(){if(!this.captureStarted)return!1;try{var e;return(e=this.rrwebRecord)===null||e===void 0||e.takeFullSnapshot(),!0}catch(n){return re.error("Error taking full snapshot.",n),!1}}},{key:"_onScriptLoaded",value:function(){var e=this,n={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1};this.rrwebRecord=window.rrweb?window.rrweb.record:window.rrwebRecord;for(var r=this.instance.get_config("session_recording"),i=0,s=Object.entries(r||{});i<s.length;i++){var o=Rt(s[i],2),a=o[0],l=o[1];a in n&&(n[a]=l)}this.rrwebRecord?(this.stopRrweb=this.rrwebRecord(M({emit:function(c){e.onRRwebEmit(c)},plugins:window.rrwebConsoleRecord&&this.isConsoleLogCaptureEnabled()?[window.rrwebConsoleRecord.getRecordConsolePlugin()]:[]},n)),this.instance._addCaptureHook(function(c){try{var u;c==="$pageview"&&((u=e.rrwebRecord)===null||u===void 0||u.addCustomEvent("$pageview",{href:window.location.href}))}catch(d){re.error("Could not add $pageview to rrweb session",d)}}),this.lastActivityTimestamp=Date.now(),this.isIdle=!1):re.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}},{key:"onRRwebEmit",value:function(e){if(e&&Tt(e)==="object"){var n=function(o){var a=JSON.stringify(o);if(a.length>Md){var l,c=_t(a.matchAll(/data:([\w\/\-\.]+);(\w+),([^)"]*)/gim));try{for(c.s();!(l=c.n()).done;){var u=l.value;a=u[1].toLocaleLowerCase().slice(0,6)==="image/"?a.replace(u[0],Cd):a.replace(u[0],"")}}catch(d){c.e(d)}finally{c.f()}}return{event:JSON.parse(a),size:a.length}}(function(o){var a=o;if(a&&Tt(a)==="object"&&a.type===jd&&Tt(a.data)==="object"&&a.data.plugin===Nd){a.data.payload.payload.length>10&&(a.data.payload.payload=a.data.payload.payload.slice(0,10),a.data.payload.payload.push("...[truncated]"));for(var l=[],c=0;c<a.data.payload.payload.length;c++)a.data.payload.payload[c]&&a.data.payload.payload[c].length>2e3?l.push(a.data.payload.payload[c].slice(0,2e3)+"...[truncated]"):l.push(a.data.payload.payload[c]);return a.data.payload.payload=l,o}return o}(e)),r=n.event,i=n.size;if(this._updateWindowAndSessionIds(r),!this.isIdle){var s={$snapshot_bytes:i,$snapshot_data:r,$session_id:this.sessionId,$window_id:this.windowId};this.instance._captureMetrics.incr("rrweb-record"),this.instance._captureMetrics.incr("rrweb-record-".concat(r.type)),this.emit?this._captureSnapshotBuffered(s):this.snapshots.push(s)}}}},{key:"_flushBuffer",value:function(){return this.flushBufferTimer&&(clearTimeout(this.flushBufferTimer),this.flushBufferTimer=void 0),this.buffer&&this.buffer.data.length!==0&&this._captureSnapshot({$snapshot_bytes:this.buffer.size,$snapshot_data:this.buffer.data,$session_id:this.buffer.sessionId,$window_id:this.buffer.windowId}),this.buffer=void 0,{size:0,data:[],sessionId:this.sessionId,windowId:this.windowId}}},{key:"_captureSnapshotBuffered",value:function(e){var n,r=this,i=2+(((n=this.buffer)===null||n===void 0?void 0:n.data.length)||0);(!this.buffer||this.buffer.size+e.$snapshot_bytes+i>943718.4||this.buffer.sessionId!==this.sessionId)&&(this.buffer=this._flushBuffer()),this.buffer.size+=e.$snapshot_bytes,this.buffer.data.push(e.$snapshot_data),this.flushBufferTimer||(this.flushBufferTimer=setTimeout(function(){r._flushBuffer()},2e3))}},{key:"_captureSnapshot",value:function(e){this.instance.capture("$snapshot",e,{transport:"XHR",method:"POST",endpoint:this.endpoint,_noTruncate:!0,_batchKey:"sessionRecording",_metrics:{rrweb_full_snapshot:e.$snapshot_data.type===la}})}}]),t}(),ot={entryType:0,timeOrigin:1,name:2,startTime:3,redirectStart:4,redirectEnd:5,workerStart:6,fetchStart:7,domainLookupStart:8,domainLookupEnd:9,connectStart:10,secureConnectionStart:11,connectEnd:12,requestStart:13,responseStart:14,responseEnd:15,decodedBodySize:16,encodedBodySize:17,initiatorType:18,nextHopProtocol:19,renderBlockingStatus:20,responseStatus:21,transferSize:22,element:23,renderTime:24,loadTime:25,size:26,id:27,url:28,domComplete:29,domContentLoadedEvent:30,domInteractive:31,loadEventEnd:32,loadEventStart:33,redirectCount:34,navigationType:35,unloadEventEnd:36,unloadEventStart:37,duration:39,timestamp:40},Ud=["first-input","navigation","paint","resource"],Bd=["/s/","/e/"],qd=function(){function t(e){ce(this,t),N(this,"_forceAllowLocalhost",!1),this.instance=e}return ue(t,[{key:"startObservingIfEnabled",value:function(){this.isEnabled()?this.startObserving():this.stopObserving()}},{key:"startObserving",value:function(){var e,n,r=this;if(!this.observer)if(((e=window)===null||e===void 0||(n=e.PerformanceObserver)===null||n===void 0?void 0:n.supportedEntryTypes)!==void 0)if(!hd.includes(location.hostname)||this._forceAllowLocalhost)try{this.observer=new PerformanceObserver(function(s){s.getEntries().forEach(function(o){r._capturePerformanceEvent(o)})});var i=PerformanceObserver.supportedEntryTypes.filter(function(s){return Ud.includes(s)});i.forEach(function(s){var o;(o=r.observer)===null||o===void 0||o.observe({type:s,buffered:!0})})}catch(s){console.error("PostHog failed to start performance observer",s),this.stopObserving()}else re.log("PostHog Peformance observer not started because we are on localhost.");else re.log("PostHog Performance observer not started because PerformanceObserver is not supported by this browser.")}},{key:"stopObserving",value:function(){this.observer&&(this.observer.disconnect(),this.observer=void 0)}},{key:"isObserving",value:function(){return!!this.observer}},{key:"isEnabled",value:function(){var e,n;return(e=(n=this.instance.get_config("capture_performance"))!==null&&n!==void 0?n:this.remoteEnabled)!==null&&e!==void 0&&e}},{key:"afterDecideResponse",value:function(e){this.remoteEnabled=e.capturePerformance||!1,this.isEnabled()&&this.startObserving()}},{key:"_capturePerformanceEvent",value:function(e){if(e.name.indexOf(this.instance.get_config("api_host"))===0){var n=e.name.replace(this.instance.get_config("api_host"),"");if(Bd.find(function(h){return n.indexOf(h)===0}))return}var r={url:e.name},i=this.instance.get_config("session_recording");if(i.maskNetworkRequestFn&&(r=i.maskNetworkRequestFn(r)),r){var s=e.toJSON();s.name=r.url;var o={},a=Math.floor(Date.now()-performance.now());for(var l in o[ot.timeOrigin]=a,o[ot.timestamp]=Math.floor(a+e.startTime),ot)s[l]!==void 0&&(o[ot[l]]=s[l]);if(this.capturePerformanceEvent(o),Hd(e)){var c,u=_t(e.serverTiming||[]);try{for(u.s();!(c=u.n()).done;){var d,f=c.value;this.capturePerformanceEvent((N(d={},ot.timeOrigin,a),N(d,ot.timestamp,Math.floor(a+e.startTime)),N(d,ot.name,f.name),N(d,ot.duration,f.duration),N(d,ot.entryType,"serverTiming"),d))}}catch(h){u.e(h)}finally{u.f()}}}}},{key:"capturePerformanceEvent",value:function(e){var n,r=e[ot.timestamp];(n=this.instance.sessionRecording)===null||n===void 0||n.onRRwebEmit({type:6,data:{plugin:"posthog/network@1",payload:e},timestamp:r})}}]),t}(),Hd=function(t){return t.entryType==="navigation"||t.entryType==="resource"},Wd=function(){function t(e){ce(this,t),this.instance=e,this.instance.decideEndpointWasHit=this.instance._hasBootstrappedFeatureFlags()}return ue(t,[{key:"call",value:function(){var e=this,n=nr(JSON.stringify({token:this.instance.get_config("token"),distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),person_properties:this.instance.get_property(ln),group_properties:this.instance.get_property(Pt)}));this.instance._send_request("".concat(this.instance.get_config("api_host"),"/decide/?v=3"),{data:n,verbose:!0},{method:"POST"},function(r){return e.parseDecideResponse(r)})}},{key:"parseDecideResponse",value:function(e){var n,r,i,s=this;if((e==null?void 0:e.status)!==0){if(this.instance.decideEndpointWasHit=!0,!document||!document.body)return console.log("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(function(){s.parseDecideResponse(e)},500);if(this.instance.toolbar.afterDecideResponse(e),(n=this.instance.sessionRecording)===null||n===void 0||n.afterDecideResponse(e),Ot.afterDecideResponse(e,this.instance),(r=this.instance.webPerformance)===null||r===void 0||r.afterDecideResponse(e),(i=this.instance.exceptionAutocapture)===null||i===void 0||i.afterDecideResponse(e),this.instance.featureFlags.receivedFeatureFlags(e),this.instance.compression={},e.supportedCompression&&!this.instance.get_config("disable_compression")){var o,a={},l=_t(e.supportedCompression);try{for(l.s();!(o=l.n()).done;)a[o.value]=!0}catch(h){l.e(h)}finally{l.f()}this.instance.compression=a}if(e.siteApps)if(this.instance.get_config("opt_in_site_apps")){var c,u=this.instance.get_config("api_host"),d=_t(e.siteApps);try{var f=function(){var h=c.value,g=h.id,p=h.url,_=[u,u[u.length-1]==="/"&&p[0]==="/"?p.substring(1):p].join("");window["__$$ph_site_app_".concat(g)]=s.instance,li(_,function(v){v&&console.error("Error while initializing PostHog app with config id ".concat(g),v)})};for(d.s();!(c=d.n()).done;)f()}catch(h){d.e(h)}finally{d.f()}}else e.siteApps.length>0&&console.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}else console.error("Failed to fetch feature flags from PostHog.")}}]),t}(),Vd=["https://app.posthog.com","https://eu.posthog.com"],Gd=["source"],Jd=function(){function t(e){ce(this,t),this.instance=e}return ue(t,[{key:"afterDecideResponse",value:function(e){var n=e.toolbarParams||e.editorParams||(e.toolbarVersion?{toolbarVersion:e.toolbarVersion}:{});e.isAuthenticated&&n.toolbarVersion&&n.toolbarVersion.indexOf("toolbar")===0&&this.loadToolbar(M({},n))}},{key:"maybeLoadToolbar",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.location,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window.history;try{if(!n){try{window.localStorage.setItem("test","test"),window.localStorage.removeItem("test")}catch{return!1}n=window.localStorage}var i,s=qo(e.hash,"__posthog")||qo(e.hash,"state"),o=s?JSON.parse(decodeURIComponent(s)):null;return o&&o.action==="ph_authorize"?((i=o).source="url",i&&Object.keys(i).length>0&&(o.desiredHash?e.hash=o.desiredHash:r?r.replaceState("",document.title,e.pathname+e.search):e.hash="")):((i=JSON.parse(n.getItem("_postHogToolbarParams")||"{}")).source="localstorage",delete i.userIntent),!(!i.token||this.instance.get_config("token")!==i.token)&&(this.loadToolbar(i),!0)}catch{return!1}}},{key:"loadToolbar",value:function(e){var n=this;if(window._postHogToolbarLoaded)return!1;window._postHogToolbarLoaded=!0;var r=this.instance.get_config("api_host"),i=3e4*Math.floor(Date.now()/3e4),s="".concat(r).concat(r.endsWith("/")?"":"/","static/toolbar.js?_ts=").concat(i),o=!Vd.includes(this.instance.get_config("api_host"))&&this.instance.get_config("advanced_disable_toolbar_metrics"),a=M(M({token:this.instance.get_config("token")},e),{},{apiURL:r},o?{instrument:!1}:{});a.source;var l=od(a,Gd);return window.localStorage.setItem("_postHogToolbarParams",JSON.stringify(l)),li(s,function(c){c?re.error("Failed to load toolbar",c):(window.ph_load_toolbar||window.ph_load_editor)(a,n.instance)}),kn(window,"turbolinks:load",function(){window._postHogToolbarLoaded=!1,n.loadToolbar(a)}),!0}},{key:"_loadEditor",value:function(e){return this.loadToolbar(e)}},{key:"maybeLoadEditor",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.location,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window.history;return this.maybeLoadToolbar(e,n,r)}}]),t}(),ca=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3e3;ce(this,t),this.isPolling=!0,this._event_queue=[],this._empty_queue_count=0,this._poller=void 0,this._pollInterval=e}return ue(t,[{key:"setPollInterval",value:function(e){this._pollInterval=e,this.isPolling&&this.poll()}},{key:"poll",value:function(){}},{key:"unload",value:function(){}},{key:"getTime",value:function(){return new Date().getTime()}}]),t}(),Kd=function(t){Ro(n,ca);var e=Po(n);function n(r,i){var s,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3e3;return ce(this,n),(s=e.call(this,o)).handlePollRequest=i,s.captureMetrics=r,s}return ue(n,[{key:"enqueue",value:function(r,i,s){this.captureMetrics.incr("batch-enqueue"),this._event_queue.push({url:r,data:i,options:s}),this.isPolling||(this.isPolling=!0,this.poll())}},{key:"poll",value:function(){var r=this;clearTimeout(this._poller),this._poller=setTimeout(function(){if(r._event_queue.length>0){var i=r.formatQueue(),s=function(a){var l=i[a],c=l.url,u=l.data,d=l.options;W(u,function(f,h){u[h].offset=Math.abs(u[h].timestamp-r.getTime()),delete u[h].timestamp}),r.handlePollRequest(c,u,d),r.captureMetrics.incr("batch-requests"),r.captureMetrics.incr("batch-requests-".concat(c.slice(c.length-2))),r.captureMetrics.incr("batch-handle",u.length),r.captureMetrics.incr("batch-handle-".concat(c.slice(c.length-2)),u.length)};for(var o in i)s(o);r._event_queue.length=0,r._empty_queue_count=0}else r._empty_queue_count++;r._empty_queue_count>4&&(r.isPolling=!1,r._empty_queue_count=0),r.isPolling&&r.poll()},this._pollInterval)}},{key:"updateUnloadMetrics",value:function(){var r=this.formatQueue();for(var i in r){var s=r[i],o=s.url,a=s.data;this.captureMetrics.incr("batch-unload-requests"),this.captureMetrics.incr("batch-unload-requests-".concat(o.slice(o.length-2))),this.captureMetrics.incr("batch-unload",a.length),this.captureMetrics.incr("batch-unload-".concat(o.slice(o.length-2)),a.length)}}},{key:"unload",value:function(){var r=this;clearTimeout(this._poller);var i=this._event_queue.length>0?this.formatQueue():{};this._event_queue.length=0;var s=Object.values(i);[].concat(ti(s.filter(function(o){return o.url.indexOf("/e")===0})),ti(s.filter(function(o){return o.url.indexOf("/e")!==0}))).map(function(o){var a=o.url,l=o.data,c=o.options;r.handlePollRequest(a,l,M(M({},c),{},{transport:"sendBeacon"}))})}},{key:"formatQueue",value:function(){var r={};return W(this._event_queue,function(i){var s=i.url,o=i.data,a=i.options,l=(a?a._batchKey:null)||s;r[l]===void 0&&(r[l]={data:[],url:s,options:a}),a&&r[l].options&&r[l].options._metrics&&!r[l].options._metrics.rrweb_full_snapshot&&(r[l].options._metrics.rrweb_full_snapshot=a._metrics.rrweb_full_snapshot),r[l].data.push(o)}),r}}]),n}(),Qd=function(){function t(e){ce(this,t),this.enabled=e,this.metrics={}}return ue(t,[{key:"incr",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.enabled&&(e="phjs-".concat(e),this.metrics[e]=(this.metrics[e]||0)+n)}},{key:"decr",value:function(e){this.enabled&&(e="phjs-".concat(e),this.metrics[e]=(this.metrics[e]||0)-1)}}]),t}(),He=Uint8Array,je=Uint16Array,cn=Uint32Array,wi=new He([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ki=new He([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ua=new He([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),da=function(t,e){for(var n=new je(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];var i=new cn(n[30]);for(r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return[n,i]},fa=da(wi,2),Xd=fa[0],Si=fa[1];Xd[28]=258,Si[258]=28;for(var ha=da(ki,0)[1],Ei=new je(32768),Y=0;Y<32768;++Y){var Vt=(43690&Y)>>>1|(21845&Y)<<1;Vt=(61680&(Vt=(52428&Vt)>>>2|(13107&Vt)<<2))>>>4|(3855&Vt)<<4,Ei[Y]=((65280&Vt)>>>8|(255&Vt)<<8)>>>1}var En=function(t,e,n){for(var r=t.length,i=0,s=new je(e);i<r;++i)++s[t[i]-1];var o,a=new je(e);for(i=0;i<e;++i)a[i]=a[i-1]+s[i-1]<<1;if(n){o=new je(1<<e);var l=15-e;for(i=0;i<r;++i)if(t[i])for(var c=i<<4|t[i],u=e-t[i],d=a[t[i]-1]++<<u,f=d|(1<<u)-1;d<=f;++d)o[Ei[d]>>>l]=c}else for(o=new je(r),i=0;i<r;++i)o[i]=Ei[a[t[i]-1]++]>>>15-t[i];return o},Gt=new He(288);for(Y=0;Y<144;++Y)Gt[Y]=8;for(Y=144;Y<256;++Y)Gt[Y]=9;for(Y=256;Y<280;++Y)Gt[Y]=7;for(Y=280;Y<288;++Y)Gt[Y]=8;var ur=new He(32);for(Y=0;Y<32;++Y)ur[Y]=5;var Jt,pa,ga,Yd=En(Gt,9,0),Zd=En(ur,5,0),va=function(t){return(t/8>>0)+(7&t&&1)},_a=function(t,e,n){(e==null||e<0)&&(e=0),(n==null||n>t.length)&&(n=t.length);var r=new(t instanceof je?je:t instanceof cn?cn:He)(n-e);return r.set(t.subarray(e,n)),r},wt=function(t,e,n){n<<=7&e;var r=e/8>>0;t[r]|=n,t[r+1]|=n>>>8},An=function(t,e,n){n<<=7&e;var r=e/8>>0;t[r]|=n,t[r+1]|=n>>>8,t[r+2]|=n>>>16},Ai=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,s=n.slice();if(!i)return[new He(0),0];if(i==1){var o=new He(n[0].s+1);return o[n[0].s]=1,[o,1]}n.sort(function(S,I){return S.f-I.f}),n.push({s:-1,f:25001});var a=n[0],l=n[1],c=0,u=1,d=2;for(n[0]={s:-1,f:a.f+l.f,l:a,r:l};u!=i-1;)a=n[n[c].f<n[d].f?c++:d++],l=n[c!=u&&n[c].f<n[d].f?c++:d++],n[u++]={s:-1,f:a.f+l.f,l:a,r:l};var f=s[0].s;for(r=1;r<i;++r)s[r].s>f&&(f=s[r].s);var h=new je(f+1),g=ef(n[u-1],h,0);if(g>e){r=0;var p=0,_=g-e,v=1<<_;for(s.sort(function(S,I){return h[I.s]-h[S.s]||S.f-I.f});r<i;++r){var m=s[r].s;if(!(h[m]>e))break;p+=v-(1<<g-h[m]),h[m]=e}for(p>>>=_;p>0;){var C=s[r].s;h[C]<e?p-=1<<e-h[C]++-1:++r}for(;r>=0&&p;--r){var y=s[r].s;h[y]==e&&(--h[y],++p)}g=e}return[new He(h),g]},ef=function t(e,n,r){return e.s==-1?Math.max(t(e.l,n,r+1),t(e.r,n,r+1)):n[e.s]=r},ma=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new je(++e),r=0,i=t[0],s=1,o=function(l){n[r++]=l},a=1;a<=e;++a)if(t[a]==i&&a!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=t[a]}return[n.subarray(0,r),e]},In=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},dr=function(t,e,n){var r=n.length,i=va(e+2);t[i]=255&r,t[i+1]=r>>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var s=0;s<r;++s)t[i+s+4]=n[s];return 8*(i+4+r)},ya=function(t,e,n,r,i,s,o,a,l,c,u){wt(e,u++,n),++i[256];for(var d=Ai(i,15),f=d[0],h=d[1],g=Ai(s,15),p=g[0],_=g[1],v=ma(f),m=v[0],C=v[1],y=ma(p),S=y[0],I=y[1],$=new je(19),O=0;O<m.length;++O)$[31&m[O]]++;for(O=0;O<S.length;++O)$[31&S[O]]++;for(var j=Ai($,7),oe=j[0],Le=j[1],Z=19;Z>4&&!oe[ua[Z-1]];--Z);var We,ze,ye,$t,lt=c+5<<3,ct=In(i,Gt)+In(s,ur)+o,Ke=In(i,f)+In(s,p)+o+14+3*Z+In($,oe)+(2*$[16]+3*$[17]+7*$[18]);if(lt<=ct&&lt<=Ke)return dr(e,u,t.subarray(l,l+c));if(wt(e,u,1+(Ke<ct)),u+=2,Ke<ct){We=En(f,h,0),ze=f,ye=En(p,_,0),$t=p;var Ye=En(oe,Le,0);for(wt(e,u,C-257),wt(e,u+5,I-1),wt(e,u+10,Z-4),u+=14,O=0;O<Z;++O)wt(e,u+3*O,oe[ua[O]]);u+=3*Z;for(var kt=[m,S],be=0;be<2;++be){var Fe=kt[be];for(O=0;O<Fe.length;++O){var Te=31&Fe[O];wt(e,u,Ye[Te]),u+=oe[Te],Te>15&&(wt(e,u,Fe[O]>>>5&127),u+=Fe[O]>>>12)}}}else We=Yd,ze=Gt,ye=Zd,$t=ur;for(O=0;O<a;++O)if(r[O]>255){Te=r[O]>>>18&31,An(e,u,We[Te+257]),u+=ze[Te+257],Te>7&&(wt(e,u,r[O]>>>23&31),u+=wi[Te]);var jt=31&r[O];An(e,u,ye[jt]),u+=$t[jt],jt>3&&(An(e,u,r[O]>>>5&8191),u+=ki[jt])}else An(e,u,We[r[O]]),u+=ze[r[O]];return An(e,u,We[256]),u+ze[256]},tf=new cn([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),nf=new He(0),rf=function(){for(var t=new cn(256),e=0;e<256;++e){for(var n=e,r=9;--r;)n=(1&n&&3988292384)^n>>>1;t[e]=n}return t}(),sf=function(){var t=4294967295;return{p:function(e){for(var n=t,r=0;r<e.length;++r)n=rf[255&n^e[r]]^n>>>8;t=n},d:function(){return 4294967295^t}}},of=function(t,e,n,r,i){return function(s,o,a,l,c,u){var d=s.length,f=new He(l+d+5*(1+Math.floor(d/7e3))+c),h=f.subarray(l,f.length-c),g=0;if(!o||d<8)for(var p=0;p<=d;p+=65535){var _=p+65535;_<d?g=dr(h,g,s.subarray(p,_)):(h[p]=u,g=dr(h,g,s.subarray(p,d)))}else{for(var v=tf[o-1],m=v>>>13,C=8191&v,y=(1<<a)-1,S=new je(32768),I=new je(y+1),$=Math.ceil(a/3),O=2*$,j=function(qi){return(s[qi]^s[qi+1]<<$^s[qi+2]<<O)&y},oe=new cn(25e3),Le=new je(288),Z=new je(32),We=0,ze=0,ye=(p=0,0),$t=0,lt=0;p<d;++p){var ct=j(p),Ke=32767&p,Ye=I[ct];if(S[Ke]=Ye,I[ct]=Ke,$t<=p){var kt=d-p;if((We>7e3||ye>24576)&&kt>423){g=ya(s,h,0,oe,Le,Z,ze,ye,lt,p-lt,g),ye=We=ze=0,lt=p;for(var be=0;be<286;++be)Le[be]=0;for(be=0;be<30;++be)Z[be]=0}var Fe=2,Te=0,jt=C,Ve=Ke-Ye&32767;if(kt>2&&ct==j(p-Ve))for(var Di=Math.min(m,kt)-1,Ui=Math.min(32767,p),Bi=Math.min(258,kt);Ve<=Ui&&--jt&&Ke!=Ye;){if(s[p+Fe]==s[p+Fe-Ve]){for(var ut=0;ut<Bi&&s[p+ut]==s[p+ut-Ve];++ut);if(ut>Fe){if(Fe=ut,Te=Ve,ut>Di)break;var A=Math.min(Ve,ut-2),Ge=0;for(be=0;be<A;++be){var Kt=p-Ve+be+32768&32767,Rl=Kt-S[Kt]+32768&32767;Rl>Ge&&(Ge=Rl,Ye=Kt)}}}Ve+=(Ke=Ye)-(Ye=S[Ke])+32768&32767}if(Te){oe[ye++]=268435456|Si[Fe]<<18|ha[Te];var Pl=31&Si[Fe],Ol=31&ha[Te];ze+=wi[Pl]+ki[Ol],++Le[257+Pl],++Z[Ol],$t=p+Fe,++We}else oe[ye++]=s[p],++Le[s[p]]}}g=ya(s,h,u,oe,Le,Z,ze,ye,lt,p-lt,g),u||(g=dr(h,g,nf))}return _a(f,0,l+va(g)+c)}(t,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,n,r,!i)},Ii=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},af=function(t,e){var n=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:e.level==9?2:0,t[9]=3,e.mtime!=0&&Ii(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),n){t[3]=8;for(var r=0;r<=n.length;++r)t[r+10]=n.charCodeAt(r)}},lf=function(t){return 10+(t.filename&&t.filename.length+1||0)};function cf(t,e){e===void 0&&(e={});var n=sf(),r=t.length;n.p(t);var i=of(t,e,lf(e),8),s=i.length;return af(i,e),Ii(i,s-8,n.d()),Ii(i,s-4,r),i}function uf(t,e){var n=t.length;if(!e&&typeof TextEncoder<"u")return new TextEncoder().encode(t);for(var r=new He(t.length+(t.length>>>1)),i=0,s=function(c){r[i++]=c},o=0;o<n;++o){if(i+5>r.length){var a=new He(i+8+(n-o<<1));a.set(r),r=a}var l=t.charCodeAt(o);l<128||e?s(l):l<2048?(s(192|l>>>6),s(128|63&l)):l>55295&&l<57344?(s(240|(l=65536+(1047552&l)|1023&t.charCodeAt(++o))>>>18),s(128|l>>>12&63),s(128|l>>>6&63),s(128|63&l)):(s(224|l>>>12),s(128|l>>>6&63),s(128|63&l))}return _a(r,0,i)}(function(t){t.GZipJS="gzip-js",t.Base64="base64"})(Jt||(Jt={})),function(t){t.Popover="Popover",t.Button="Button",t.Email="Email",t.FullScreen="Fullscreen"}(pa||(pa={})),function(t){t.Open="open",t.MultipleChoiceSingle="multiple_single",t.MultipleChoiceMulti="multiple_multi",t.NPS="nps",t.Rating="rating",t.Link="link"}(ga||(ga={}));var df=function(t,e,n){var r=e||{};r.ip=n.ip?1:0,r._=new Date().getTime().toString(),r.ver=rt.LIB_VERSION;var i=t.split("?");if(i.length>1){var s,o=_t(i[1].split("&"));try{for(o.s();!(s=o.n()).done;){var a=s.value.split("=")[0];r[a]&&delete r[a]}}catch(c){o.e(c)}finally{o.f()}}var l=t.indexOf("?")>-1?"&":"?";return t+l+function(c){var u,d,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"&",h=[];return W(c,function(g,p){u=encodeURIComponent(g.toString()),d=encodeURIComponent(p),h[h.length]=d+"="+u}),h.join(f)}(r)},xi=function t(e,n){if(n.blob&&e.buffer)return new Blob([e.buffer],{type:"text/plain"});if(n.sendBeacon||n.blob){var r=t(e,{method:"POST"});return new Blob([r],{type:"application/x-www-form-urlencoded"})}if(n.method!=="POST")return null;var i,s;return i=Array.isArray(e)||(s=e,Object.prototype.toString.call(s)==="[object Uint8Array]")?"data="+encodeURIComponent(e):"data="+encodeURIComponent(e.data),"compression"in e&&e.compression&&(i+="&compression="+e.compression),i},ba=function(t){var e=t.url,n=t.data,r=t.headers,i=t.options,s=t.captureMetrics,o=t.callback,a=t.retriesPerformedSoFar,l=t.retryQueue,c=t.onXHRError,u=t.timeout,d=u===void 0?1e4:u,f=new XMLHttpRequest;f.open(i.method||"GET",e,!0);var h=xi(n,i);s.incr("_send_request"),s.incr("_send_request_inflight"),W(r,function(g,p){f.setRequestHeader(p,g)}),i.method!=="POST"||i.blob||f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.timeout=d,f.withCredentials=!0,f.onreadystatechange=function(){if(f.readyState===4)if(s.incr("xhr-response"),s.incr("xhr-response-".concat(f.status)),s.decr("_send_request_inflight"),f.status===200){if(o){var g;try{g=JSON.parse(f.responseText)}catch(p){return void re.error(p)}o(g)}}else typeof c=="function"&&c(f),[401,403,404,500].indexOf(f.status)<0&&l.enqueue({url:e,data:n,options:i,headers:r,retriesPerformedSoFar:(a||0)+1,callback:o}),o&&o({status:0})},f.send(h)},ff=18e5,hf=function(t){Ro(n,ca);var e=Po(n);function n(r,i){var s;return ce(this,n),(s=e.call(this)).captureMetrics=r,s.isPolling=!1,s.queue=[],s.areWeOnline=!0,s.onXHRError=i,typeof window<"u"&&"onLine"in window.navigator&&(s.areWeOnline=window.navigator.onLine,window.addEventListener("online",function(){s._handleWeAreNowOnline()}),window.addEventListener("offline",function(){s.areWeOnline=!1})),s}return ue(n,[{key:"enqueue",value:function(r){var i=r.retriesPerformedSoFar||0;if(!(i>=10)){var s=function(a){var l=3e3*Math.pow(2,a),c=l/2,u=Math.min(ff,l),d=(Math.random()-.5)*(u-c);return Math.ceil(u+d)}(i),o=new Date(Date.now()+s);this.queue.push({retryAt:o,requestData:r}),console.warn("Enqueued failed request for retry in ".concat(s)),this.isPolling||(this.isPolling=!0,this.poll())}}},{key:"poll",value:function(){var r=this;this._poller&&clearTimeout(this._poller),this._poller=setTimeout(function(){r.areWeOnline&&r.queue.length>0&&r.flush(),r.poll()},this._pollInterval)}},{key:"flush",value:function(){var r=new Date(Date.now()),i=this.queue.filter(function(l){return l.retryAt<r});if(i.length>0){this.queue=this.queue.filter(function(l){return l.retryAt>=r});var s,o=_t(i);try{for(o.s();!(s=o.n()).done;){var a=s.value.requestData;this._executeXhrRequest(a)}}catch(l){o.e(l)}finally{o.f()}}}},{key:"unload",value:function(){this._poller&&(clearTimeout(this._poller),this._poller=void 0);var r,i=_t(this.queue);try{for(i.s();!(r=i.n()).done;){var s=r.value.requestData,o=s.url,a=s.data,l=s.options;try{window.navigator.sendBeacon(o,xi(a,M(M({},l),{},{sendBeacon:!0})))}catch(c){rt.DEBUG&&console.error(c)}}}catch(c){i.e(c)}finally{i.f()}this.queue=[]}},{key:"_executeXhrRequest",value:function(r){var i=r.url,s=r.data,o=r.options,a=r.headers,l=r.callback,c=r.retriesPerformedSoFar;ba({url:i,data:s||{},options:o||{},headers:a||{},retriesPerformedSoFar:c||0,callback:l,captureMetrics:this.captureMetrics,retryQueue:this,onXHRError:this.onXHRError})}},{key:"_handleWeAreNowOnline",value:function(){this.areWeOnline=!0,this.flush()}}]),n}(),fr=1800,wa=60,pf=864e5,gf=function(){function t(e,n){ce(this,t),this.config=e,this.persistence=n,this._windowId=void 0,this._sessionId=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null;var r=e.persistence_name||e.token,i=e.session_idle_timeout_seconds||fr;if(typeof i!="number"?(console.warn("[PostHog] session_idle_timeout_seconds must be a number. Defaulting to 30 minutes."),i=fr):i>fr?console.warn("[PostHog] session_idle_timeout_seconds cannot be  greater than 30 minutes. Using 30 minutes instead."):i<wa&&console.warn("[PostHog] session_idle_timeout_seconds cannot be less than 60 seconds. Using 60 seconds instead."),this._sessionTimeoutMs=1e3*Math.min(Math.max(i,wa),fr),this._window_id_storage_key="ph_"+r+"_window_id",this._primary_window_exists_storage_key="ph_"+r+"_primary_window_exists",this._canUseSessionStorage()){var s=Ie.parse(this._window_id_storage_key),o=Ie.parse(this._primary_window_exists_storage_key);s&&!o?this._windowId=s:Ie.remove(this._window_id_storage_key),Ie.set(this._primary_window_exists_storage_key,!0)}this._listenToReloadWindow()}return ue(t,[{key:"_canUseSessionStorage",value:function(){return this.config.persistence!=="memory"&&!this.persistence.disabled&&Ie.is_supported()}},{key:"_setWindowId",value:function(e){e!==this._windowId&&(this._windowId=e,this._canUseSessionStorage()&&Ie.set(this._window_id_storage_key,e))}},{key:"_getWindowId",value:function(){return this._windowId?this._windowId:this._canUseSessionStorage()?Ie.parse(this._window_id_storage_key):null}},{key:"_setSessionId",value:function(e,n,r){e===this._sessionId&&n===this._sessionActivityTimestamp&&r===this._sessionStartTimestamp||(this._sessionStartTimestamp=r,this._sessionActivityTimestamp=n,this._sessionId=e,this.persistence.register(N({},hi,[n,e,r])))}},{key:"_getSessionId",value:function(){if(this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];var e=this.persistence.props[hi];return Array.isArray(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}},{key:"resetSessionId",value:function(){this._setSessionId(null,null,null)}},{key:"_listenToReloadWindow",value:function(){var e=this;window.addEventListener("beforeunload",function(){e._canUseSessionStorage()&&Ie.remove(e._primary_window_exists_storage_key)})}},{key:"checkAndGetSessionAndWindowId",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:null)||new Date().getTime(),r=Rt(this._getSessionId(),3),i=r[0],s=r[1],o=r[2],a=this._getWindowId(),l=o&&o>0&&Math.abs(n-o)>pf;!s||!e&&Math.abs(n-i)>this._sessionTimeoutMs||l?(s=bt(),a=bt(),o=n):a||(a=bt());var c=i===0||!e||l?n:i,u=o===0?new Date().getTime():o;return this._setWindowId(a),this._setSessionId(s,c,u),{sessionId:s,windowId:a,sessionStartTimestamp:u}}}]),t}(),vf=ue(function t(e,n,r,i){ce(this,t),this.name="posthog-js",this.setupOnce=function(s){s(function(o){var a,l,c,u,d;if(o.level!=="error"||!e.__loaded)return o;o.tags||(o.tags={});var f=e.config.ui_host||e.config.api_host;o.tags["PostHog Person URL"]=f+"/person/"+e.get_distinct_id(),e.sessionRecordingStarted()&&(o.tags["PostHog Recording URL"]=e.get_session_replay_url({withTimestamp:!0}));var h=((a=o.exception)===null||a===void 0?void 0:a.values)||[],g={$exception_message:(l=h[0])===null||l===void 0?void 0:l.value,$exception_type:(c=h[0])===null||c===void 0?void 0:c.type,$exception_personURL:f+"/person/"+e.get_distinct_id(),$sentry_event_id:o.event_id,$sentry_exception:o.exception,$sentry_exception_message:(u=h[0])===null||u===void 0?void 0:u.value,$sentry_exception_type:(d=h[0])===null||d===void 0?void 0:d.type,$sentry_tags:o.tags};return n&&r&&(g.$sentry_url=(i||"https://sentry.io/organizations/")+n+"/issues/?project="+r+"&query="+o.event_id),e.capture("$exception",g),o})}}),_f=function(t){Promise&&Promise.resolve||console.warn("This browser does not have Promise support, and can not use the segment integration");var e=function(n,r){n.event.userId||n.event.anonymousId===t.get_distinct_id()||t.reset(),n.event.userId&&n.event.userId!==t.get_distinct_id()&&(t.register({distinct_id:n.event.userId}),t.reloadFeatureFlags());var i=t._calculate_event_properties(r,n.event.properties);return n.event.properties=Object.assign({},i,n.event.properties),n};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:function(){return!0},load:function(){return Promise.resolve()},track:function(n){return e(n,n.event.event)},page:function(n){return e(n,"$pageview")},identify:function(n){return e(n,"$identify")},screen:function(n){return e(n,"$screen")}}},mf=function(){function t(){ce(this,t),N(this,"_seenFirstPageView",!1)}return ue(t,[{key:"onPageview",value:function(){this._seenFirstPageView&&(this._pageViewId=bt()),this._seenFirstPageView=!0}},{key:"getPageViewId",value:function(){return this._pageViewId||(this._pageViewId=bt()),this._pageViewId}}]),t}();function ka(t){return typeof Event<"u"&&Sa(t,Event)}function Sa(t,e){try{return t instanceof e}catch{return!1}}function Ea(t){return t===null||Tt(t)!=="object"&&typeof t!="function"}function hr(t,e){return Object.prototype.toString.call(t)==="[object ".concat(e,"]")}function Ti(t){return hr(t,"DOMError")}var Aa=/\(error: (.*)\)/,Ia=50,pr="?";function Ri(t,e,n,r){var i={filename:t,function:e,in_app:!0};return n!==void 0&&(i.lineno=n),r!==void 0&&(i.colno=r),i}var yf=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,bf=/\((\S*)(?::(\d+))(?::(\d+))\)/,wf=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,kf=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Sf=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Ef=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.sort(function(i,s){return i[0]-s[0]}).map(function(i){return i[1]});return function(i){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=[],a=i.split(`
`),l=s;l<a.length;l++){var c=a[l];if(!(c.length>1024)){var u=Aa.test(c)?c.replace(Aa,"$1"):c;if(!u.match(/\S*Error: /)){var d,f=_t(r);try{for(f.s();!(d=f.n()).done;){var h=(0,d.value)(u);if(h){o.push(h);break}}}catch(g){f.e(g)}finally{f.f()}if(o.length>=Ia)break}}}return function(g){if(!g.length)return[];var p=g.slice(0,Ia);return p.reverse(),p.map(function(_){return M(M({},_),{},{filename:_.filename||p[p.length-1].filename,function:_.function||"?"})})}(o)}}.apply(void 0,[[30,function(t){var e=yf.exec(t);if(e){if(e[2]&&e[2].indexOf("eval")===0){var n=bf.exec(e[2]);n&&(e[2]=n[1],e[3]=n[2],e[4]=n[3])}var r=Rt(xa(e[1]||pr,e[2]),2),i=r[0];return Ri(r[1],i,e[3]?+e[3]:void 0,e[4]?+e[4]:void 0)}}],[50,function(t){var e=wf.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){var n=kf.exec(e[3]);n&&(e[1]=e[1]||"eval",e[3]=n[1],e[4]=n[2],e[5]="")}var r=e[3],i=e[1]||pr,s=Rt(xa(i,r),2);return i=s[0],Ri(r=s[1],i,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}],[40,function(t){var e=Sf.exec(t);return e?Ri(e[2],e[1]||pr,+e[3],e[4]?+e[4]:void 0):void 0}]]),xa=function(t,e){var n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:pr,n?"safari-extension:".concat(e):"safari-web-extension:".concat(e)]:[t,e]},Af=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i,If=/Minified React error #\d+;/i;function xf(t){var e=t.stacktrace||t.stack||"",n=function(r){if(r){if(typeof r.framesToPop=="number")return r.framesToPop;if(If.test(r.message))return 1}return 0}(t);try{return Ef(e,n)}catch{}return[]}function Pi(t){var e=xf(t);return{$exception_type:t.name,$exception_message:t.message,$exception_stack_trace_raw:JSON.stringify(e)}}function Tf(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:40,n=Object.keys(t);if(n.sort(),!n.length)return"[object has no keys]";for(var r=n.length;r>0;r--){var i=n.slice(0,r).join(", ");if(!(i.length>e))return r===n.length||i.length<=e?i:"".concat(i.slice(0,e),"...")}return""}function Ta(t){var e=Rt(t,5),n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a={};if(o===void 0&&typeof n=="string"){var l="Error",c=n,u=n.match(Af);u&&(l=u[1],c=u[2]),a={$exception_type:l,$exception_message:c}}var d=o||n;if(Ti(d)||function(p){return hr(p,"DOMException")}(d)){var f=d;if(function(p){return"stack"in p}(d))a=Pi(d);else{var h=f.name||(Ti(f)?"DOMError":"DOMException"),g=f.message?"".concat(h,": ").concat(f.message):h;a=function(p){return{$exception_type:"Error",$exception_message:p}}(g),a.$exception_type=Ti(f)?"DOMError":"DOMException",a.$exception_message=a.$exception_message||g}"code"in f&&(a.$exception_DOMException_code="".concat(f.code))}else(function(p){return hr(p,"ErrorEvent")})(d)&&d.error?a=Pi(d.error):function(p){switch(Object.prototype.toString.call(p)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return Sa(p,Error)}}(d)?a=Pi(d):function(p){return hr(p,"Object")}(d)||ka(d)?(a=function(p){return{$exception_type:ka(p)?p.constructor.name:"Error",$exception_message:"Non-Error ".concat("exception"," captured with keys: ",Tf(p))}}(d),a.$exception_is_synthetic=!0):(a.$exception_type=a.$exception_type||"Error",a.$exception_message=a.$exception_message||d,a.$exception_is_synthetic=!0);return M(M(M(M({},a),{},{$exception_type:a.$exception_type||"UnknownErrorType",$exception_message:a.$exception_message||""},r?{$exception_source:r}:{}),i?{$exception_lineno:i}:{}),s?{$exception_colno:s}:{})}var xn,Oi,xe,Rf=function(){function t(e){ce(this,t),N(this,"originalOnErrorHandler",void 0),N(this,"originalOnUnhandledRejectionHandler",void 0),N(this,"errorsToIgnore",[]),this.instance=e}return ue(t,[{key:"debugLog",value:function(){if(this.instance.get_config("debug")){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(e=console).log.apply(e,["PostHog.js [PostHog.ExceptionObserver]"].concat(r))}}},{key:"startCapturing",value:function(){var e;if(this.isEnabled()&&((e=F.onerror)===null||e===void 0||!e.__POSTHOG_INSTRUMENTED__))try{this.originalOnErrorHandler=F.onerror,F.onerror=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return this.captureException(r),!!this.originalOnErrorHandler&&this.originalOnErrorHandler.apply(this,r)}.bind(this),F.onerror.__POSTHOG_INSTRUMENTED__=!0,this.originalOnUnhandledRejectionHandler=F.onunhandledrejection,F.onunhandledrejection=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var s=function(o){var a=Rt(o,1)[0],l=a;try{"reason"in a?l=a.reason:"detail"in a&&"reason"in a.detail&&(l=a.detail.reason)}catch{}var c={};return(c=Ea(l)?{$exception_message:"Non-Error promise rejection captured with value: ".concat(String(l))}:Ta([l])).$exception_handled=!1,M(M({},c),{},{$exception_type:c.$exception_type="UnhandledRejection",$exception_message:c.$exception_message=c.$exception_message||a.reason||String(l)})}(r);return this.sendExceptionEvent(s),!this.originalOnUnhandledRejectionHandler||this.originalOnUnhandledRejectionHandler.apply(F,r)}.bind(this),F.onunhandledrejection.__POSTHOG_INSTRUMENTED__=!0}catch(n){console.error("PostHog failed to start exception autocapture",n),this.stopCapturing()}}},{key:"stopCapturing",value:function(){var e,n;this.originalOnErrorHandler!==void 0&&(F.onerror=this.originalOnErrorHandler,this.originalOnErrorHandler=null),(e=F.onerror)===null||e===void 0||delete e.__POSTHOG_INSTRUMENTED__,this.originalOnUnhandledRejectionHandler!==void 0&&(F.onunhandledrejection=this.originalOnUnhandledRejectionHandler,this.originalOnUnhandledRejectionHandler=null),(n=F.onunhandledrejection)===null||n===void 0||delete n.__POSTHOG_INSTRUMENTED__}},{key:"isCapturing",value:function(){var e;return!((e=F.onerror)===null||e===void 0||!e.__POSTHOG_INSTRUMENTED__)}},{key:"isEnabled",value:function(){var e;return(e=this.remoteEnabled)!==null&&e!==void 0&&e}},{key:"afterDecideResponse",value:function(e){var n=e.autocaptureExceptions;if(this.remoteEnabled=!!n||!1,!Ea(n)&&"errors_to_ignore"in n&&Array.isArray(n.errors_to_ignore)){var r=n.errors_to_ignore;this.errorsToIgnore=r.map(function(i){return new RegExp(i)})}this.isEnabled()?(this.startCapturing(),this.debugLog("Remote config for exception autocapture is enabled, starting",n)):this.debugLog("Remote config for exception autocapture is disabled, not starting",n)}},{key:"captureException",value:function(e,n){var r=Ta(e);if(this.errorsToIgnore.some(function(o){return o.test(r.$exception_message||"")}))this.debugLog("Ignoring exception based on remote config",r);else{var i=M(M({},n),r),s=this.instance.get_config("ui_host")||this.instance.get_config("api_host");r.$exception_personURL=s+"/person/"+this.instance.get_distinct_id(),this.sendExceptionEvent(i)}}},{key:"sendExceptionEvent",value:function(e){this.instance.capture("$exception",e,{transport:"XHR",method:"POST",endpoint:"/e/",_noTruncate:!0,_batchKey:"exceptionEvent"})}}]),t}(),Pf=function(){function t(e){ce(this,t),this.instance=e}return ue(t,[{key:"getSurveys",value:function(e){var n=this,r=arguments.length>1&&arguments[1]!==void 0&&arguments[1],i=this.instance.get_property(gi);if(i&&!r)return e(i);this.instance._send_request("".concat(this.instance.get_config("api_host"),"/api/surveys/?token=").concat(this.instance.get_config("token")),{},{method:"GET"},function(s){var o=s.surveys;return n.instance.persistence.register(N({},gi,o)),e(o)})}},{key:"getActiveMatchingSurveys",value:function(e){var n=this,r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.getSurveys(function(i){var s=i.filter(function(o){return!(!o.start_date||o.end_date)}).filter(function(o){var a,l;if(!o.conditions)return!0;var c=(a=o.conditions)===null||a===void 0||!a.url||window.location.href.indexOf(o.conditions.url)>-1,u=(l=o.conditions)===null||l===void 0||!l.selector||document.querySelector(o.conditions.selector);return c&&u}).filter(function(o){if(!o.linked_flag_key&&!o.targeting_flag_key)return!0;var a=!o.linked_flag_key||n.instance.featureFlags.isFeatureEnabled(o.linked_flag_key),l=!o.targeting_flag_key||n.instance.featureFlags.isFeatureEnabled(o.targeting_flag_key);return a&&l});return e(s)},r)}}]),t}();(function(t){t[t.INIT_MODULE=0]="INIT_MODULE",t[t.INIT_SNIPPET=1]="INIT_SNIPPET"})(xn||(xn={}));var Fi=function(){},gr={},Ne="posthog",vr=F.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,Ra=!vr&&Je.indexOf("MSIE")===-1&&Je.indexOf("Mozilla")===-1,Pa=function(){var t,e,n;return{api_host:"https://app.posthog.com",api_method:"POST",api_transport:"XHR",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:(_e==null||(t=_e.location)===null||t===void 0||(e=t.hostname)===null||e===void 0?void 0:e.indexOf("herokuapp.com"))===-1,persistence:"cookie",persistence_name:"",cookie_name:"",loaded:Fi,store_google:!0,custom_campaign_params:[],save_referrer:!0,test:!1,verbose:!1,capture_pageview:!0,capture_pageleave:!0,debug:!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_cookie:!1,enable_recording_console_log:void 0,secure_cookie:(F==null||(n=F.location)===null||n===void 0?void 0:n.protocol)==="https:",ip:!0,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_blacklist:[],respect_dnt:!1,sanitize_properties:null,xhr_headers:{},inapp_protocol:"//",inapp_link_new_window:!1,request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,advanced_disable_decide:!1,advanced_disable_toolbar_metrics:!1,on_xhr_error:function(r){var i="Bad HTTP status: "+r.status+" "+r.statusText;console.error(i)},get_device_id:function(r){return r},_onCapture:Fi,_capture_metrics:!1,capture_performance:void 0,name:"posthog",callback_fn:"posthog._jsc",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800}},Ci=function(t,e,n,r){var i,s=n!==Ne&&xe?n?xe[n]:void 0:xe,o={initComplete:!1,syncCode:!1},a=function(l){return function(c){o[l]||(o[l]=!0,o.initComplete&&o.syncCode&&(r==null||r(c)))}};if(s&&Oi===xn.INIT_MODULE)i=s;else{if(s&&!yt(s))return void console.error("You have already initialized "+n);i=new $i}return i._init(t,e,n,a("initComplete")),i.toolbar.maybeLoadToolbar(),i.sessionRecording=new Dd(i),i.sessionRecording.startRecordingIfEnabled(),i.webPerformance=new qd(i),i.webPerformance.startObservingIfEnabled(),i.exceptionAutocapture=new Rf(i),i.__autocapture=i.get_config("autocapture"),Ot._setIsAutocaptureEnabled(i),Ot._isAutocaptureEnabled&&(i.__autocapture=i.get_config("autocapture"),Ot.enabledForProject(i.get_config("token"),100,100)?Ot.isBrowserSupported()?Ot.init(i):(i.__autocapture=!1,re.log("Disabling Automatic Event Collection because this browser is not supported")):(i.__autocapture=!1,re.log("Not in active bucket: disabling Automatic Event Collection."))),rt.DEBUG=rt.DEBUG||i.get_config("debug"),s!==void 0&&yt(s)&&(i._execute_array.call(i.people,s.people),i._execute_array(s)),a("syncCode")(i),i},$i=function(){function t(){var e=this;ce(this,t),this.config=Pa(),this.compression={},this.decideEndpointWasHit=!1,this.SentryIntegration=vf,this.segmentIntegration=function(){return _f(e)},this.__captureHooks=[],this.__request_queue=[],this.__loaded=!1,this.__loaded_recorder_version=void 0,this.__autocapture=void 0,this._jsc=function(){},this.people=new Od(this),this.featureFlags=new Fd(this),this.toolbar=new Jd(this),this.pageViewIdManager=new mf,this.surveys=new Pf(this),this._captureMetrics=void 0,this._requestQueue=void 0,this._retryQueue=void 0,this.persistence=void 0,this.sessionPersistence=void 0,this.sessionManager=void 0}return ue(t,[{key:"init",value:function(e,n,r){if(Xe(r))console.error("You must name your new library: init(token, config, name)");else{if(r!==Ne){var i=Ci(e,n,r,function(s){xe[r]=s,s._loaded()});return xe[r]=i,i}console.error("You must initialize the main posthog object right after you include the PostHog js snippet")}}},{key:"_init",value:function(e){var n,r,i=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;this.__loaded=!0,this.config={},this._triggered_notifs=[];var l,c={segmentRegister:!1,syncCode:!1},u=function(y){return function(){c[y]||(c[y]=!0,c.segmentRegister&&c.syncCode&&(a==null||a(i)))}};if(this.set_config(Ae({},Pa(),s,{name:o,token:e,callback_fn:(o===Ne?o:Ne+"."+o)+"._jsc"})),this._jsc=function(){},(F!=null&&(n=F.rrweb)!==null&&n!==void 0&&n.record||F!=null&&F.rrwebRecord)&&(this.__loaded_recorder_version=F==null||(l=F.rrweb)===null||l===void 0?void 0:l.version),this._captureMetrics=new Qd(this.get_config("_capture_metrics")),this._requestQueue=new Kd(this._captureMetrics,this._handle_queued_event.bind(this)),this._retryQueue=new hf(this._captureMetrics,this.get_config("on_xhr_error")),this.__captureHooks=[],this.__request_queue=[],this.persistence=new ea(this.config),this.sessionManager=new gf(this.config,this.persistence),this.sessionPersistence=this.config.persistence==="sessionStorage"?this.persistence:new ea(M(M({},this.config),{},{persistence:"sessionStorage"})),this._gdpr_init(),s.segment?(this.config.get_device_id=function(){return s.segment.user().anonymousId()},s.segment.user().id()&&(this.register({distinct_id:s.segment.user().id()}),this.persistence.set_user_state("identified")),s.segment.register(this.segmentIntegration()).then(u("segmentRegister"))):u("segmentRegister")(),((r=s.bootstrap)===null||r===void 0?void 0:r.distinctID)!==void 0){var d,f,h=this.get_config("get_device_id")(bt()),g=(d=s.bootstrap)!==null&&d!==void 0&&d.isIdentifiedID?h:s.bootstrap.distinctID;this.persistence.set_user_state((f=s.bootstrap)!==null&&f!==void 0&&f.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:s.bootstrap.distinctID,$device_id:g})}if(this._hasBootstrappedFeatureFlags()){var p,_,v=Object.keys(((p=s.bootstrap)===null||p===void 0?void 0:p.featureFlags)||{}).filter(function(y){var S,I;return!((S=s.bootstrap)===null||S===void 0||(I=S.featureFlags)===null||I===void 0||!I[y])}).reduce(function(y,S){var I,$;return y[S]=((I=s.bootstrap)===null||I===void 0||($=I.featureFlags)===null||$===void 0?void 0:$[S])||!1,y},{}),m=Object.keys(((_=s.bootstrap)===null||_===void 0?void 0:_.featureFlagPayloads)||{}).filter(function(y){return v[y]}).reduce(function(y,S){var I,$,O,j;return(I=s.bootstrap)!==null&&I!==void 0&&($=I.featureFlagPayloads)!==null&&$!==void 0&&$[S]&&(y[S]=(O=s.bootstrap)===null||O===void 0||(j=O.featureFlagPayloads)===null||j===void 0?void 0:j[S]),y},{});this.featureFlags.receivedFeatureFlags({featureFlags:v,featureFlagPayloads:m})}if(!this.get_distinct_id()){var C=this.get_config("get_device_id")(bt());this.register_once({distinct_id:C,$device_id:C},""),this.persistence.set_user_state("anonymous")}F.addEventListener&&F.addEventListener("onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this)),u("syncCode")()}},{key:"_loaded",value:function(){this.featureFlags.setReloadingPaused(!0);try{this.get_config("loaded")(this)}catch(e){console.error("`loaded` function failed",e)}this._start_queue_if_opted_in(),this.get_config("capture_pageview")&&this.capture("$pageview",{},{send_instantly:!0}),this.get_config("advanced_disable_decide")||new Wd(this).call(),this.featureFlags.resetRequestQueue(),this.featureFlags.setReloadingPaused(!1)}},{key:"_start_queue_if_opted_in",value:function(){this.has_opted_out_capturing()||this.get_config("request_batching")&&this._requestQueue.poll()}},{key:"_dom_loaded",value:function(){var e=this;this.has_opted_out_capturing()||mt(this.__request_queue,function(n){e._send_request.apply(e,ti(n))}),this.__request_queue=[],this._start_queue_if_opted_in()}},{key:"_prepare_callback",value:function(e,n){if(Xe(e))return null;if(vr)return function(o){e(o,n)};var r=this._jsc,i=""+Math.floor(1e8*Math.random()),s=this.get_config("callback_fn")+"["+i+"]";return r[i]=function(o){delete r[i],e(o,n)},s}},{key:"_handle_unload",value:function(){this.get_config("request_batching")?(this.get_config("capture_pageview")&&this.get_config("capture_pageleave")&&this.capture("$pageleave"),this.get_config("_capture_metrics")&&(this._requestQueue.updateUnloadMetrics(),this.capture("$capture_metrics",this._captureMetrics.metrics)),this._requestQueue.unload(),this._retryQueue.unload()):this.get_config("capture_pageview")&&this.get_config("capture_pageleave")&&this.capture("$pageleave",null,{transport:"sendBeacon"})}},{key:"_handle_queued_event",value:function(e,n,r){var i=JSON.stringify(n);this.__compress_and_send_json_request(e,i,r||gr,Fi)}},{key:"__compress_and_send_json_request",value:function(e,n,r,i){var s=function(c,u,d){return c===Jt.GZipJS?[cf(uf(u),{mtime:0}),M(M({},d),{},{blob:!0,urlQueryArgs:{compression:Jt.GZipJS}})]:[{data:nr(u)},d]}(this.compression[Jt.GZipJS]?Jt.GZipJS:Jt.Base64,n,r),o=Rt(s,2),a=o[0],l=o[1];this._send_request(e,a,l,i)}},{key:"_send_request",value:function(e,n,r,i){if(Ra)this.__request_queue.push([e,n,r,i]);else{var s={method:this.get_config("api_method"),transport:this.get_config("api_transport"),verbose:this.get_config("verbose")};r=Ae(s,r||{}),vr||(r.method="GET");var o="sendBeacon"in F.navigator&&r.transport==="sendBeacon";if(e=df(e,r.urlQueryArgs||{},{ip:this.get_config("ip")}),o)try{F.navigator.sendBeacon(e,xi(n,M(M({},r),{},{sendBeacon:!0})))}catch(u){this.get_config("debug")&&console.error(u)}else if(vr)try{ba({url:e,data:n,headers:this.get_config("xhr_headers"),options:r,captureMetrics:this._captureMetrics,callback:i,retriesPerformedSoFar:0,retryQueue:this._retryQueue,onXHRError:this.get_config("on_xhr_error")})}catch(u){console.error(u)}else{var a,l=_e.createElement("script");l.type="text/javascript",l.async=!0,l.defer=!0,l.src=e;var c=_e.getElementsByTagName("script")[0];(a=c.parentNode)===null||a===void 0||a.insertBefore(l,c)}}}},{key:"_execute_array",value:function(e){var n,r=this,i=[],s=[],o=[];mt(e,function(l){l&&(n=l[0],yt(n)?o.push(l):typeof l=="function"?l.call(r):yt(l)&&n==="alias"?i.push(l):yt(l)&&n.indexOf("capture")!==-1&&typeof r[n]=="function"?o.push(l):s.push(l))});var a=function(l,c){mt(l,function(u){if(yt(u[0])){var d=c;W(u,function(f){d=d[f[0]].apply(d,f.slice(1))})}else this[u[0]].apply(this,u.slice(1))},c)};a(i,this),a(s,this),a(o,this)}},{key:"_hasBootstrappedFeatureFlags",value:function(){var e,n;return((e=this.config.bootstrap)===null||e===void 0?void 0:e.featureFlags)&&Object.keys((n=this.config.bootstrap)===null||n===void 0?void 0:n.featureFlags).length>0||!1}},{key:"push",value:function(e){this._execute_array([e])}},{key:"captureException",value:function(e,n){var r;(r=this.exceptionAutocapture)===null||r===void 0||r.captureException([e.name,void 0,void 0,void 0,e],n)}},{key:"capture",value:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gr;if(this.__loaded&&!ia(this,!1)){this._captureMetrics.incr("capture"),e==="$snapshot"&&this._captureMetrics.incr("snapshot");var i=(r=r||gr).transport;if(i&&(r.transport=i),Xe(e)||typeof e!="string")console.error("No event name provided to posthog.capture");else if(!bd(Je)){this.sessionPersistence.update_search_keyword(),this.get_config("store_google")&&this.sessionPersistence.update_campaign_params(),this.get_config("save_referrer")&&this.sessionPersistence.update_referrer_info();var s={uuid:bt("v7"),event:e,properties:this._calculate_event_properties(e,n||{})};e==="$identify"&&(s.$set=r.$set,s.$set_once=r.$set_once),(s=Uo(s,r._noTruncate?null:this.get_config("properties_string_max_length"))).timestamp=r.timestamp||new Date,this.get_config("debug")&&re.log("PostHog.js send",s);var o=JSON.stringify(s),a=this.get_config("api_host")+(r.endpoint||"/e/"),l=r!==gr;return!this.get_config("request_batching")||l&&!r._batchKey||r.send_instantly?this.__compress_and_send_json_request(a,o,r):this._requestQueue.enqueue(a,s,r),this._invokeCaptureHooks(e,s),s}}}},{key:"_addCaptureHook",value:function(e){this.__captureHooks.push(e)}},{key:"_invokeCaptureHooks",value:function(e,n){this.config._onCapture(e,n),W(this.__captureHooks,function(r){return r(e)})}},{key:"_calculate_event_properties",value:function(e,n){var r,i=this.persistence.remove_event_timer(e),s=M({},n);if(s.token=this.get_config("token"),e==="$snapshot"){var o=M(M({},this.persistence.properties()),this.sessionPersistence.properties());return s.distinct_id=o.distinct_id,s}var a=me.properties();if(this.sessionManager){var l=this.sessionManager.checkAndGetSessionAndWindowId(),c=l.sessionId,u=l.windowId;s.$session_id=c,s.$window_id=u}if((r=this.webPerformance)!==null&&r!==void 0&&r.isEnabled&&(e==="$pageview"&&this.pageViewIdManager.onPageview(),s=Ae(s,{$pageview_id:this.pageViewIdManager.getPageViewId()})),e==="$performance_event"){var d=this.persistence.properties();return s.distinct_id=d.distinct_id,s.$current_url=a.$current_url,s}if(i!==void 0){var f=new Date().getTime()-i;s.$duration=parseFloat((f/1e3).toFixed(3))}s=Ae({},me.properties(),this.persistence.properties(),this.sessionPersistence.properties(),s);var h=this.get_config("property_blacklist");yt(h)?W(h,function(p){delete s[p]}):console.error("Invalid value for property_blacklist config: "+h);var g=this.get_config("sanitize_properties");return g&&(s=g(s,e)),s}},{key:"register",value:function(e,n){this.persistence.register(e,n)}},{key:"register_once",value:function(e,n,r){this.persistence.register_once(e,n,r)}},{key:"register_for_session",value:function(e){this.sessionPersistence.register(e)}},{key:"unregister",value:function(e){this.persistence.unregister(e)}},{key:"unregister_for_session",value:function(e){this.sessionPersistence.unregister(e)}},{key:"_register_single",value:function(e,n){this.register(N({},e,n))}},{key:"getFeatureFlag",value:function(e,n){return this.featureFlags.getFeatureFlag(e,n)}},{key:"getFeatureFlagPayload",value:function(e){var n=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(n)}catch{return n}}},{key:"isFeatureEnabled",value:function(e,n){return this.featureFlags.isFeatureEnabled(e,n)}},{key:"reloadFeatureFlags",value:function(){this.featureFlags.reloadFeatureFlags()}},{key:"updateEarlyAccessFeatureEnrollment",value:function(e,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,n)}},{key:"getEarlyAccessFeatures",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.featureFlags.getEarlyAccessFeatures(e,n)}},{key:"onFeatureFlags",value:function(e){return this.featureFlags.onFeatureFlags(e)}},{key:"getSurveys",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.surveys.getSurveys(e,n)}},{key:"getActiveMatchingSurveys",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.surveys.getActiveMatchingSurveys(e,n)}},{key:"identify",value:function(e,n,r){if(e){this._captureMetrics.incr("identify");var i=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var s=i;this.register_once({$had_persisted_distinct_id:!0,$device_id:s},"")}e!==i&&e!==this.get_property(ar)&&(this.unregister(ar),this.register({distinct_id:e}));var o=this.persistence.get_user_state()==="anonymous";e!==i&&o?(this.persistence.set_user_state("identified"),this.capture("$identify",{distinct_id:e,$anon_distinct_id:i},{$set:n||{},$set_once:r||{}}),this.featureFlags.setAnonymousDistinctId(i)):(n&&this.people.set(n),r&&this.people.set_once(r)),e!==i&&(this.reloadFeatureFlags(),this.unregister(lr))}else console.error("Unique user id has not been set in posthog.identify")}},{key:"group",value:function(e,n,r){if(e&&n){this._captureMetrics.incr("group");var i=this.getGroups();i[e]!==n&&this.resetGroupPropertiesForFlags(e),this.register({$groups:M(M({},i),{},N({},e,n))}),r&&(this.capture("$groupidentify",{$group_type:e,$group_key:n,$group_set:r}),this.setGroupPropertiesForFlags(N({},e,r))),i[e]===n||r||this.reloadFeatureFlags()}else console.error("posthog.group requires a group type and group key")}},{key:"resetGroups",value:function(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}},{key:"setPersonPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.featureFlags.setPersonPropertiesForFlags(e,n)}},{key:"resetPersonPropertiesForFlags",value:function(){this.featureFlags.resetPersonPropertiesForFlags()}},{key:"setGroupPropertiesForFlags",value:function(e){var n=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.featureFlags.setGroupPropertiesForFlags(e,n)}},{key:"resetGroupPropertiesForFlags",value:function(e){this.featureFlags.resetGroupPropertiesForFlags(e)}},{key:"reset",value:function(e){var n=this.get_property("$device_id");this.persistence.clear(),this.sessionPersistence.clear(),this.persistence.set_user_state("anonymous"),this.sessionManager.resetSessionId();var r=this.get_config("get_device_id")(bt());this.register_once({distinct_id:r,$device_id:e?r:n},"")}},{key:"get_distinct_id",value:function(){return this.get_property("distinct_id")}},{key:"getGroups",value:function(){return this.get_property("$groups")||{}}},{key:"get_session_id",value:function(){return this.sessionManager.checkAndGetSessionAndWindowId(!0).sessionId}},{key:"get_session_replay_url",value:function(e){var n=this.config.ui_host||this.config.api_host,r=this.sessionManager.checkAndGetSessionAndWindowId(!0),i=r.sessionId,s=r.sessionStartTimestamp,o=n+"/replay/"+i;if(e!=null&&e.withTimestamp&&s){var a,l=(a=e.timestampLookBack)!==null&&a!==void 0?a:10;if(!s)return o;var c=Math.max(Math.floor((new Date().getTime()-s)/1e3)-l,0);o+="?t=".concat(c)}return o}},{key:"alias",value:function(e,n){return e===this.get_property(Qo)?(re.critical("Attempting to create alias for existing People user - aborting."),-2):(Xe(n)&&(n=this.get_distinct_id()),e!==n?(this._register_single(ar,e),this.capture("$create_alias",{alias:e,distinct_id:n})):(console.error("alias matches current distinct_id - skipping api call."),this.identify(e),-1))}},{key:"set_config",value:function(e){var n=M({},this.config);qt(e)&&(Ae(this.config,e),this.get_config("persistence_name")||(this.config.persistence_name=this.config.cookie_name),this.get_config("disable_persistence")||(this.config.disable_persistence=this.config.disable_cookie),this.persistence&&this.persistence.update_config(this.config),this.sessionPersistence&&this.sessionPersistence.update_config(this.config),he.is_supported()&&he.get("ph_debug")==="true"&&(this.config.debug=!0),this.get_config("debug")&&(rt.DEBUG=!0),this.sessionRecording&&e.disable_session_recording!==void 0&&n.disable_session_recording!==e.disable_session_recording&&(e.disable_session_recording?this.sessionRecording.stopRecording():this.sessionRecording.startRecordingIfEnabled()))}},{key:"startSessionRecording",value:function(){this.set_config({disable_session_recording:!1})}},{key:"stopSessionRecording",value:function(){this.set_config({disable_session_recording:!0})}},{key:"sessionRecordingStarted",value:function(){var e;return!((e=this.sessionRecording)===null||e===void 0||!e.started())}},{key:"loadToolbar",value:function(e){return this.toolbar.loadToolbar(e)}},{key:"get_config",value:function(e){var n;return(n=this.config)===null||n===void 0?void 0:n[e]}},{key:"get_property",value:function(e){return this.persistence.props[e]}},{key:"getSessionProperty",value:function(e){return this.sessionPersistence.props[e]}},{key:"toString",value:function(){var e,n=(e=this.get_config("name"))!==null&&e!==void 0?e:Ne;return n!==Ne&&(n=Ne+"."+n),n}},{key:"_gdpr_init",value:function(){this.get_config("opt_out_capturing_persistence_type")==="localStorage"&&he.is_supported()&&(!this.has_opted_in_capturing()&&this.has_opted_in_capturing({persistence_type:"cookie"})&&this.opt_in_capturing({enable_persistence:!1}),!this.has_opted_out_capturing()&&this.has_opted_out_capturing({persistence_type:"cookie"})&&this.opt_out_capturing({clear_persistence:!1}),this.clear_opt_in_out_capturing({persistence_type:"cookie",enable_persistence:!1})),this.has_opted_out_capturing()?this._gdpr_update_persistence({clear_persistence:!0}):this.has_opted_in_capturing()||!this.get_config("opt_out_capturing_by_default")&&!it.get("ph_optout")||(it.remove("ph_optout"),this.opt_out_capturing({clear_persistence:this.get_config("opt_out_persistence_by_default")}))}},{key:"_gdpr_update_persistence",value:function(e){var n;if(e&&e.clear_persistence)n=!0;else{if(!e||!e.enable_persistence)return;n=!1}this.get_config("disable_persistence")||this.persistence.disabled===n||this.persistence.set_disabled(n),this.get_config("disable_persistence")||this.sessionPersistence.disabled===n||this.sessionPersistence.set_disabled(n)}},{key:"_gdpr_call_func",value:function(e,n){return n=Ae({capture:this.capture.bind(this),persistence_type:this.get_config("opt_out_capturing_persistence_type"),cookie_prefix:this.get_config("opt_out_capturing_cookie_prefix"),cookie_expiration:this.get_config("cookie_expiration"),cross_subdomain_cookie:this.get_config("cross_subdomain_cookie"),secure_cookie:this.get_config("secure_cookie")},n||{}),he.is_supported()||n.persistence_type!=="localStorage"||(n.persistence_type="cookie"),e(this.get_config("token"),{capture:n.capture,captureEventName:n.capture_event_name,captureProperties:n.capture_properties,persistenceType:n.persistence_type,persistencePrefix:n.cookie_prefix,cookieExpiration:n.cookie_expiration,crossSubdomainCookie:n.cross_subdomain_cookie,secureCookie:n.secure_cookie})}},{key:"opt_in_capturing",value:function(e){e=Ae({enable_persistence:!0},e||{}),this._gdpr_call_func(xd,e),this._gdpr_update_persistence(e)}},{key:"opt_out_capturing",value:function(e){var n=Ae({clear_persistence:!0},e||{});this._gdpr_call_func(Td,n),this._gdpr_update_persistence(n)}},{key:"has_opted_in_capturing",value:function(e){return this._gdpr_call_func(Rd,e)}},{key:"has_opted_out_capturing",value:function(e){return this._gdpr_call_func(ta,e)}},{key:"clear_opt_in_out_capturing",value:function(e){var n=Ae({enable_persistence:!0},e??{});this._gdpr_call_func(Pd,n),this._gdpr_update_persistence(n)}},{key:"debug",value:function(e){e===!1?(F.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(F.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}}]),t}();(function(t,e){for(var n=0;n<e.length;n++)t.prototype[e[n]]=Do(t.prototype[e[n]])})($i,["identify"]);var Ft={},Of=function(){xe.init=function(t,e,n){if(n)return xe[n]||(xe[n]=Ft[n]=Ci(t||"",e||{},n,function(i){xe[n]=Ft[n]=i,i._loaded()})),xe[n];var r=xe;return Ft[Ne]?r=Ft[Ne]:t&&(r=Ci(t,e||{},Ne,function(i){Ft[Ne]=i,i._loaded()}),Ft[Ne]=r),xe=r,Oi===xn.INIT_SNIPPET&&(F[Ne]=xe),W(Ft,function(i,s){s!==Ne&&(xe[s]=i)}),r}},Ff=function(){function t(){t.done||(t.done=!0,Ra=!1,W(Ft,function(e){e._dom_loaded()}))}_e.addEventListener&&(_e.readyState==="complete"?t():_e.addEventListener("DOMContentLoaded",t,!1)),kn(F,"load",t,!0)},Oa=(Oi=xn.INIT_MODULE,xe=new $i,Of(),xe.init(),Ff(),xe);let Fa="";function Cf(t){Fa=t,window.location.hostname!=="localhost"&&Oa.init("phc_TAooetKnDVSmvK9WfqtFVUtiEjxpgnPYQ5OaTWUVuY8",{api_host:"https://eu.posthog.com"})}function Ca(t,e={}){e.kbid=Fa,window.location.hostname!=="localhost"?Oa.capture(`[${t}]`,e):localStorage.getItem("DEBUG_TRACKING")==="on"&&console.info(`[${t}]`,e)}const ee=new Dt({currentResult:null,selectedParagraphIndex:-1,playFromTranscript:!1,summary:"",isPreviewing:!1,fieldFullId:null,transcripts:[],fullMetadataLoaded:!1,query:null,searchInFieldResults:null,hasError:!1}),$f=ee.reader(t=>{var e,n;return((e=t.currentResult)==null?void 0:e.resultType)==="video"||((n=t.currentResult)==null?void 0:n.resultType)==="audio"});ee.reader(t=>{var s;const e=(((s=t.currentResult)==null?void 0:s.paragraphs)||[]).length>0?1:0,n=$f.getValue()?1:0,r=t.summary?1:0,i=(Mf.getValue()||[]).length>0?1:0;return e+n+r+i});const $a=ee.writer(t=>t,(t,e)=>({...t,currentResult:e.result?{...e.result,paragraphs:e.result.paragraphs||[]}:null,selectedParagraphIndex:e.selectedParagraphIndex,fieldFullId:e.result&&e.result.field?{field_id:e.result.field.field_id,field_type:e.result.field.field_type,resourceId:e.result.id}:null,isPreviewing:!!e,searchInFieldResults:null,fullMetadataLoaded:!1}));ee.writer(t=>t.query,(t,e)=>{const n=e.trim();return n!==t.query?{...t,query:n,hasError:!1}:t}),ee.writer(t=>t.searchInFieldResults,(t,e)=>({...t,searchInFieldResults:e,selectedParagraphIndex:-1})),ee.action(t=>({...t,searchInFieldResults:null,query:null,selectedParagraphIndex:-1,playFromTranscripts:!1})),ee.writer(t=>t.hasError,(t,e)=>({...t,hasError:e})),ee.writer(t=>t.isPreviewing,(t,e)=>({...t,isPreviewing:e})),ee.writer(t=>t.selectedParagraphIndex,(t,e)=>({...t,selectedParagraphIndex:e.index,playFromTranscript:e.playFromTranscripts})),ee.reader(t=>{if(t.selectedParagraphIndex!==null){if(t.searchInFieldResults)return t.searchInFieldResults[t.selectedParagraphIndex];if(t.currentResult&&t.currentResult.paragraphs)return t.currentResult.paragraphs[t.selectedParagraphIndex]}return null}),ee.action(t=>t.selectedParagraphIndex!==null&&t.selectedParagraphIndex>0?{...t,selectedParagraphIndex:t.selectedParagraphIndex-1,playFromTranscript:!1}:t),ee.action(t=>{var e;return(e=t.currentResult)!=null&&e.paragraphs?t.playFromTranscript?{...t,selectedParagraphIndex:0,playFromTranscript:!1}:t.selectedParagraphIndex!==null&&t.selectedParagraphIndex<t.currentResult.paragraphs.length-1?{...t,selectedParagraphIndex:t.selectedParagraphIndex+1,playFromTranscript:!1}:t:t}),ee.reader(t=>{var e;return((e=t.currentResult)==null?void 0:e.resultType)||null}),ee.reader(t=>{var e;return((e=t.currentResult)==null?void 0:e.thumbnail)||null}),ee.reader(t=>{var r,i,s;if(t.selectedParagraphIndex===null||t.playFromTranscript&&t.transcripts.length===0||!t.playFromTranscript&&(!((r=t.currentResult)!=null&&r.paragraphs)||t.currentResult.paragraphs.length===0))return 0;const n=(t.playFromTranscript?t.transcripts:(i=t.currentResult)==null?void 0:i.paragraphs)[t.selectedParagraphIndex];return((s=n==null?void 0:n.position.start_seconds)==null?void 0:s[0])||0});const jf=ee.writer(t=>t.fieldFullId,(t,e)=>({...t,fieldFullId:e}));ee.writer(t=>{var e;return((e=t.currentResult)==null?void 0:e.fieldData)||null},(t,e)=>{var i,s,o,a;let n;e&&(n={value:e.value,extracted:e.extracted});const r=t.currentResult?{...t.currentResult,fieldData:n}:null;return{...t,currentResult:r,summary:((a=(o=(s=(i=e==null?void 0:e.extracted)==null?void 0:i.metadata)==null?void 0:s.metadata)==null?void 0:o.summary)==null?void 0:a.trim())||""}});const Mf=ee.reader(t=>{if(!t.currentResult)return null;const e=t.currentResult,n=Object.entries(e.data||{}).filter(([r,i])=>r!=="generics"&&!!i).reduce((r,[i,s])=>{const o=Jr(i.substring(0,i.length-1));return o&&Object.keys(s).forEach(a=>r.push({field_id:a,field_type:o,resourceId:e.id})),r},[]);return n.length>1?n:null});ee.reader(t=>t.fullMetadataLoaded),ee.writer(t=>{var e,n,r,i;return(i=(r=(n=(e=t.currentResult)==null?void 0:e.fieldData)==null?void 0:n.extracted)==null?void 0:r.metadata)==null?void 0:i.metadata},(t,e)=>{var n,r,i,s;return(s=(i=(r=(n=t.currentResult)==null?void 0:n.fieldData)==null?void 0:r.extracted)==null?void 0:i.metadata)!=null&&s.metadata?{...t,currentResult:{...t.currentResult,fieldData:{...t.currentResult.fieldData,extracted:{...t.currentResult.fieldData.extracted,metadata:{...t.currentResult.fieldData.extracted.metadata,metadata:e}}}},fullMetadataLoaded:!0}:t}),ee.writer(t=>t.transcripts,(t,e)=>({...t,transcripts:e})),ee.reader(t=>t.summary),ee.reader(t=>{var e;return((e=t.fieldFullId)==null?void 0:e.field_type)||null});const ja=[pt.Features.PARAGRAPH,pt.Features.VECTOR],Ma=[It.Features.PARAGRAPHS];let J,_r,Na,Tn=[...ja],Rn=[...Ma],mr=[];const La={},Nf=(t,e,n)=>{var r,i,s,o,a,l,c,u,d,f;if(J)throw new Error("Cannot exist more than one Nuclia widget at the same time");if((r=n.features)!=null&&r.useSynonyms&&((i=n.features)!=null&&i.relations))throw new Error("Cannot use synonyms and relations at the same time");if((n.fuzzyOnly||(s=n.features)!=null&&s.useSynonyms)&&(Tn=[pt.Features.PARAGRAPH]),(o=n.features)!=null&&o.useSynonyms&&(La.with_synonyms=!0),J=new du(t),Cf(J.options.knowledgeBox||"kb not defined"),vo.set({inTitleOnly:!1,highlight:n.highlight,autofilter:!!((a=n.features)!=null&&a.autofilter)}),(l=n.features)!=null&&l.suggestLabels){const h=J==null?void 0:J.knowledgeBox.fullpath;if(h){_r=new Ju(Vn());const g=e==="PRIVATE"?J.auth.getAuthHeaders():{};_r.loadModels(h,g)}}return(c=n.features)!=null&&c.relations&&!Tn.includes(pt.Features.RELATIONS)&&(Tn.push(pt.Features.RELATIONS),Rn.push(It.Features.RELATIONS)),(u=n.features)!=null&&u.suggestions&&mr.push(pt.SuggestionFeatures.PARAGRAPH),(d=n.features)!=null&&d.suggestEntities&&mr.push(pt.SuggestionFeatures.ENTITIES),(f=n.features)!=null&&f.noBM25forChat&&(Rn=Rn.filter(h=>h!==It.Features.PARAGRAPHS)),Na=e,J},Lf=()=>{J=null,Tn=[...ja],Rn=[...Ma],mr=[]},zf=(t,e)=>{if(!J)throw new Error("Nuclia API not initialized");return J.knowledgeBox.find(t,Tn,{...La,...e}).pipe(le(n=>(n.type==="error"&&go.set(n),n.type==="findResults"||n.status===206)),E(n=>n.type==="error"?n.body:n))},Df=(t,e,n)=>{if(!J)throw new Error("Nuclia API not initialized");const r=e==null?void 0:e.reduce((i,s)=>(i.push({author:It.Author.USER,text:s.question}),i.push({author:It.Author.NUCLIA,text:s.answer.text}),i),[]);return J.knowledgeBox.chat(t,r,Rn,n?{...n,highlight:!0}:{highlight:!0})},Uf=(t,e)=>{if(!J)throw new Error("Nuclia API not initialized");return J.knowledgeBox.feedback(t.id,e)},za=t=>{if(!J)throw new Error("Nuclia API not initialized");return J.knowledgeBox.suggest(t,!0,mr).pipe(le(e=>(e.type==="error"&&co.set(e),e.type==="suggestions")))},Bf=t=>{if(!_r)throw new Error("Nuclia prediction not initialized");return _r.predict(t)},Da=(t,e)=>{if(!J)throw new Error("Nuclia API not initialized");return J.knowledgeBox.getResource(t,e)},qf=()=>{if(!J)throw new Error("Nuclia API not initialized");return J.options.standalone?`${J.options.backend}/v1`:J.regionalBackend+"/v1"},Hf=()=>{if(!J)throw new Error("Nuclia API not initialized");return J.knowledgeBox.getTempToken()},Wf=()=>{var t;return Na==="PRIVATE"||!!((t=J==null?void 0:J.options)!=null&&t.standalone)},Vf=(t,e=!1)=>(t.length===0||!Wf()?B(""):Hf()).pipe(E(r=>t.map(i=>{if(i.startsWith("/")){const s=(r?`eph-token=${r}`:"")+(e?"inline=true":""),o=`${qf()}${i}`;return s?`${o}?${s}`:o}else return i}))),Up="";function Gf(t){De(t,"svelte-cyofob",".sw-svg-icon.svelte-cyofob{fill:currentColor;height:var(--rhythm-3);width:var(--rhythm-3)}.sw-svg-icon.small.svelte-cyofob{height:var(--rhythm-2);width:var(--rhythm-2)}.sw-svg-icon.large.svelte-cyofob{height:var(--rhythm-5);width:var(--rhythm-5)}.sw-svg-icon.svelte-cyofob:focus{outline:0}")}function Ua(t){let e,n,r,i;return{c(){e=Ki("svg"),n=Ki("use"),b(n,"href",r="#"+t[0]),b(e,"class",i="sw-svg-icon "+t[1]+" svelte-cyofob"),b(e,"tabindex","-1")},m(s,o){R(s,e,o),x(e,n)},p(s,o){o&1&&r!==(r="#"+s[0])&&b(n,"href",r),o&2&&i!==(i="sw-svg-icon "+s[1]+" svelte-cyofob")&&b(e,"class",i)},d(s){s&&T(e)}}}function Jf(t){let e,n=t[0]&&Ua(t);return{c(){n&&n.c(),e=Ze()},m(r,i){n&&n.m(r,i),R(r,e,i)},p(r,[i]){r[0]?n?n.p(r,i):(n=Ua(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:L,o:L,d(r){n&&n.d(r),r&&T(e)}}}function Kf(t,e,n){let{name:r}=e,{size:i=""}=e;return t.$$set=s=>{"name"in s&&n(0,r=s.name),"size"in s&&n(1,i=s.size)},[r,i]}class Ba extends $e{constructor(e){super(),Oe(this,e,Kf,Jf,Pe,{name:0,size:1},Gf)}}const Bp="";function Qf(t){De(t,"svelte-18427o9",".sw-modal-header.svelte-18427o9.svelte-18427o9{display:flex;align-items:center;height:3em}.sw-modal-header.svelte-18427o9 .back.svelte-18427o9,.sw-modal-header.svelte-18427o9 .close.svelte-18427o9{-webkit-appearance:none;border:none;margin:0;padding:0;width:auto;background:transparent;cursor:pointer}.sw-modal-header.svelte-18427o9 .back.svelte-18427o9{color:#fff;font:inherit;font-size:1.2em;font-weight:var(--font-weight-bold)}.sw-modal-header.svelte-18427o9 .close.svelte-18427o9{margin-left:auto}.sw-modal-header.svelte-18427o9 .close img.svelte-18427o9{width:30px}@media(min-width: 599px){.sw-modal-header.svelte-18427o9.svelte-18427o9{position:absolute;top:0;width:100vw;left:calc((var(--resource-modal-width-md, fit-content) - 100vw) / 2)}.sw-modal-header.svelte-18427o9 .close.svelte-18427o9{margin-right:var(--rhythm-1)}}")}function qa(t){let e,n=t[2]("modal.back")+"",r,i,s;return{c(){e=k("button"),r=de(n),b(e,"class","back svelte-18427o9")},m(o,a){R(o,e,a),x(e,r),i||(s=V(e,"click",t[4]),i=!0)},p(o,a){a&4&&n!==(n=o[2]("modal.back")+"")&&we(r,n)},d(o){o&&T(e),i=!1,s()}}}function Ha(t){let e,n,r,i,s;return{c(){e=k("button"),n=k("img"),Fl(n.src,r=`${Vn()}icons/close-light.svg`)||b(n,"src",r),b(n,"alt","icon"),b(n,"class","svelte-18427o9"),b(e,"class","close svelte-18427o9")},m(o,a){R(o,e,a),x(e,n),i||(s=V(e,"click",t[3]),i=!0)},p:L,d(o){o&&T(e),i=!1,s()}}}function Xf(t){let e,n,r=t[1]&&qa(t),i=t[0]&&Ha(t);return{c(){e=k("div"),r&&r.c(),n=K(),i&&i.c(),b(e,"class","sw-modal-header svelte-18427o9")},m(s,o){R(s,e,o),r&&r.m(e,null),x(e,n),i&&i.m(e,null)},p(s,[o]){s[1]?r?r.p(s,o):(r=qa(s),r.c(),r.m(e,n)):r&&(r.d(1),r=null),s[0]?i?i.p(s,o):(i=Ha(s),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},i:L,o:L,d(s){s&&T(e),r&&r.d(),i&&i.d()}}}function Yf(t,e,n){let r;U(t,xt,c=>n(2,r=c));let{closeButton:i=!1}=e,{backButton:s=!1}=e;const o=St(),a=()=>{o("close")},l=()=>{o("back")};return t.$$set=c=>{"closeButton"in c&&n(0,i=c.closeButton),"backButton"in c&&n(1,s=c.backButton)},[i,s,r,a,l]}class Zf extends $e{constructor(e){super(),Oe(this,e,Yf,Xf,Pe,{closeButton:0,backButton:1},Qf)}}function eh(t=!1){if(t){const e=window.scrollY,n=document.body;n.style.position="fixed",n.style.top=`-${e}px`}else document.body.style.overflow="hidden"}function Wa(t=!1){if(t){const e=document.body,n=e.style.top;e.style.position="",e.style.top="",setTimeout(()=>th(n))}else document.body.style.overflow="inherit"}function th(t){window.scrollTo(0,parseInt(t||"0")*-1)}const qp="";function nh(t){De(t,"svelte-8jv0hp",".sw-modal-backdrop.svelte-8jv0hp.svelte-8jv0hp{bottom:0;left:0;position:fixed;right:0;top:0;z-index:var(--z-index-modal-backdrop)}.sw-modal-backdrop.fade.svelte-8jv0hp.svelte-8jv0hp{animation:svelte-8jv0hp-fadeIn 480ms}@keyframes svelte-8jv0hp-fadeIn{0%{opacity:0}100%{opacity:1}}.sw-modal-backdrop.visible.svelte-8jv0hp.svelte-8jv0hp{background-color:var(--color-backdrop)}.sw-modal-backdrop.svelte-8jv0hp .modal.svelte-8jv0hp{align-items:stretch;background-color:transparent;border:0;color:inherit;display:flex;flex-flow:column nowrap;left:50%;margin:0;max-width:100vw;padding:0;position:relative;top:50%;transform:translateX(-50%) translateY(-50%);z-index:var(--z-index-modal)}.sw-modal-backdrop.svelte-8jv0hp .modal .modal-content.svelte-8jv0hp{background-color:var(--color-light-stronger);overflow:auto}.sw-modal-backdrop.svelte-8jv0hp .modal-content.svelte-8jv0hp{z-index:0;overflow:scroll}@media(min-width: 599px){.sw-modal-backdrop.svelte-8jv0hp .modal.svelte-8jv0hp{max-height:calc(100vh - var(--popup-top));max-width:calc(100vw - var(--rhythm-3))}.sw-modal-backdrop.svelte-8jv0hp .modal .modal-content.svelte-8jv0hp::-webkit-scrollbar{width:var(--rhythm-1)}.sw-modal-backdrop.svelte-8jv0hp .modal .modal-content.svelte-8jv0hp::-webkit-scrollbar-thumb{background-color:var(--color-scrollbar-thumb)}.sw-modal-backdrop.svelte-8jv0hp .modal .modal-content.svelte-8jv0hp::-webkit-scrollbar-track{background-color:var(--color-scrollbar-track)}}.sw-modal-backdrop.svelte-8jv0hp.svelte-8jv0hp{--modal-width:calc(100vw - var(--side-spacing)*2)}.sw-modal-backdrop.popup.svelte-8jv0hp .modal .modal-content.svelte-8jv0hp{box-shadow:var(--shadow-modal)}.sw-modal-backdrop.popup.svelte-8jv0hp .modal.svelte-8jv0hp{position:fixed;left:var(--side-spacing);right:var(--side-spacing);top:var(--popup-top);transform:none;width:var(--modal-width)}.sw-modal-backdrop.svelte-8jv0hp:not(.popup) .modal-content.svelte-8jv0hp{width:var(--modal-width, fit-content);height:var(--modal-height, fit-content)}@media(min-width: 599px){.sw-modal-backdrop.popup.svelte-8jv0hp .modal.svelte-8jv0hp{--modal-width:var(--rhythm-64);left:var(--popup-left);max-height:calc(100vh - var(--popup-top) - var(--rhythm-3))}.sw-modal-backdrop.popup.align-right.svelte-8jv0hp .modal.svelte-8jv0hp{left:max(var(--popup-left) - var(--modal-width), 0px)}.sw-modal-backdrop.svelte-8jv0hp:not(.popup) .modal-content.svelte-8jv0hp{width:var(--resource-modal-width-md, fit-content);height:100vh}}")}function Va(t){var h,g,p;let e,n,r,i,s=`${((h=t[4])==null?void 0:h.bottom)||0}px`,o=`${(t[5]==="right"?(g=t[4])==null?void 0:g.right:(p=t[4])==null?void 0:p.left)||0}px`,a,l,c,u=(t[3]||t[2])&&Ga(t);const d=t[15].default,f=Er(d,t,t[14],null);return{c(){e=k("div"),n=k("dialog"),u&&u.c(),r=K(),i=k("div"),f&&f.c(),b(i,"class","modal-content svelte-8jv0hp"),Ce(i,"--modal-content-height",t[7]),b(n,"class","modal svelte-8jv0hp"),Ce(n,"--popup-top",s),Ce(n,"--popup-left",o),Ce(n,"--modal-width",t[6]?t[6]:""),b(e,"class","sw-modal-backdrop fade svelte-8jv0hp"),G(e,"visible",!t[1]),G(e,"popup",t[1]),G(e,"align-right",t[5]==="right")},m(_,v){R(_,e,v),x(e,n),u&&u.m(n,null),x(n,r),x(n,i),f&&f.m(i,null),t[17](i),a=!0,l||(c=[V(n,"click",t[12]),V(e,"click",t[11])],l=!0)},p(_,v){var m,C,y;_[3]||_[2]?u?(u.p(_,v),v&12&&w(u,1)):(u=Ga(_),u.c(),w(u,1),u.m(n,r)):u&&(pe(),P(u,1,1,()=>{u=null}),ge()),f&&f.p&&(!a||v&16384)&&Ir(f,d,_,_[14],a?Ar(d,_[14],v,null):xr(_[14]),null),v&128&&Ce(i,"--modal-content-height",_[7]),v&16&&s!==(s=`${((m=_[4])==null?void 0:m.bottom)||0}px`)&&Ce(n,"--popup-top",s),v&48&&o!==(o=`${(_[5]==="right"?(C=_[4])==null?void 0:C.right:(y=_[4])==null?void 0:y.left)||0}px`)&&Ce(n,"--popup-left",o),v&64&&Ce(n,"--modal-width",_[6]?_[6]:""),(!a||v&2)&&G(e,"visible",!_[1]),(!a||v&2)&&G(e,"popup",_[1]),(!a||v&32)&&G(e,"align-right",_[5]==="right")},i(_){a||(w(u),w(f,_),a=!0)},o(_){P(u),P(f,_),a=!1},d(_){_&&T(e),u&&u.d(),f&&f.d(_),t[17](null),l=!1,Re(c)}}}function Ga(t){let e,n;return e=new Zf({props:{closeButton:t[2],backButton:t[3]}}),e.$on("close",t[10]),e.$on("back",t[16]),{c(){ae(e.$$.fragment)},m(r,i){ie(e,r,i),n=!0},p(r,i){const s={};i&4&&(s.closeButton=r[2]),i&8&&(s.backButton=r[3]),e.$set(s)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function rh(t){let e,n,r,i,s=t[0]&&Va(t);return{c(){s&&s.c(),e=Ze()},m(o,a){s&&s.m(o,a),R(o,e,a),n=!0,r||(i=[V(window,"keydown",t[13]),V(window,"resize",t[9])],r=!0)},p(o,[a]){o[0]?s?(s.p(o,a),a&1&&w(s,1)):(s=Va(o),s.c(),w(s,1),s.m(e.parentNode,e)):s&&(pe(),P(s,1,1,()=>{s=null}),ge())},i(o){n||(w(s),n=!0)},o(o){P(s),n=!1},d(o){s&&s.d(o),o&&T(e),r=!1,Re(i)}}}function ih(t,e,n){let{$$slots:r={},$$scope:i}=e,{show:s=!1}=e,{popup:o=!1}=e,{closeButton:a=!1}=e,{backButton:l=!1}=e,{parentPosition:c=void 0}=e,{alignTo:u=""}=e,{modalWidth:d=""}=e;const f=St();let h="100%",g;function p(){g&&n(7,h=`${g.getBoundingClientRect().height}px`)}hn(()=>{p()});const _=()=>{n(0,s=!1),o||Wa(),f("close")},v=()=>{_()},m=I=>{I.stopPropagation()},C=I=>{I.key==="Escape"&&_()};function y(I){Tr.call(this,t,I)}function S(I){Et[I?"unshift":"push"](()=>{g=I,n(8,g)})}return t.$$set=I=>{"show"in I&&n(0,s=I.show),"popup"in I&&n(1,o=I.popup),"closeButton"in I&&n(2,a=I.closeButton),"backButton"in I&&n(3,l=I.backButton),"parentPosition"in I&&n(4,c=I.parentPosition),"alignTo"in I&&n(5,u=I.alignTo),"modalWidth"in I&&n(6,d=I.modalWidth),"$$scope"in I&&n(14,i=I.$$scope)},t.$$.update=()=>{t.$$.dirty&3&&(o||(s?eh():Wa()))},[s,o,a,l,c,u,d,h,g,p,_,v,m,C,i,r,y,S]}class sh extends $e{constructor(e){super(),Oe(this,e,ih,rh,Pe,{show:0,popup:1,closeButton:2,backButton:3,parentPosition:4,alignTo:5,modalWidth:6},nh)}}const ji={type:"answer",text:"",id:""},at=new Dt({chat:[],currentQuestion:"",currentAnswer:ji,isStreaming:!1}),oh=at.writer(t=>t.currentQuestion,(t,e)=>({...t,currentQuestion:e.question,chat:e.reset?[]:t.chat,isStreaming:!0,error:void 0})),ah=at.writer(t=>t.currentAnswer,(t,e)=>(Qn.set(!0),{...t,currentAnswer:{...t.currentAnswer,...e},isStreaming:!0})),lh=at.reader(t=>{var e;return t.chat.length===0&&t.isStreaming?{...t.currentAnswer,incomplete:!0}:((e=t.chat[0])==null?void 0:e.answer)||ji});at.reader(t=>t.chat.length>0&&!t.isStreaming?t.chat[t.chat.length-1].answer:void 0);const yr=at.writer(t=>t.isStreaming?[...t.chat,{question:t.currentQuestion,answer:{...t.currentAnswer,incomplete:!0}}]:t.chat,(t,e)=>({...t,chat:[...t.chat,{question:e.question,answer:e.answer}],currentQuestion:"",currentAnswer:ji,isStreaming:!1}));at.writer(()=>{},t=>({...t,chat:t.chat.slice(0,1)})),at.reader(t=>t.isStreaming);const ch=at.reader(t=>!!t.error&&t.error.status===529),Ja=at.writer(t=>t.error,(t,e)=>(Qn.set(!0),{...t,error:e})),Mi=new Dt({labelSets:{}});Mi.writer(t=>t.labelSets,(t,e)=>({...t,labelSets:e})),Mi.reader(t=>Object.entries(t.labelSets).map(([e,n])=>({...n,id:e})).sort((e,n)=>e.title.localeCompare(n.title)));const un=new Dt({query:""});un.writer(t=>t.query,(t,e)=>({...t,query:e})),un.writer(t=>t.selectedNode,(t,e)=>({...t,selectedNode:e,query:(e==null?void 0:e.ner)||""})),un.writer(t=>(t.selectedNodeEdges||[]).sort((e,n)=>e.relevance<n.relevance?1:e.relevance>n.relevance?-1:0),(t,e)=>({...t,selectedNodeEdges:e,selectedNodeResults:void 0})),un.writer(t=>t.selectedNodeResults,(t,e)=>({...t,selectedNodeResults:e})),un.reader(t=>t.selectedNodeResults||[]);const Ct=yn(null);Ct.pipe(E(t=>t?Object.entries(t.getAnnotatedEntities()).length>0:!1)),Ct.pipe(E(t=>t?t.getClassifications():[])),Ct.pipe(E(t=>t?t.summary?[t.summary].concat(t.getExtractedSummaries()):t.getExtractedSummaries():[]),E(t=>t.filter(e=>!!e))),Ct.pipe(z(t=>t?Vf(t.getFiles().reduce((e,n)=>n.uri?e.concat(n.uri):e,[])):B([]))),Ct.pipe(E(t=>t?t.getFields(["links"]).map(e=>{var n;return(n=e.value)==null?void 0:n.uri}).filter(e=>!!e):[])),Ct.pipe(E(t=>t?t.getFields(["links"]).filter(e=>!uh(e)).map(e=>{var n,r;return(r=(n=e.extracted)==null?void 0:n.link)==null?void 0:r.link_preview}).filter(e=>!!e):[]));function uh(t){var e;return(e=t.value)!=null&&e.uri?vu(t.value.uri):!1}const Ka=new Dt({entities:[]});Ka.writer(t=>t.entities,(t,e)=>({...t,entities:e}));const Ni=yn([]),dh=yn("");tt([Ni,dh]).pipe(E(([t,e])=>t.find(n=>n.id===e))),tt([Ct,Ni,xt.pipe(se(1))]).pipe(E(([t,e,n])=>t?Qa(t.getNamedEntities(),e,n):[])),tt([Ct,Ni,xt.pipe(se(1))]).pipe(E(([t,e,n])=>t?Qa(t.getAnnotatedEntities(),e,n):[]));function Qa(t,e,n=r=>r){return Object.entries(t).map(([r,i])=>{const s=e.find(l=>l.id===r),o=_u[r],a=(s==null?void 0:s.title)||(o?`entities.${r.toLowerCase()}`:r);return{id:r,title:a,color:(s==null?void 0:s.color)||o,entities:i.filter(l=>!!l).sort((l,c)=>l.localeCompare(c))}}).sort((r,i)=>n(r.title).localeCompare(n(i.title)))}const br=[];function fh(){br.forEach(t=>t.unsubscribe())}const hh=t=>{br.push(vt.pipe(z(e=>Yn.pipe(se(1),le(n=>!n),z(()=>Ut.pipe(se(1))),qe(n=>t?t("search",n):void 0),qe(()=>{e!=null&&e.more||(td.set(0),yo.set(Date.now()),Kn.set({results:so,append:!1}))}),z(n=>qn([ao.pipe(se(1)),vo.pipe(se(1)),Xu.pipe(se(1)),Xn.pipe(se(1)),ko.pipe(se(1)),_o.pipe(se(1)),bn.pipe(se(1))]).pipe(qe(([r])=>{r||Zn.set(!0)}),z(([r,i,s,o,a,l,c])=>{const u={...i,show:s,filters:o,inTitleOnly:a,...l?{autofilter:!1}:{}};return c&&!(e!=null&&e.more)?Xa(n,!0,u).pipe(qe(d=>{d.type==="error"&&d.status===402&&!r&&(Iu(),vt.next())}),le(d=>d.type!=="error"),E(d=>d),At((d,f)=>d.sources===f.sources),E(d=>({results:d.sources,append:!1,onlyAnswers:r,loadingMore:!1,options:u}))):zf(n,u).pipe(E(d=>({results:d,append:!!(e!=null&&e.more),onlyAnswers:r,loadingMore:e==null?void 0:e.more,options:u})))})))))).subscribe(({results:e,append:n,onlyAnswers:r,loadingMore:i,options:s})=>{e&&e.total===0&&s.autofilter&&(e.autofilters||[]).length>0?(_o.set(!0),vt.next(i?{more:!0}:void 0)):e&&(bn&&!i?r||(Zr.set(e.searchId),Kn.set({results:e,append:!1})):(n||Zr.set(e.searchId),Kn.set({results:e,append:n})),bo.set(!0))})),typeof t=="function"&&br.push(Kn.subscribe(e=>t("results",e))),br.push(mo.pipe(le(e=>!!e),At()).subscribe(()=>{vt.next({more:!0})}))},Pn=[];function ph(){Pn.forEach(t=>t.unsubscribe()),fh(),at.reset(),Ka.reset(),un.reset(),Mi.reset(),X.reset(),gt.reset(),ee.reset()}function gh(){const t=lo.pipe(z(()=>sn.pipe(se(1)))),e=$s(t.pipe(le(n=>!!n&&n.slice(-1)===" "&&n.slice(-2,-1)!==" ")),t.pipe(js(350))).pipe(At((n,r)=>n===r),z(n=>{var i;if(!n||n.length<=2)return B({results:Xr});const r=(i=Me.getValue())!=null&&i.suggestLabels?[za(n),Bf(n)]:[za(n),B([])];return qn(r).pipe(E(([s,o])=>({results:s.type!=="error"?s:Xr,labels:o})))})).subscribe(n=>xu.set(n));Pn.push(e)}const Li=Gn("query"),wr=Gn("filter"),kr=Gn("titleOnly"),zi=Gn("preview"),vh=new zt;function _h(){Pn.push(vh.pipe(At(),z(({question:t,reset:e})=>Xa(t,e))).subscribe())}function mh(){yh();const t=[vt.pipe(z(()=>Yn.pipe(se(1))),le(e=>!e),z(()=>tt([Ut,Xn,ko]).pipe(se(1)))).subscribe(([e,n,r])=>{const i=mn();i.set(Li,e),i.delete(wr),i.delete(kr),n.forEach(s=>i.append(wr,s)),i.append(kr,`${r}`),Jn(i)}),Yn.pipe(At(),Ns(1),le(e=>e)).subscribe(()=>{const e=mn();e.delete(Li),e.delete(wr),e.delete(kr),Jn(e)}),$a.pipe(At(),le(e=>!!e.fieldFullId)).subscribe(e=>{var s,o,a;const n=`${(s=e.fieldFullId)==null?void 0:s.resourceId}|${(o=e.fieldFullId)==null?void 0:o.field_type}|${(a=e.fieldFullId)==null?void 0:a.field_id}`,r=`${e.selectedParagraphIndex}`,i=mn();i.set(zi,`${n}|${r}`),Jn(i)}),jf.pipe(At(),le(e=>!e)).subscribe(()=>{const e=mn();e.delete(zi),Jn(e)})];Pn.push(...t)}function yh(){const t=mn(),e=t.get(Li),n=t.get(kr)==="true",r=t.getAll(wr);(e||r.length>0)&&(Ut.set(e||""),Xn.set({filters:r,titleOnly:n}),sn.set(e||""),vt.next());const i=t.get(zi);if(i){const[s,o,a,l]=i.split("|"),c=Jr(o);s&&c&&a&&Yr.pipe(se(1),z(u=>{if(u.length>0){const d=u.find(f=>{var h;return f.id===s&&((h=f.field)==null?void 0:h.field_id)===a&&f.field.field_type===c});return B(d)}else return Da(s,[q.BASIC,q.ORIGIN,q.VALUES]).pipe(E(d=>{const f={field_id:a,field_type:c},h={...d,field:f,fieldData:Eo(d,f)},{resultType:g,resultIcon:p}=Io(h);return{...h,resultType:g,resultIcon:p}}))})).subscribe(u=>{const d=l!=="null"?parseInt(l,10):-1;u&&$a.set({result:u,selectedParagraphIndex:d})})}}function Xa(t,e,n={}){return B({question:t,reset:e}).pipe(qe(r=>oh.set(r)),z(({question:r})=>yr.pipe(se(1),E(i=>i.filter(s=>!s.answer.incomplete)),z(i=>Xn.pipe(se(1),z(s=>Df(r,i,{...n,filters:s}).pipe(qe(o=>{o.type==="error"?Ja.set(o):o.incomplete?ah.set(o):yr.set({question:r,answer:o})}))))))))}function bh(){Pn.push(wo.pipe(At(),le(t=>Object.keys(t).length>0)).subscribe(t=>Ca("engage",{...t})))}const Hp="";function wh(t){De(t,"svelte-12v6qxf",".sw-suggestions.svelte-12v6qxf.svelte-12v6qxf{--suggestion-side-padding:var(--rhythm-3);background:var(--dropdown-background-color)}.sw-suggestions.svelte-12v6qxf .error-message.svelte-12v6qxf{padding:0 var(--rhythm-2)}.sw-suggestions.svelte-12v6qxf section.svelte-12v6qxf{padding:var(--rhythm-2) var(--suggestion-side-padding)}.sw-suggestions.svelte-12v6qxf section.svelte-12v6qxf:not(:last-of-type){border-bottom:1px solid var(--color-neutral-light)}.sw-suggestions.svelte-12v6qxf .paragraph.svelte-12v6qxf{cursor:pointer;font-size:var(--font-size-base);line-height:var(--line-height-body-s);margin:0 calc(var(--suggestion-side-padding) * -1);padding:var(--rhythm-1) var(--suggestion-side-padding)}.sw-suggestions.svelte-12v6qxf .paragraph.svelte-12v6qxf:hover,.sw-suggestions.svelte-12v6qxf .paragraph.svelte-12v6qxf:focus{background-color:var(--hover-background-color);outline:0}")}function Ya(t,e,n){const r=t.slice();return r[7]=e[n],r}function kh(t){let e,n,r=t[0].slice(0,4),i=[];for(let s=0;s<r.length;s+=1)i[s]=Za(Ya(t,r,s));return{c(){e=k("section"),n=k("div");for(let s=0;s<i.length;s+=1)i[s].c();b(e,"class","svelte-12v6qxf")},m(s,o){R(s,e,o),x(e,n);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(n,null)},p(s,o){if(o&17){r=s[0].slice(0,4);let a;for(a=0;a<r.length;a+=1){const l=Ya(s,r,a);i[a]?i[a].p(l,o):(i[a]=Za(l),i[a].c(),i[a].m(n,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=r.length}},d(s){s&&T(e),Fn(i,s)}}}function Sh(t){let e;function n(s,o){return s[2].status===402?Ah:Eh}let r=n(t),i=r(t);return{c(){e=k("div"),i.c(),b(e,"class","error-message svelte-12v6qxf")},m(s,o){R(s,e,o),i.m(e,null)},p(s,o){r===(r=n(s))&&i?i.p(s,o):(i.d(1),i=r(s),i&&(i.c(),i.m(e,null)))},d(s){s&&T(e),i.d()}}}function Za(t){let e,n=t[7].text+"",r,i,s,o;function a(){return t[5](t[7])}function l(...c){return t[6](t[7],...c)}return{c(){e=k("div"),r=de(n),i=K(),b(e,"class","paragraph svelte-12v6qxf"),b(e,"tabindex","0")},m(c,u){R(c,e,u),x(e,r),x(e,i),s||(o=[V(e,"click",Ml(a)),V(e,"keyup",l)],s=!0)},p(c,u){t=c,u&1&&n!==(n=t[7].text+"")&&we(r,n)},d(c){c&&T(e),s=!1,Re(o)}}}function Eh(t){let e,n=t[3]("error.search")+"",r;return{c(){e=k("strong"),r=de(n)},m(i,s){R(i,e,s),x(e,r)},p(i,s){s&8&&n!==(n=i[3]("error.search")+"")&&we(r,n)},d(i){i&&T(e)}}}function Ah(t){let e,n=t[3]("error.feature-blocked")+"",r;return{c(){e=k("p"),r=de(n)},m(i,s){R(i,e,s),x(e,r)},p(i,s){s&8&&n!==(n=i[3]("error.feature-blocked")+"")&&we(r,n)},d(i){i&&T(e)}}}function Ih(t){let e;function n(s,o){if(s[1])return Sh;if(s[0].length>0)return kh}let r=n(t),i=r&&r(t);return{c(){e=k("div"),i&&i.c(),b(e,"class","sw-suggestions svelte-12v6qxf")},m(s,o){R(s,e,o),i&&i.m(e,null)},p(s,[o]){r===(r=n(s))&&i?i.p(s,o):(i&&i.d(1),i=r&&r(s),i&&(i.c(),i.m(e,null)))},i:L,o:L,d(s){s&&T(e),i&&i.d()}}}function xh(t,e,n){let r,i,s;U(t,uo,u=>n(1,r=u)),U(t,co,u=>n(2,i=u)),U(t,xt,u=>n(3,s=u));let{paragraphs:o=[]}=e;const a=u=>{Da(u.rid,[q.BASIC,q.ORIGIN,q.VALUES]).subscribe(d=>{var f,h,g,p,_,v;(f=d.origin)!=null&&f.url?Kr(d.origin.url):(_=(p=(g=(h=d.data)==null?void 0:h.links)==null?void 0:g.link)==null?void 0:p.value)!=null&&_.uri?Kr((v=d.data)==null?void 0:v.links.link.value.uri):console.log(d.data)})},l=u=>a(u),c=(u,d)=>{d.key==="Enter"&&a(u)};return t.$$set=u=>{"paragraphs"in u&&n(0,o=u.paragraphs)},[o,r,i,s,a,l,c]}class Th extends $e{constructor(e){super(),Oe(this,e,xh,Ih,Pe,{paragraphs:0},wh)}}const Wp="";function Rh(t){De(t,"svelte-1t3kt48",".sw-button.svelte-1t3kt48{background:var(--button-background-color);border:none;border-radius:var(--border-radius);color:var(--button-color);display:inline-flex;font-family:inherit;font-size:var(--font-size-base);justify-content:center;line-height:var(--line-height-body);margin:0;outline:0;padding:var(--rhythm-1) var(--rhythm-2);transition:background-color var(--transition-superfast), box-shadow var(--transition-superfast), color var(--transition-superfast);white-space:nowrap}.sw-button.svelte-1t3kt48:focus-visible{box-shadow:var(--focus-shadow);outline:0}.sw-button.icon.svelte-1t3kt48{border-radius:50%;padding:var(--rhythm-1)}.sw-button.svelte-1t3kt48:not(:disabled){cursor:pointer}.sw-button.svelte-1t3kt48:not(:disabled):hover{background:var(--button-background-color-hover);color:var(--button-color-hover)}.sw-button.svelte-1t3kt48:not(:disabled):active,.sw-button:not(:disabled).active.svelte-1t3kt48{background:var(--button-background-color-active);color:var(--button-color-active)}.sw-button.svelte-1t3kt48:not(.small):not(.xsmall):not(.icon){min-width:var(--rhythm-12)}.sw-button.small.svelte-1t3kt48:not(.icon),.sw-button.xsmall.svelte-1t3kt48:not(.icon){font-size:calc(var(--font-size-base) * 0.75);line-height:var(--rhythm-3);padding:var(--rhythm-0_5) var(--rhythm-2)}.sw-button.xsmall.icon.svelte-1t3kt48,.sw-button.small.icon.svelte-1t3kt48{padding:var(--rhythm-0_5)}.sw-button.large.svelte-1t3kt48{padding:var(--rhythm-1_5)}.sw-button.solid.primary.svelte-1t3kt48{--button-background-color:var(--color-primary-regular);--button-background-color-hover:var(--color-primary-strong);--button-background-color-active:var(--color-primary-stronger);--button-color:var(--color-light-stronger);--button-color-hover:var(--color-light-stronger);--button-color-active:var(--color-light-stronger)}.sw-button.solid.secondary.svelte-1t3kt48{--button-background-color:var(--color-dark-stronger);--button-background-color-hover:var(--color-dark-stronger);--button-background-color-active:var(--color-neutral-light);--button-color:var(--color-light-stronger);--button-color-hover:var(--color-light-stronger);--button-color-active:var(--color-light-stronger)}.sw-button.solid.svelte-1t3kt48:disabled{--button-background-color:var(--color-neutral-lighter);--button-color:var(--color-light-stronger)}.sw-button.basic.primary.svelte-1t3kt48{--button-background-color:transparent;--button-background-color-hover:var(--color-primary-lightest);--button-background-color-active:var(--color-primary-lighter);--button-color:var(--color-primary-regular);--button-color-hover:var(--color-primary-regular);--button-color-active:var(--color-primary-regular)}.sw-button.basic.secondary.svelte-1t3kt48{--button-background-color:transparent;--button-background-color-hover:var(--color-neutral-light);--button-background-color-active:var(--color-neutral-regular);--button-color:inherit;--button-color-hover:inherit;--button-color-active:var(--color-light-stronger)}.sw-button.basic.svelte-1t3kt48:disabled{--button-color:var(--color-neutral-light)}")}function Ph(t){let e,n,r,i,s,o;return n=new Ba({props:{name:t[0],size:t[7]}}),{c(){e=k("button"),ae(n.$$.fragment),b(e,"class",r="sw-button icon "+t[2]+" "+t[3]+" "+t[4]+" svelte-1t3kt48"),b(e,"type","button"),b(e,"aria-label",t[1]),b(e,"tabindex","0"),e.disabled=t[5],G(e,"active",t[6])},m(a,l){R(a,e,l),ie(n,e,null),i=!0,s||(o=[V(e,"click",t[9]),V(e,"keyup",t[8])],s=!0)},p(a,[l]){const c={};l&1&&(c.name=a[0]),l&128&&(c.size=a[7]),n.$set(c),(!i||l&28&&r!==(r="sw-button icon "+a[2]+" "+a[3]+" "+a[4]+" svelte-1t3kt48"))&&b(e,"class",r),(!i||l&2)&&b(e,"aria-label",a[1]),(!i||l&32)&&(e.disabled=a[5]),(!i||l&92)&&G(e,"active",a[6])},i(a){i||(w(n.$$.fragment,a),i=!0)},o(a){P(n.$$.fragment,a),i=!1},d(a){a&&T(e),te(n),s=!1,Re(o)}}}function Oh(t,e,n){let r,{icon:i=""}=e,{ariaLabel:s=""}=e,{aspect:o="solid"}=e,{kind:a="secondary"}=e,{size:l="medium"}=e,{disabled:c=!1}=e,{active:u=!1}=e;const d=St();function f(g){g.key==="Enter"&&d("enter")}function h(g){Tr.call(this,t,g)}return t.$$set=g=>{"icon"in g&&n(0,i=g.icon),"ariaLabel"in g&&n(1,s=g.ariaLabel),"aspect"in g&&n(2,o=g.aspect),"kind"in g&&n(3,a=g.kind),"size"in g&&n(4,l=g.size),"disabled"in g&&n(5,c=g.disabled),"active"in g&&n(6,u=g.active)},t.$$.update=()=>{t.$$.dirty&16&&n(7,r=l==="xsmall"?"small":"medium")},[i,s,o,a,l,c,u,r,f,h]}class Sr extends $e{constructor(e){super(),Oe(this,e,Oh,Ph,Pe,{icon:0,ariaLabel:1,aspect:2,kind:3,size:4,disabled:5,active:6},Rh)}}const Vp="";function Fh(t){De(t,"svelte-kh2ok6",".sw-search-input.svelte-kh2ok6.svelte-kh2ok6{display:flex;flex-direction:column;position:relative}.sw-search-input.svelte-kh2ok6 .input-container.svelte-kh2ok6{align-items:center;box-sizing:border-box;display:flex;flex:1 0 auto;position:relative}.sw-search-input.svelte-kh2ok6 input.svelte-kh2ok6{background-color:inherit;border:0;box-sizing:border-box;color:inherit;font-family:inherit;font-size:var(--font-size-base);font-weight:var(--font-weight-body);line-height:calc(var(--line-height-body) * 1.5);outline:none;text-overflow:ellipsis;width:100%;-webkit-appearance:none}.sw-search-input.svelte-kh2ok6 input.svelte-kh2ok6::placeholder{color:var(--color-neutral-regular);transition:all 0s ease}.sw-search-input.search-bar-widget.svelte-kh2ok6.svelte-kh2ok6{height:var(--rhythm-6)}.sw-search-input.search-bar-widget.svelte-kh2ok6 .input-container.svelte-kh2ok6{padding-left:var(--rhythm-5);padding-right:var(--rhythm-1)}.sw-search-input.svelte-kh2ok6 .search-icon-container.svelte-kh2ok6{left:var(--rhythm-0_5);position:absolute;top:50%;transform:translateY(-50%)}.sw-search-input.svelte-kh2ok6 .search-icon-container .search-icon.svelte-kh2ok6{display:flex;padding:var(--rhythm-1_5) var(--rhythm-0_5)}")}function Ch(t){let e,n,r;return n=new Ba({props:{name:"search"}}),{c(){e=k("div"),ae(n.$$.fragment),b(e,"class","search-icon svelte-kh2ok6")},m(i,s){R(i,e,s),ie(n,e,null),r=!0},p:L,i(i){r||(w(n.$$.fragment,i),r=!0)},o(i){P(n.$$.fragment,i),r=!1},d(i){i&&T(e),te(n)}}}function $h(t){let e,n;return e=new Sr({props:{aspect:"basic",icon:"cross",ariaLabel:t[6]("input.clear"),size:"small"}}),e.$on("click",t[15]),e.$on("enter",t[15]),{c(){ae(e.$$.fragment)},m(r,i){ie(e,r,i),n=!0},p(r,i){const s={};i&64&&(s.ariaLabel=r[6]("input.clear")),e.$set(s)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function jh(t){let e,n,r;return n=new Th({props:{paragraphs:t[10]}}),n.$on("search",t[20]),{c(){e=k("div"),ae(n.$$.fragment),b(e,"class","sw-suggestions-container")},m(i,s){R(i,e,s),ie(n,e,null),r=!0},p(i,s){const o={};s&1024&&(o.paragraphs=i[10]),n.$set(o)},i(i){r||(w(n.$$.fragment,i),r=!0)},o(i){P(n.$$.fragment,i),r=!1},d(i){i&&T(e),te(n)}}}function Mh(t){let e,n,r,i,s,o,a,l,c,u,d,f,h;const g=[$h,Ch],p=[];function _(v,m){return v[5].length>0?0:1}return i=_(t),s=p[i]=g[i](t),u=new sh({props:{show:t[3]&&(t[8]||t[9]),popup:!0,parentPosition:t[2],modalWidth:t[4],$$slots:{default:[jh]},$$scope:{ctx:t}}}),u.$on("close",t[14]),{c(){e=k("form"),n=k("div"),r=k("div"),s.c(),o=K(),a=k("input"),c=K(),ae(u.$$.fragment),b(r,"class","search-icon-container svelte-kh2ok6"),b(a,"class","search-field svelte-kh2ok6"),b(a,"name","nuclia-search-field"),b(a,"placeholder",l=t[6](t[7])),b(a,"tabindex","0"),b(a,"autocomplete","off"),b(a,"autocapitalize","off"),b(a,"spellcheck","false"),b(a,"aria-label","Search input"),b(n,"class","input-container svelte-kh2ok6"),b(e,"role","search"),b(e,"autocomplete","off"),b(e,"class","sw-search-input search-bar-widget svelte-kh2ok6")},m(v,m){R(v,e,m),x(e,n),x(n,r),p[i].m(r,null),x(n,o),x(n,a),t[16](a),Qi(a,t[5]),t[19](e),R(v,c,m),ie(u,v,m),d=!0,f||(h=[V(window,"resize",t[11]),V(a,"input",t[17]),V(a,"input",t[18]),V(a,"keypress",t[13])],f=!0)},p(v,[m]){let C=i;i=_(v),i===C?p[i].p(v,m):(pe(),P(p[C],1,1,()=>{p[C]=null}),ge(),s=p[i],s?s.p(v,m):(s=p[i]=g[i](v),s.c()),w(s,1),s.m(r,null)),(!d||m&192&&l!==(l=v[6](v[7])))&&b(a,"placeholder",l),m&32&&a.value!==v[5]&&Qi(a,v[5]);const y={};m&776&&(y.show=v[3]&&(v[8]||v[9])),m&4&&(y.parentPosition=v[2]),m&16&&(y.modalWidth=v[4]),m&4195328&&(y.$$scope={dirty:m,ctx:v}),u.$set(y)},i(v){d||(w(s),w(u.$$.fragment,v),d=!0)},o(v){P(s),P(u.$$.fragment,v),d=!1},d(v){v&&T(e),p[i].d(),t[16](null),t[19](null),v&&T(c),te(u,v),f=!1,Re(h)}}}function Nh(t,e,n){let r,i,s,o,a,l;U(t,sn,j=>n(5,r=j)),U(t,xt,j=>n(6,i=j)),U(t,oo,j=>n(7,s=j)),U(t,Pu,j=>n(8,o=j)),U(t,uo,j=>n(9,a=j)),U(t,fo,j=>n(10,l=j));let c;const u=St();let d,f,h=!1,g;hn(()=>{c==null||c.focus()});const p=()=>{d&&n(2,f=d.getBoundingClientRect())},_=()=>{Ut.set(sn.getValue()),vt.next(),u("search"),c.blur()},v=j=>{j.key==="Enter"?(j.preventDefault(),_(),n(3,h=!1)):(n(3,h=!0),p())},m=()=>{n(3,h=!1)};function C(){gt.reset(),Ut.set("")}function y(j){Et[j?"unshift":"push"](()=>{c=j,n(1,c)})}function S(){r=this.value,sn.set(r)}const I=()=>lo.next();function $(j){Et[j?"unshift":"push"](()=>{d=j,n(0,d)})}const O=()=>_();return t.$$.update=()=>{t.$$.dirty&1&&d&&n(4,g=`${d.offsetWidth}px`)},[d,c,f,h,g,r,i,s,o,a,l,p,_,v,m,C,y,S,I,$,O]}class Lh extends $e{constructor(e){super(),Oe(this,e,Nh,Mh,Pe,{},Fh)}}const zh=`a{color:var(--link-color)}mark{background-color:inherit;color:inherit;font-weight:var(--font-weight-medium)}mark[family]{background-color:var(--color-neutral-lighter);cursor:pointer;font-weight:var(--font-weight-body);padding:0 var(--rhythm-0_5)}mark.ner[family]{cursor:auto;padding:0;background-color:transparent}.ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.highlight{background-color:var(--selected-background-color);color:var(--selected-text-color);border-radius:0}.sr-only{position:absolute;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}[tabindex="-1"]:focus{outline:0!important}:focus:not(:focus-visible){outline:none}.sw-dropdown ul{list-style:none;margin:0;max-height:var(--rhythm-32);overflow-x:hidden;overflow-y:auto;padding-left:0}ul.sw-dropdown-options li{cursor:pointer;line-height:var(--rhythm-5);padding:0 var(--rhythm-2)}ul.sw-dropdown-options li:hover{background-color:var(--hover-background-color)}ul.sw-dropdown-options li.selected{background-color:var(--selected-background-color);color:var(--selected-text-color)}.sw-dropdown-options .filter-option{align-items:center;display:flex;flex-direction:row;gap:var(--rhythm-1);justify-content:space-between}.sw-dropdown-options .filter-option .filter-title{flex:1 1 0}.sw-dropdown-options .filter-option .filter-color{flex:0 0 auto;height:var(--rhythm-1);width:var(--rhythm-1)}.sw-text-rendering{background:var(--container-background-color);margin:0 auto;max-width:800px;padding:var(--rhythm-1) var(--rhythm-2)}.sw-text-rendering p{padding:var(--rhythm-1) var(--rhythm-2)}.external-html-content p{margin-top:0}.external-html-content p:last-child{margin-bottom:0}.external-html-content h1,.external-html-content h2,.external-html-content h3,.external-html-content h4,.external-html-content h5,.external-html-content h6{line-height:100%}.external-html-content h1:first-child,.external-html-content h2:first-child,.external-html-content h3:first-child,.external-html-content h4:first-child,.external-html-content h5:first-child,.external-html-content h6:first-child{margin-top:0}.sw-paragraphs-container{display:flex;flex-direction:column;gap:var(--paragraph-gap);list-style:none;margin:0;padding:0}.title-m{font-size:var(--font-size-title-m);font-weight:var(--font-weight-title-m);line-height:var(--line-height-title-m)}.title-xs{font-size:var(--font-size-medium);font-weight:var(--font-weight-semi-bold);line-height:var(--line-height-title-xs)}.title-xxs{font-size:var(--font-size-small);font-weight:var(--font-weight-semi-bold);line-height:var(--line-height-title-xxs)}.title-s{font-size:var(--font-size-medium);font-weight:var(--font-weight-semi-bold);line-height:var(--line-height-title-s)}.body-m{font-size:var(--font-size-medium);font-weight:var(--font-weight-body);line-height:var(--line-height-body)}.body-s{font-size:var(--font-size-small);font-weight:var(--font-weight-body);line-height:var(--line-height-body)}.body-xs{font-size:var(--font-size-xsmall);font-weight:var(--font-weight-body);line-height:var(--line-height-body-xs)}pre>code{white-space:pre-wrap}
`,Gp="";function Dh(t){De(t,"svelte-1uw97is",".sw-loading-dots.svelte-1uw97is.svelte-1uw97is{align-content:center;display:flex;gap:var(--rhythm-1);justify-content:center}.sw-loading-dots.svelte-1uw97is.svelte-1uw97is:not(.small){margin:var(--rhythm-12) auto;text-align:center}.sw-loading-dots.svelte-1uw97is>div.svelte-1uw97is{width:var(--rhythm-2);height:var(--rhythm-2);background-color:var(--color-primary-regular);border-radius:100%;display:inline-block;-webkit-animation:svelte-1uw97is-sk-bouncedelay 1.4s infinite ease-in-out both;animation:svelte-1uw97is-sk-bouncedelay 1.4s infinite ease-in-out both}.sw-loading-dots.small.svelte-1uw97is.svelte-1uw97is{gap:var(--rhythm-0_5)}.sw-loading-dots.small.svelte-1uw97is>div.svelte-1uw97is{width:calc(var(--rhythm-0_5) + var(--rhythm-0_25));height:calc(var(--rhythm-0_5) + var(--rhythm-0_25))}.sw-loading-dots.svelte-1uw97is .bounce1.svelte-1uw97is{-webkit-animation-delay:-0.32s;animation-delay:-0.32s}.sw-loading-dots.svelte-1uw97is .bounce2.svelte-1uw97is{-webkit-animation-delay:-0.16s;animation-delay:-0.16s}@-webkit-keyframes svelte-1uw97is-sk-bouncedelay{0%,80%,100%{-webkit-transform:scale(0)}40%{-webkit-transform:scale(1)}}@keyframes svelte-1uw97is-sk-bouncedelay{0%,80%,100%{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}")}function Uh(t){let e,n,r;return{c(){e=k("div"),e.textContent="Loading",n=K(),r=k("div"),r.innerHTML=`<div class="bounce1 svelte-1uw97is"></div> 
  <div class="bounce2 svelte-1uw97is"></div> 
  <div class="bounce3 svelte-1uw97is"></div>`,b(e,"class","sr-only"),b(r,"class","sw-loading-dots svelte-1uw97is"),G(r,"small",t[0])},m(i,s){R(i,e,s),R(i,n,s),R(i,r,s)},p(i,[s]){s&1&&G(r,"small",i[0])},i:L,o:L,d(i){i&&T(e),i&&T(n),i&&T(r)}}}function Bh(t,e,n){let{small:r=!1}=e;return t.$$set=i=>{"small"in i&&n(0,r=i.small)},[r]}class qh extends $e{constructor(e){super(),Oe(this,e,Bh,Uh,Pe,{small:0},Dh)}}const Jp="",Kp="";function Hh(t){De(t,"svelte-p0cmbw",".sw-expander.svelte-p0cmbw .expander-content.svelte-p0cmbw{overflow:hidden}.sw-expander.svelte-p0cmbw .header.svelte-p0cmbw{align-items:center;cursor:pointer;display:flex;gap:var(--rhythm-0_5)}.sw-expander.svelte-p0cmbw .header .expander-icon.svelte-p0cmbw{transition:transform var(--transition-superfast)}.sw-expander.svelte-p0cmbw .header.expanded .expander-icon.svelte-p0cmbw{transform:rotate(90deg)}")}const Wh=t=>({}),el=t=>({});function Vh(t){let e,n,r,i,s,o,a,l,c=`${t[4]}px`,u,d,f;i=new Sr({props:{icon:"chevron-right",size:"small",aspect:"basic"}});const h=t[6].header,g=Er(h,t,t[5],el),p=t[6].default,_=Er(p,t,t[5],null);return{c(){e=k("div"),n=k("div"),r=k("span"),ae(i.$$.fragment),s=K(),g&&g.c(),o=K(),a=k("div"),l=k("div"),_&&_.c(),b(r,"class","expander-icon svelte-p0cmbw"),b(n,"class","header svelte-p0cmbw"),G(n,"expanded",t[0]),b(a,"class","expander-content svelte-p0cmbw"),Ce(a,"height",c),Ce(a,"display",t[3]?"block":"none"),Ce(a,"transition",`height ${t[1]}ms`),b(e,"class","sw-expander svelte-p0cmbw")},m(v,m){R(v,e,m),x(e,n),x(n,r),ie(i,r,null),x(n,s),g&&g.m(n,null),x(e,o),x(e,a),x(a,l),_&&_.m(l,null),t[9](l),u=!0,d||(f=[V(n,"click",t[7]),V(n,"keypress",t[8])],d=!0)},p(v,[m]){g&&g.p&&(!u||m&32)&&Ir(g,h,v,v[5],u?Ar(h,v[5],m,Wh):xr(v[5]),el),(!u||m&1)&&G(n,"expanded",v[0]),_&&_.p&&(!u||m&32)&&Ir(_,p,v,v[5],u?Ar(p,v[5],m,null):xr(v[5]),null),m&16&&c!==(c=`${v[4]}px`)&&Ce(a,"height",c),m&8&&Ce(a,"display",v[3]?"block":"none"),m&2&&Ce(a,"transition",`height ${v[1]}ms`)},i(v){u||(w(i.$$.fragment,v),w(g,v),w(_,v),u=!0)},o(v){P(i.$$.fragment,v),P(g,v),P(_,v),u=!1},d(v){v&&T(e),te(i),g&&g.d(v),_&&_.d(v),t[9](null),d=!1,Re(f)}}}function Gh(t,e,n){let{$$slots:r={},$$scope:i}=e,{expanded:s=!1}=e,{duration:o=300}=e;const a=St();let l,c=!1,u=0;hn(()=>{const _=new ResizeObserver(v=>{v[0].contentRect.height!==u&&n(4,u=v[0].contentRect.height)});return _.observe(l),()=>{_.disconnect()}});const d=async()=>{n(3,c=!0),await ql(),n(4,u=l.getBoundingClientRect().height),setTimeout(()=>a("toggleExpander",{expanded:!0}),o)},f=()=>{n(4,u=0),setTimeout(()=>{n(3,c=!1),a("toggleExpander",{expanded:!1})},o)},h=()=>n(0,s=!s),g=_=>{_.key==="Enter"&&n(0,s=!s)};function p(_){Et[_?"unshift":"push"](()=>{l=_,n(2,l)})}return t.$$set=_=>{"expanded"in _&&n(0,s=_.expanded),"duration"in _&&n(1,o=_.duration),"$$scope"in _&&n(5,i=_.$$scope)},t.$$.update=()=>{t.$$.dirty&1&&(s?d():f())},[s,o,l,c,u,i,r,h,g,p]}class Jh extends $e{constructor(e){super(),Oe(this,e,Gh,Vh,Pe,{expanded:0,duration:1},Hh)}}function tl(t){let e,n,r,i;return e=new Sr({props:{aspect:"basic",icon:"smiley-happy",active:t[2],size:"small",kind:t[2]?"primary":"secondary"}}),e.$on("click",t[6]),r=new Sr({props:{aspect:"basic",icon:"smiley-sad",active:t[1],size:"small",kind:t[1]?"primary":"secondary"}}),r.$on("click",t[7]),{c(){ae(e.$$.fragment),n=K(),ae(r.$$.fragment)},m(s,o){ie(e,s,o),R(s,n,o),ie(r,s,o),i=!0},p(s,o){const a={};o&4&&(a.active=s[2]),o&4&&(a.kind=s[2]?"primary":"secondary"),e.$set(a);const l={};o&2&&(l.active=s[1]),o&2&&(l.kind=s[1]?"primary":"secondary"),r.$set(l)},i(s){i||(w(e.$$.fragment,s),w(r.$$.fragment,s),i=!0)},o(s){P(e.$$.fragment,s),P(r.$$.fragment,s),i=!1},d(s){te(e,s),s&&T(n),te(r,s)}}}function Kh(t){var i;let e,n,r=!((i=t[3][t[0]])!=null&&i.answer.incomplete)&&tl(t);return{c(){r&&r.c(),e=Ze()},m(s,o){r&&r.m(s,o),R(s,e,o),n=!0},p(s,[o]){var a;(a=s[3][s[0]])!=null&&a.answer.incomplete?r&&(pe(),P(r,1,1,()=>{r=null}),ge()):r?(r.p(s,o),o&9&&w(r,1)):(r=tl(s),r.c(),w(r,1),r.m(e.parentNode,e))},i(s){n||(w(r),n=!0)},o(s){P(r),n=!1},d(s){r&&r.d(s),s&&T(e)}}}function Qh(t,e,n){let r,i,s;U(t,yr,d=>n(3,s=d));let{rank:o=0}=e,a="";function l(d){yr.pipe(se(1),z(f=>Uf(f[o].answer,d))).subscribe(()=>n(5,a=d?"good":"bad"))}const c=()=>l(!0),u=()=>l(!1);return t.$$set=d=>{"rank"in d&&n(0,o=d.rank)},t.$$.update=()=>{t.$$.dirty&32&&n(2,r=a==="good"),t.$$.dirty&32&&n(1,i=a==="bad")},[o,i,r,s,l,a,c,u]}class nl extends $e{constructor(e){super(),Oe(this,e,Qh,Kh,Pe,{rank:0})}}function Xh(t){return t<448}const Qp="",Xp="",Yp="",Zp="",e1="",t1="";function Yh(t){let e;return{c(){e=k("div"),Ce(e,"width","0px")},m(n,r){R(n,e,r),t[2](e)},p:L,i:L,o:L,d(n){n&&T(e),t[2](null)}}}function Zh(t,e,n){let{hasMore:r=!0}=e;const i=St();let s=!1,o;hn(()=>{document.addEventListener("scroll",l),document.addEventListener("resize",l)});const a=u=>{const d=u.getBoundingClientRect();return d.top>=0&&d.bottom<=(window.innerHeight||document.documentElement.clientHeight)},l=()=>{o&&a(o)?(!s&&r&&i("loadMore"),s=!0):s=!1};Bl(()=>{document.removeEventListener("scroll",l,!0),document.removeEventListener("resize",l,!0)});function c(u){Et[u?"unshift":"push"](()=>{o=u,n(0,o)})}return t.$$set=u=>{"hasMore"in u&&n(1,r=u.hasMore)},[o,r,c]}class ep extends $e{constructor(e){super(),Oe(this,e,Zh,Yh,Pe,{hasMore:1})}}const n1="",r1="",i1="",s1="";function tp(t){De(t,"svelte-1g97jfd",".sw-paragraph-result.svelte-1g97jfd.svelte-1g97jfd{--expander-width:var(--rhythm-3);align-items:start;display:flex}.sw-paragraph-result.svelte-1g97jfd .paragraph-result-container.svelte-1g97jfd{display:flex;font-size:var(--font-size-medium);gap:var(--rhythm-1);line-height:var(--rhythm-2_5);transition:background-color var(--transition-superfast), color var(--transition-superfast);width:calc(100% - var(--expander-width))}.sw-paragraph-result.svelte-1g97jfd .paragraph-result-container:not(.stack).no-indicator.svelte-1g97jfd{margin-left:calc(var(--rhythm-1) * -1);padding-left:var(--rhythm-1)}.sw-paragraph-result.svelte-1g97jfd .paragraph-result-container.stack.svelte-1g97jfd{flex-direction:column;gap:var(--rhythm-0_5);padding:var(--rhythm-2)}.sw-paragraph-result.svelte-1g97jfd .paragraph-result-container.selected.svelte-1g97jfd{background:var(--selected-background-color);color:var(--selected-text-color)}.sw-paragraph-result.svelte-1g97jfd .paragraph-result-container.svelte-1g97jfd:not(.disabled){cursor:pointer}.sw-paragraph-result.svelte-1g97jfd .paragraph-result-container .paragraph-text.svelte-1g97jfd{display:-webkit-box;overflow:hidden;overflow-wrap:break-word;-webkit-line-clamp:2;-webkit-box-orient:vertical}")}function np(t){let e,n,r,i=t[0].text.trim()+"",s,o;return{c(){e=k("li"),n=k("div"),r=k("div"),b(r,"class","paragraph-text svelte-1g97jfd"),G(r,"ellipsis",t[2]),b(n,"class","paragraph-result-container svelte-1g97jfd"),G(n,"no-indicator",t[4]),G(n,"stack",t[1]),G(n,"selected",t[3]),G(n,"disabled",t[5]),b(e,"class","sw-paragraph-result svelte-1g97jfd")},m(a,l){R(a,e,l),x(e,n),x(n,r),r.innerHTML=i,t[10](r),s||(o=[V(n,"mouseenter",t[11]),V(n,"mouseleave",t[12]),V(n,"click",function(){Qt(t[5]?null:t[8])&&(t[5]?null:t[8]).apply(this,arguments)}),V(n,"keyup",t[13])],s=!0)},p(a,[l]){t=a,l&1&&i!==(i=t[0].text.trim()+"")&&(r.innerHTML=i),l&4&&G(r,"ellipsis",t[2]),l&16&&G(n,"no-indicator",t[4]),l&2&&G(n,"stack",t[1]),l&8&&G(n,"selected",t[3]),l&32&&G(n,"disabled",t[5])},i:L,o:L,d(a){a&&T(e),t[10](null),s=!1,Re(o)}}}function rp(t,e,n){let{paragraph:r}=e,{resultType:i}=e,{stack:s=!1}=e,{ellipsis:o=!1}=e,{selected:a=!1}=e,{noIndicator:l=!1}=e,{disabled:c=!1}=e,u=!1;const d=St(),f=()=>{d("open",!0)};let h;function g(m){Et[m?"unshift":"push"](()=>{h=m,n(6,h)})}const p=()=>n(7,u=!0),_=()=>n(7,u=!1),v=m=>{m.key==="Enter"&&!c&&f()};return t.$$set=m=>{"paragraph"in m&&n(0,r=m.paragraph),"resultType"in m&&n(9,i=m.resultType),"stack"in m&&n(1,s=m.stack),"ellipsis"in m&&n(2,o=m.ellipsis),"selected"in m&&n(3,a=m.selected),"noIndicator"in m&&n(4,l=m.noIndicator),"disabled"in m&&n(5,c=m.disabled)},t.$$.update=()=>{t.$$.dirty&512,t.$$.dirty&512,t.$$.dirty&64&&h&&h.offsetWidth<h.scrollWidth},[r,s,o,a,l,c,h,u,f,i,g,p,_,v]}class ip extends $e{constructor(e){super(),Oe(this,e,rp,np,Pe,{paragraph:0,resultType:9,stack:1,ellipsis:2,selected:3,noIndicator:4,disabled:5},tp)}}const o1="",a1="",l1="",c1="",u1="",d1="",f1="",h1="",{window:rl}=Ji;function sp(t){De(t,"svelte-17gdirz",".sw-result-row.svelte-17gdirz.svelte-17gdirz{--paragraph-height:var(--rhythm-4);--paragraph-gap:var(--rhythm-0_5);--expanded-paragraph-height:0px;display:flex;padding:var(--rhythm-1) var(--rhythm-3)}.sw-result-row.svelte-17gdirz .link-origin.svelte-17gdirz{text-decoration:none}.sw-result-row.svelte-17gdirz .result-container.svelte-17gdirz{flex:1 0 auto}.sw-result-row.svelte-17gdirz .result-container h3.svelte-17gdirz{margin:0}@media(max-width: 647px){.sw-result-row.svelte-17gdirz.svelte-17gdirz{flex-direction:column}}@media(min-width: 648px){.sw-result-row.svelte-17gdirz.svelte-17gdirz{--paragraph-height:var(--rhythm-3);--width-thumbnail:var(--rhythm-28);gap:var(--rhythm-2)}.sw-result-row.svelte-17gdirz .result-container.svelte-17gdirz{width:calc(100% - var(--width-thumbnail) - var(--rhythm-2))}.sw-result-row.svelte-17gdirz .result-container h3.svelte-17gdirz{cursor:pointer}}@media(hover: hover){.sw-result-row.svelte-17gdirz.svelte-17gdirz:hover{background:var(--hover-background-color)}}")}function il(t){let e,n;return e=new ip({props:{paragraph:t[2][0],resultType:t[0].resultType,noIndicator:!0}}),e.$on("open",t[7]),{c(){ae(e.$$.fragment)},m(r,i){ie(e,r,i),n=!0},p(r,i){const s={};i&4&&(s.paragraph=r[2][0]),i&1&&(s.resultType=r[0].resultType),e.$set(s)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function sl(t){let e,n=t[0].origin.url+"",r,i;return{c(){e=k("a"),r=de(n),b(e,"href",i=t[0].origin.url),b(e,"class","body-m link-origin svelte-17gdirz")},m(s,o){R(s,e,o),x(e,r)},p(s,o){o&1&&n!==(n=s[0].origin.url+"")&&we(r,n),o&1&&i!==(i=s[0].origin.url)&&b(e,"href",i)},d(s){s&&T(e)}}}function op(t){var g,p;let e,n,r,i=((g=t[0])==null?void 0:g.title)+"",s,o,a,l,c,u,d;Zt(t[4]);let f=!!t[2][0]&&il(t),h=((p=t[0].origin)==null?void 0:p.url)&&sl(t);return{c(){e=k("div"),n=k("div"),r=k("h3"),s=de(i),o=K(),a=k("div"),f&&f.c(),l=K(),h&&h.c(),b(r,"class","ellipsis title-xs svelte-17gdirz"),b(a,"tabindex","-1"),b(n,"class","result-container svelte-17gdirz"),b(e,"class","sw-result-row svelte-17gdirz")},m(_,v){R(_,e,v),x(e,n),x(n,r),x(r,s),x(n,o),x(n,a),f&&f.m(a,null),x(a,l),h&&h.m(a,null),c=!0,u||(d=[V(rl,"resize",t[4]),V(r,"click",t[5]),V(r,"keyup",t[6])],u=!0)},p(_,[v]){var m,C;(!c||v&1)&&i!==(i=((m=_[0])==null?void 0:m.title)+"")&&we(s,i),_[2][0]?f?(f.p(_,v),v&4&&w(f,1)):(f=il(_),f.c(),w(f,1),f.m(a,l)):f&&(pe(),P(f,1,1,()=>{f=null}),ge()),(C=_[0].origin)!=null&&C.url?h?h.p(_,v):(h=sl(_),h.c(),h.m(a,null)):h&&(h.d(1),h=null)},i(_){c||(w(f),c=!0)},o(_){P(f),c=!1},d(_){_&&T(e),f&&f.d(),h&&h.d(),u=!1,Re(d)}}}function ap(t,e,n){let r,{result:i}=e,s=window.innerWidth;function o(d){var f;wo.set({type:"RESULT",rid:i.id,paragraph:d}),(f=i.origin)!=null&&f.url&&Kr(i.origin.url,d==null?void 0:d.text)}function a(){n(1,s=rl.innerWidth)}const l=()=>o(),c=d=>{d.key==="Enter"&&o()},u=()=>o(r[0]);return t.$$set=d=>{"result"in d&&n(0,i=d.result)},t.$$.update=()=>{t.$$.dirty&1&&n(2,r=i.paragraphs||[])},[i,s,r,o,a,l,c,u]}class ol extends $e{constructor(e){super(),Oe(this,e,ap,op,Pe,{result:0},sp)}}const p1="",{window:al}=Ji;function lp(t){De(t,"svelte-115eemk",".sw-answer.svelte-115eemk .answer-container.svelte-115eemk{align-items:center;display:flex;gap:var(--rhythm-1);margin-top:var(--rhythm-1)}.sw-answer.svelte-115eemk .answer-container .text.svelte-115eemk{flex:1 1 auto}.sw-answer.svelte-115eemk .results.svelte-115eemk{display:flex;flex-direction:column;gap:var(--rhythm-2);width:100%}@media(min-width: 599px){}")}function ll(t,e,n){const r=t.slice();return r[14]=e[n],r}function cl(t){let e,n;return e=new nl({props:{rank:t[1]}}),{c(){ae(e.$$.fragment)},m(r,i){ie(e,r,i),n=!0},p(r,i){const s={};i&2&&(s.rank=r[1]),e.$set(s)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function ul(t){let e,n,r=!t[7]&&dl(t);return{c(){r&&r.c(),e=Ze()},m(i,s){r&&r.m(i,s),R(i,e,s),n=!0},p(i,s){i[7]?r&&(pe(),P(r,1,1,()=>{r=null}),ge()):r?(r.p(i,s),s&128&&w(r,1)):(r=dl(i),r.c(),w(r,1),r.m(e.parentNode,e))},i(i){n||(w(r),n=!0)},o(i){P(r),n=!1},d(i){r&&r.d(i),i&&T(e)}}}function dl(t){let e,n;return e=new Jh({props:{$$slots:{header:[up],default:[cp]},$$scope:{ctx:t}}}),e.$on("toggleExpander",t[11]),{c(){ae(e.$$.fragment)},m(r,i){ie(e,r,i),n=!0},p(r,i){const s={};i&131360&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function fl(t){let e,n;return e=new ol({props:{result:t[14]}}),{c(){ae(e.$$.fragment)},m(r,i){ie(e,r,i),n=!0},p:L,i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function cp(t){let e,n,r=t[9],i=[];for(let o=0;o<r.length;o+=1)i[o]=fl(ll(t,r,o));const s=o=>P(i[o],1,1,()=>{i[o]=null});return{c(){e=k("div");for(let o=0;o<i.length;o+=1)i[o].c();b(e,"class","results svelte-115eemk")},m(o,a){R(o,e,a);for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(e,null);n=!0},p(o,a){if(a&512){r=o[9];let l;for(l=0;l<r.length;l+=1){const c=ll(o,r,l);i[l]?(i[l].p(c,a),w(i[l],1)):(i[l]=fl(c),i[l].c(),w(i[l],1),i[l].m(e,null))}for(pe(),l=r.length;l<i.length;l+=1)s(l);ge()}},i(o){if(!n){for(let a=0;a<r.length;a+=1)w(i[a]);n=!0}},o(o){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)P(i[a]);n=!1},d(o){o&&T(e),Fn(i,o)}}}function up(t){let e,n=(t[5]?t[8]("answer.sources-mobile"):t[8]("answer.sources"))+"",r;return{c(){e=k("h3"),r=de(n),b(e,"class","title-xs"),b(e,"slot","header")},m(i,s){R(i,e,s),x(e,r)},p(i,s){s&288&&n!==(n=(i[5]?i[8]("answer.sources-mobile"):i[8]("answer.sources"))+"")&&we(r,n)},d(i){i&&T(e)}}}function dp(t){let e,n,r,i,s,o,a,l;Zt(t[10]);let c=!t[5]&&!t[2]&&cl(t),u=t[0].sources&&!t[6]&&ul(t);return{c(){e=k("div"),n=k("div"),r=k("div"),i=K(),c&&c.c(),s=K(),u&&u.c(),b(r,"class","text svelte-115eemk"),b(n,"class","answer-container svelte-115eemk"),b(e,"class","sw-answer svelte-115eemk")},m(d,f){R(d,e,f),x(e,n),x(n,r),r.innerHTML=t[3],x(n,i),c&&c.m(n,null),x(e,s),u&&u.m(e,null),o=!0,a||(l=V(al,"resize",t[10]),a=!0)},p(d,[f]){(!o||f&8)&&(r.innerHTML=d[3]),!d[5]&&!d[2]?c?(c.p(d,f),f&36&&w(c,1)):(c=cl(d),c.c(),w(c,1),c.m(n,null)):c&&(pe(),P(c,1,1,()=>{c=null}),ge()),d[0].sources&&!d[6]?u?(u.p(d,f),f&65&&w(u,1)):(u=ul(d),u.c(),w(u,1),u.m(e,null)):u&&(pe(),P(u,1,1,()=>{u=null}),ge())},i(d){o||(w(c),w(u),o=!0)},o(d){P(c),P(u),o=!1},d(d){d&&T(e),c&&c.d(),u&&u.d(),a=!1,l()}}}function fp(t,e,n){var _;let r,i,s,o;U(t,Au,v=>n(7,s=v)),U(t,xt,v=>n(8,o=v));let{answer:a}=e,{rank:l=0}=e,{hideFeedback:c=!1}=e,u="",d=window.innerWidth;St();const f=new RegExp(/\n/g),h=So(Object.values((_=a.sources)==null?void 0:_.resources));function g(){n(4,d=al.innerWidth)}function p(v){Tr.call(this,t,v)}return t.$$set=v=>{"answer"in v&&n(0,a=v.answer),"rank"in v&&n(1,l=v.rank),"hideFeedback"in v&&n(2,c=v.hideFeedback)},t.$$.update=()=>{var v;t.$$.dirty&1&&n(3,u=((v=a.text)==null?void 0:v.replace(f,"<br>"))||""),t.$$.dirty&8&&n(6,r=u==="Not enough data to answer this."),t.$$.dirty&16&&n(5,i=Xh(d))},[a,l,c,u,d,i,r,s,o,h,g,p]}class hp extends $e{constructor(e){super(),Oe(this,e,fp,dp,Pe,{answer:0,rank:1,hideFeedback:2},lp)}}const g1="",v1="",_1="";function pp(t){De(t,"svelte-zfi9e0",".sw-initial-answer.svelte-zfi9e0.svelte-zfi9e0{border-bottom:1px solid var(--color-neutral-light);padding:var(--rhythm-2) var(--rhythm-3);position:relative}.sw-initial-answer.svelte-zfi9e0 .container.svelte-zfi9e0{display:flex;flex-direction:column;flex-wrap:wrap}.sw-initial-answer.svelte-zfi9e0 .answer.svelte-zfi9e0{width:100%}.sw-initial-answer.svelte-zfi9e0 .actions.svelte-zfi9e0{margin-top:var(--rhythm-1)}.sw-initial-answer.svelte-zfi9e0 .actions .feedback.svelte-zfi9e0{gap:var(--rhythm-1)}")}function hl(t){let e,n,r,i;const s=[vp,gp],o=[];function a(l,c){return l[1]?0:1}return n=a(t),r=o[n]=s[n](t),{c(){e=k("div"),r.c(),b(e,"class","sw-initial-answer svelte-zfi9e0")},m(l,c){R(l,e,c),o[n].m(e,null),i=!0},p(l,c){let u=n;n=a(l),n===u?o[n].p(l,c):(pe(),P(o[u],1,1,()=>{o[u]=null}),ge(),r=o[n],r?r.p(l,c):(r=o[n]=s[n](l),r.c()),w(r,1),r.m(e,null))},i(l){i||(w(r),i=!0)},o(l){P(r),i=!1},d(l){l&&T(e),o[n].d()}}}function gp(t){let e,n,r,i,s,o,a,l;return r=new hp({props:{answer:t[0],rank:0,hideFeedback:!0}}),a=new nl({props:{rank:0}}),{c(){e=k("div"),n=k("div"),ae(r.$$.fragment),i=K(),s=k("div"),o=k("div"),ae(a.$$.fragment),b(n,"class","answer svelte-zfi9e0"),b(o,"class","feedback svelte-zfi9e0"),b(s,"class","actions svelte-zfi9e0"),b(e,"class","container svelte-zfi9e0")},m(c,u){R(c,e,u),x(e,n),ie(r,n,null),x(e,i),x(e,s),x(s,o),ie(a,o,null),l=!0},p(c,u){const d={};u&1&&(d.answer=c[0]),r.$set(d)},i(c){l||(w(r.$$.fragment,c),w(a.$$.fragment,c),l=!0)},o(c){P(r.$$.fragment,c),P(a.$$.fragment,c),l=!1},d(c){c&&T(e),te(r),te(a)}}}function vp(t){let e;function n(s,o){return s[2]?yp:s[1].status===402?mp:_p}let r=n(t),i=r(t);return{c(){i.c(),e=Ze()},m(s,o){i.m(s,o),R(s,e,o)},p(s,o){r===(r=n(s))&&i?i.p(s,o):(i.d(1),i=r(s),i&&(i.c(),i.m(e.parentNode,e)))},i:L,o:L,d(s){i.d(s),s&&T(e)}}}function _p(t){let e=t[3]("error.search")+"",n;return{c(){n=de(e)},m(r,i){R(r,n,i)},p(r,i){i&8&&e!==(e=r[3]("error.search")+"")&&we(n,e)},d(r){r&&T(n)}}}function mp(t){let e=t[3]("error.answer-feature-blocked")+"",n;return{c(){n=de(e)},m(r,i){R(r,n,i)},p(r,i){i&8&&e!==(e=r[3]("error.answer-feature-blocked")+"")&&we(n,e)},d(r){r&&T(n)}}}function yp(t){let e=t[3]("error.service-overloaded")+"",n;return{c(){n=de(e)},m(r,i){R(r,n,i)},p(r,i){i&8&&e!==(e=r[3]("error.service-overloaded")+"")&&we(n,e)},d(r){r&&T(n)}}}function bp(t){let e,n,r=(t[0].text||t[1])&&hl(t);return{c(){r&&r.c(),e=Ze()},m(i,s){r&&r.m(i,s),R(i,e,s),n=!0},p(i,[s]){i[0].text||i[1]?r?(r.p(i,s),s&3&&w(r,1)):(r=hl(i),r.c(),w(r,1),r.m(e.parentNode,e)):r&&(pe(),P(r,1,1,()=>{r=null}),ge())},i(i){n||(w(r),n=!0)},o(i){P(r),n=!1},d(i){r&&r.d(i),i&&T(e)}}}function wp(t,e,n){let r,i,s,o;return U(t,lh,a=>n(0,r=a)),U(t,Ja,a=>n(1,i=a)),U(t,ch,a=>n(2,s=a)),U(t,xt,a=>n(3,o=a)),[r,i,s,o]}class kp extends $e{constructor(e){super(),Oe(this,e,wp,bp,Pe,{},pp)}}const m1="";function Sp(t){De(t,"svelte-1w8rufs",".relations.svelte-1w8rufs.svelte-1w8rufs{display:flex;flex-direction:column;gap:var(--rhythm-5)}.relations.svelte-1w8rufs .entity.svelte-1w8rufs{display:flex;flex-direction:column;gap:var(--rhythm-1_5)}.relations.svelte-1w8rufs .entity-name.svelte-1w8rufs{font-size:var(--font-size-base);font-weight:var(--font-weight-bold)}.relations.svelte-1w8rufs .relation.svelte-1w8rufs{font-size:var(--font-size-medium)}.relations.svelte-1w8rufs .relation-name.svelte-1w8rufs{font-weight:var(--font-weight-semi-bold)}@media(min-width: 1200px){.relations.svelte-1w8rufs.svelte-1w8rufs{width:var(--rhythm-40);padding-left:var(--rhythm-2)}}")}function pl(t,e,n){const r=t.slice();return r[1]=e[n],r}function gl(t,e,n){const r=t.slice();return r[4]=e[n][0],r[5]=e[n][1],r}function vl(t){let e,n,r=t[4]+"",i,s,o,a,l=t[5].join(", ")+"",c;return{c(){e=k("div"),n=k("span"),i=de(r),s=de(":"),o=K(),a=k("span"),c=de(l),b(n,"class","relation-name svelte-1w8rufs"),b(e,"class","relation svelte-1w8rufs")},m(u,d){R(u,e,d),x(e,n),x(n,i),x(n,s),x(e,o),x(e,a),x(a,c)},p(u,d){d&1&&r!==(r=u[4]+"")&&we(i,r),d&1&&l!==(l=u[5].join(", ")+"")&&we(c,l)},d(u){u&&T(e)}}}function _l(t){let e,n,r=t[1].entity+"",i,s,o,a=Object.entries(t[1].relations),l=[];for(let c=0;c<a.length;c+=1)l[c]=vl(gl(t,a,c));return{c(){e=k("div"),n=k("div"),i=de(r),s=K();for(let c=0;c<l.length;c+=1)l[c].c();o=K(),b(n,"class","entity-name svelte-1w8rufs"),b(e,"class","entity svelte-1w8rufs")},m(c,u){R(c,e,u),x(e,n),x(n,i),x(e,s);for(let d=0;d<l.length;d+=1)l[d]&&l[d].m(e,null);x(e,o)},p(c,u){if(u&1&&r!==(r=c[1].entity+"")&&we(i,r),u&1){a=Object.entries(c[1].relations);let d;for(d=0;d<a.length;d+=1){const f=gl(c,a,d);l[d]?l[d].p(f,u):(l[d]=vl(f),l[d].c(),l[d].m(e,o))}for(;d<l.length;d+=1)l[d].d(1);l.length=a.length}},d(c){c&&T(e),Fn(l,c)}}}function Ep(t){let e,n=t[0],r=[];for(let i=0;i<n.length;i+=1)r[i]=_l(pl(t,n,i));return{c(){e=k("div");for(let i=0;i<r.length;i+=1)r[i].c();b(e,"class","relations svelte-1w8rufs")},m(i,s){R(i,e,s);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null)},p(i,[s]){if(s&1){n=i[0];let o;for(o=0;o<n.length;o+=1){const a=pl(i,n,o);r[o]?r[o].p(a,s):(r[o]=_l(a),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},i:L,o:L,d(i){i&&T(e),Fn(r,i)}}}function Ap(t,e,n){let{entityRelations:r=[]}=e;return t.$$set=i=>{"entityRelations"in i&&n(0,r=i.entityRelations)},[r]}class Ip extends $e{constructor(e){super(),Oe(this,e,Ap,Ep,Pe,{entityRelations:0},Sp)}}const y1="",b1="",w1="",k1="",S1="",E1="",A1="",I1="";var ml=typeof window<"u"?window:{};function xp(){var t=ml.DOMParser,e=!1;try{new t().parseFromString("","text/html")&&(e=!0)}catch{}return e}function Tp(){var t=function(){};return Rp()?t.prototype.parseFromString=function(e){var n=new window.ActiveXObject("htmlfile");return n.designMode="on",n.open(),n.write(e),n.close(),n}:t.prototype.parseFromString=function(e){var n=document.implementation.createHTMLDocument("");return n.open(),n.write(e),n.close(),n},t}function Rp(){var t=!1;try{document.implementation.createHTMLDocument("").open()}catch{window.ActiveXObject&&(t=!0)}return t}xp()?ml.DOMParser:Tp();const x1="",T1="",R1="",P1="",O1="",F1="",C1="",$1="",j1="",M1="",N1="",L1="";function yl(t,e,n){const r=t.slice();return r[44]=e[n],r[46]=n,r}function bl(t){let e,n,r,i,s,o,a,l,c;i=new Lh({});let u=t[5]&&!t[6]&&wl(t);return{c(){e=k("div"),n=k("div"),r=k("div"),ae(i.$$.fragment),s=K(),o=k("div"),u&&u.c(),b(r,"class","search-bar-container"),b(o,"class","search-results-container"),b(n,"class","search-container"),G(n,"with-results",t[5]&&!t[6]),b(e,"class","backdrop")},m(d,f){R(d,e,f),x(e,n),x(n,r),ie(i,r,null),x(n,s),x(n,o),u&&u.m(o,null),a=!0,l||(c=[V(e,"keyup",t[20]),V(e,"click",t[21])],l=!0)},p(d,f){d[5]&&!d[6]?u?(u.p(d,f),f[0]&96&&w(u,1)):(u=wl(d),u.c(),w(u,1),u.m(o,null)):u&&(pe(),P(u,1,1,()=>{u=null}),ge()),(!a||f[0]&96)&&G(n,"with-results",d[5]&&!d[6])},i(d){a||(w(i.$$.fragment,d),w(u),a=!0)},o(d){P(i.$$.fragment,d),P(u),a=!1},d(d){d&&T(e),te(i),u&&u.d(),l=!1,Re(c)}}}function wl(t){let e,n,r,i;const s=[Fp,Op,Pp],o=[];function a(l,c){return l[7]&&!l[8]?0:!l[11]&&l[12].length===0&&!l[13]?1:2}return e=a(t),n=o[e]=s[e](t),{c(){n.c(),r=Ze()},m(l,c){o[e].m(l,c),R(l,r,c),i=!0},p(l,c){let u=e;e=a(l),e===u?o[e].p(l,c):(pe(),P(o[u],1,1,()=>{o[u]=null}),ge(),n=o[e],n?n.p(l,c):(n=o[e]=s[e](l),n.c()),w(n,1),n.m(r.parentNode,r))},i(l){i||(w(n),i=!0)},o(l){P(n),i=!1},d(l){o[e].d(l),l&&T(r)}}}function Pp(t){let e,n,r,i,s,o=[],a=new Map,l,c,u,d,f,h=t[8]&&kl(t),g=t[15]&&Sl(t),p=t[12];const _=y=>Ao(y[44]);for(let y=0;y<p.length;y+=1){let S=yl(t,p,y),I=_(S);a.set(I,o[y]=Al(I,S))}let v=t[16]&&Il(t),m=t[14].length>0&&xl(t),C=t[17]&&Tl();return{c(){h&&h.c(),e=K(),n=k("div"),r=k("div"),g&&g.c(),i=K(),s=k("div");for(let y=0;y<o.length;y+=1)o[y].c();l=K(),v&&v.c(),c=K(),m&&m.c(),u=K(),C&&C.c(),d=Ze(),b(s,"class","search-results"),b(r,"class","results"),G(r,"with-relations",t[14].length>0),b(n,"class","results-container")},m(y,S){h&&h.m(y,S),R(y,e,S),R(y,n,S),x(n,r),g&&g.m(r,null),x(r,i),x(r,s);for(let I=0;I<o.length;I+=1)o[I]&&o[I].m(s,null);x(s,l),v&&v.m(s,null),x(n,c),m&&m.m(n,null),R(y,u,S),C&&C.m(y,S),R(y,d,S),f=!0},p(y,S){y[8]?h?h.p(y,S):(h=kl(y),h.c(),h.m(e.parentNode,e)):h&&(h.d(1),h=null),y[15]?g?(g.p(y,S),S[0]&32768&&w(g,1)):(g=Sl(y),g.c(),w(g,1),g.m(r,i)):g&&(pe(),P(g,1,1,()=>{g=null}),ge()),S[0]&4096&&(p=y[12],pe(),o=Gl(o,S,_,1,y,p,a,s,Vl,Al,l,yl),ge()),y[16]?v?(v.p(y,S),S[0]&65536&&w(v,1)):(v=Il(y),v.c(),w(v,1),v.m(s,null)):v&&(pe(),P(v,1,1,()=>{v=null}),ge()),(!f||S[0]&16384)&&G(r,"with-relations",y[14].length>0),y[14].length>0?m?(m.p(y,S),S[0]&16384&&w(m,1)):(m=xl(y),m.c(),w(m,1),m.m(n,null)):m&&(pe(),P(m,1,1,()=>{m=null}),ge()),y[17]?C?S[0]&131072&&w(C,1):(C=Tl(),C.c(),w(C,1),C.m(d.parentNode,d)):C&&(pe(),P(C,1,1,()=>{C=null}),ge())},i(y){if(!f){w(g);for(let S=0;S<p.length;S+=1)w(o[S]);w(v),w(m),w(C),f=!0}},o(y){P(g);for(let S=0;S<o.length;S+=1)P(o[S]);P(v),P(m),P(C),f=!1},d(y){h&&h.d(y),y&&T(e),y&&T(n),g&&g.d();for(let S=0;S<o.length;S+=1)o[S].d();v&&v.d(),m&&m.d(),y&&T(u),C&&C.d(y),y&&T(d)}}}function Op(t){let e,n=t[10]("results.empty")+"",r,i,s,o,a;return{c(){e=k("strong"),r=de(n),i=K(),s=k("div"),b(s,"class","results-end")},m(l,c){R(l,e,c),x(e,r),R(l,i,c),R(l,s,c),o||(a=Gi(t[19].call(null,s)),o=!0)},p(l,c){c[0]&1024&&n!==(n=l[10]("results.empty")+"")&&we(r,n)},i:L,o:L,d(l){l&&T(e),l&&T(i),l&&T(s),o=!1,a()}}}function Fp(t){let e;function n(s,o){var a;return((a=s[9])==null?void 0:a.status)===402?$p:Cp}let r=n(t),i=r(t);return{c(){e=k("div"),i.c(),b(e,"class","error")},m(s,o){R(s,e,o),i.m(e,null)},p(s,o){r===(r=n(s))&&i?i.p(s,o):(i.d(1),i=r(s),i&&(i.c(),i.m(e,null)))},i:L,o:L,d(s){s&&T(e),i.d()}}}function kl(t){let e,n,r=t[10]("error.partial-results")+"",i;return{c(){e=k("div"),n=k("strong"),i=de(r),b(e,"class","partial-results-warning")},m(s,o){R(s,e,o),x(e,n),x(n,i)},p(s,o){o[0]&1024&&r!==(r=s[10]("error.partial-results")+"")&&we(i,r)},d(s){s&&T(e)}}}function Sl(t){let e,n,r,i;return n=new kp({}),{c(){e=k("div"),ae(n.$$.fragment),Zt(()=>t[39].call(e))},m(s,o){R(s,e,o),ie(n,e,null),r=zl(e,t[39].bind(e)),i=!0},p:L,i(s){i||(w(n.$$.fragment,s),i=!0)},o(s){P(n.$$.fragment,s),i=!1},d(s){s&&T(e),te(n),r()}}}function El(t){let e,n,r;return{c(){e=k("div"),b(e,"class","results-end")},m(i,s){R(i,e,s),n||(r=Gi(t[19].call(null,e)),n=!0)},d(i){i&&T(e),n=!1,r()}}}function Al(t,e){let n,r,i,s,o;r=new ol({props:{result:e[44]}});let a=e[46]===e[12].length-1&&El(e);return{key:t,first:null,c(){n=Ze(),ae(r.$$.fragment),i=K(),a&&a.c(),s=Ze(),this.first=n},m(l,c){R(l,n,c),ie(r,l,c),R(l,i,c),a&&a.m(l,c),R(l,s,c),o=!0},p(l,c){e=l;const u={};c[0]&4096&&(u.result=e[44]),r.$set(u),e[46]===e[12].length-1?a||(a=El(e),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null)},i(l){o||(w(r.$$.fragment,l),o=!0)},o(l){P(r.$$.fragment,l),o=!1},d(l){l&&T(n),te(r,l),l&&T(i),a&&a.d(l),l&&T(s)}}}function Il(t){let e,n;return e=new ep({props:{hasMore:t[16]}}),e.$on("loadMore",t[22]),{c(){ae(e.$$.fragment)},m(r,i){ie(e,r,i),n=!0},p(r,i){const s={};i[0]&65536&&(s.hasMore=r[16]),e.$set(s)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function xl(t){let e,n;return e=new Ip({props:{entityRelations:t[14]}}),{c(){ae(e.$$.fragment)},m(r,i){ie(e,r,i),n=!0},p(r,i){const s={};i[0]&16384&&(s.entityRelations=r[14]),e.$set(s)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function Tl(t){let e,n;return e=new qh({}),{c(){ae(e.$$.fragment)},m(r,i){ie(e,r,i),n=!0},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){te(e,r)}}}function Cp(t){let e,n=t[10]("error.search")+"",r;return{c(){e=k("strong"),r=de(n)},m(i,s){R(i,e,s),x(e,r)},p(i,s){s[0]&1024&&n!==(n=i[10]("error.search")+"")&&we(r,n)},d(i){i&&T(e)}}}function $p(t){let e,n=t[10]("error.feature-blocked")+"",r;return{c(){e=k("strong"),r=de(n)},m(i,s){R(i,e,s),x(e,r)},p(i,s){s[0]&1024&&n!==(n=i[10]("error.feature-blocked")+"")&&we(r,n)},d(i){i&&T(e)}}}function jp(t){let e,n,r,i,s,o,a=t[1]&&!!t[0]&&t[2]&&bl(t);return{c(){e=k("style"),n=K(),r=k("div"),a&&a.c(),i=K(),s=k("div"),this.c=L,b(s,"id","nuclia-glyphs-sprite"),s.hidden=!0,b(r,"class","nuclia-widget"),b(r,"data-version","__NUCLIA_DEV_VERSION__"),G(r,"dark-mode",t[4])},m(l,c){R(l,e,c),e.innerHTML=zh,R(l,n,c),R(l,r,c),a&&a.m(r,null),x(r,i),x(r,s),s.innerHTML=t[0],o=!0},p(l,c){l[1]&&l[0]&&l[2]?a?(a.p(l,c),c[0]&7&&w(a,1)):(a=bl(l),a.c(),w(a,1),a.m(r,i)):a&&(pe(),P(a,1,1,()=>{a=null}),ge()),(!o||c[0]&1)&&(s.innerHTML=l[0]),(!o||c[0]&16)&&G(r,"dark-mode",l[4])},i(l){o||(w(a),o=!0)},o(l){P(a),o=!1},d(l){l&&T(e),l&&T(n),l&&T(r),a&&a.d()}}}function Mp(t,e,n){let r,i,s,o,a,l,c,u,d,f,h,g,p,_;U(t,Qn,A=>n(5,i=A)),U(t,Yn,A=>n(6,s=A)),U(t,Ku,A=>n(7,o=A)),U(t,Qu,A=>n(8,a=A)),U(t,go,A=>n(9,l=A)),U(t,xt,A=>n(10,c=A)),U(t,Zn,A=>n(11,u=A)),U(t,Yr,A=>n(12,d=A)),U(t,ao,A=>n(13,f=A)),U(t,id,A=>n(14,h=A)),U(t,bn,A=>n(15,g=A)),U(t,ed,A=>n(16,p=A));let{backend:v="https://nuclia.cloud/api"}=e,{zone:m="europe-1"}=e,{knowledgebox:C}=e,{placeholder:y=""}=e,{lang:S=""}=e,{cdn:I=""}=e,{apikey:$=""}=e,{kbslug:O=""}=e,{account:j=""}=e,{client:oe="widget"}=e,{state:Le="PUBLISHED"}=e,{features:Z=""}=e,{standalone:We=!1}=e,{mode:ze=""}=e,ye={};function $t(A){Ut.set(A),sn.set(A||""),vt.next()}function lt(){console.log("reloadSearch"),vt.next()}const ct=$n(),Ke=(A,Ge)=>{ct.dispatchEvent&&ct.dispatchEvent(new CustomEvent(A,{detail:Ge,composed:!0}))},Ye=Zn.pipe(js(1500));U(t,Ye,A=>n(17,_=A));let kt,be=!1,Fe=!1,Te;hn(()=>{I&&fu(I),ye=(Z?Z.split(",").filter(Ge=>!!Ge):[]).reduce((Ge,Kt)=>({...Ge,[Kt]:!0}),{}),Nf({backend:v,zone:m,knowledgeBox:C,client:oe,apiKey:$,kbSlug:O,standalone:We,account:j},Le,{highlight:!0,features:ye}),Me.set(ye),y&&oo.set(y),ye.answers&&_h(),hu(),pu().subscribe(Ge=>n(0,kt=Ge)),(ye.suggestions||ye.suggestEntities)&&gh(),n(23,S=S||window.navigator.language.split("-")[0]||"en"),io(S),hh(Ke),ye.permalink&&mh(),bh();const A=document.querySelector('[data-nuclia="global-search-button"]');return A?A.addEventListener("click",Ve):console.error(`No button found to open Nuclias global search. Make sure you added 'data-nuclia="global-search-button"' to your search button.`),n(1,be=!0),(Zn.getValue()||Yr.getValue().length>0)&&Qn.set(!0),()=>{A&&A.removeEventListener("click",Ve),Lf(),ph()}});function jt(A){rd.pipe(se(1)).subscribe(Ge=>{const Kt=Date.now()-Ge.startTime;Ca("search",{searchId:Ge.searchId||"",tti:Kt}),nd.set(void 0)})}function Ve(){n(2,Fe=!Fe)}function Di(A){A.key==="Escape"&&Ve()}function Ui(A){A.target.classList.contains("backdrop")&&Ve()}function Bi(){mo.set()}function ut(){Te=this.offsetHeight,n(3,Te)}return t.$$set=A=>{"backend"in A&&n(24,v=A.backend),"zone"in A&&n(25,m=A.zone),"knowledgebox"in A&&n(26,C=A.knowledgebox),"placeholder"in A&&n(27,y=A.placeholder),"lang"in A&&n(23,S=A.lang),"cdn"in A&&n(28,I=A.cdn),"apikey"in A&&n(29,$=A.apikey),"kbslug"in A&&n(30,O=A.kbslug),"account"in A&&n(31,j=A.account),"client"in A&&n(32,oe=A.client),"state"in A&&n(33,Le=A.state),"features"in A&&n(34,Z=A.features),"standalone"in A&&n(35,We=A.standalone),"mode"in A&&n(36,ze=A.mode)},t.$$.update=()=>{t.$$.dirty[1]&32&&n(4,r=ze==="dark")},[kt,be,Fe,Te,r,i,s,o,a,l,c,u,d,f,h,g,p,_,Ye,jt,Di,Ui,Bi,S,v,m,C,y,I,$,O,j,oe,Le,Z,We,ze,$t,lt,ut]}class Np extends es{constructor(e){super();const n=document.createElement("style");n.textContent=".nuclia-widget{--color-dark-stronger:var(--custom-color-dark-stronger, #000);--color-dark-stronger-rgb:0, 0, 0;--color-light-stronger:#fff;--color-neutral-regular:hsl(0, 0%, 44%);--color-neutral-light:hsl(0, 0%, 77%);--color-neutral-lighter:hsl(0, 0%, 90%);--color-neutral-lightest:hsl(240, 7%, 97%);--color-primary-stronger:hsl(336, 100%, 24%);--color-primary-strong:hsl(336, 100%, 36%);--color-primary-regular:hsl(336, 100%, 50%);--color-primary-light:hsl(336, 100%, 73%);--color-primary-lighter:hsl(336, 100%, 90%);--color-primary-lightest:hsl(336, 100%, 96%);--color-secondary-stronger:hsl(51, 78%, 32%);--color-secondary-strong:hsl(51, 100%, 41%);--color-secondary-regular:hsl(51, 100%, 55%);--color-secondary-light:hsl(51, 100%, 75%);--color-secondary-lighter:hsl(51, 100%, 86%);--color-secondary-lightest:hsl(51, 100%, 95%);--color-tertiary-stronger:hsl(249, 100%, 24%);--color-tertiary-strong:hsl(249, 100%, 40%);--color-tertiary-regular:hsl(249, 100%, 50%);--color-tertiary-light:hsl(249, 100%, 65%);--color-tertiary-lighter:hsl(249, 100%, 92%);--color-tertiary-lightest:hsl(249, 100%, 96%);--spacer:8px;--rhythm-0_25:calc(var(--spacer) * 0.25);--rhythm-0_5:calc(var(--spacer) * 0.5);--rhythm-1:var(--spacer);--rhythm-1_5:calc(var(--spacer) * 1.5);--rhythm-2:calc(var(--spacer) * 2);--rhythm-2_5:calc(var(--spacer) * 2.5);--rhythm-3:calc(var(--spacer) * 3);--rhythm-4:calc(var(--spacer) * 4);--rhythm-5:calc(var(--spacer) * 5);--rhythm-6:calc(var(--spacer) * 6);--rhythm-7:calc(var(--spacer) * 7);--rhythm-8:calc(var(--spacer) * 8);--rhythm-9:calc(var(--spacer) * 9);--rhythm-10:calc(var(--spacer) * 10);--rhythm-11:calc(var(--spacer) * 11);--rhythm-12:calc(var(--spacer) * 12);--rhythm-14:calc(var(--spacer) * 14);--rhythm-16:calc(var(--spacer) * 16);--rhythm-20:calc(var(--spacer) * 20);--rhythm-22:calc(var(--spacer) * 22);--rhythm-24:calc(var(--spacer) * 24);--rhythm-27:calc(var(--spacer) * 27);--rhythm-28:calc(var(--spacer) * 28);--rhythm-32:calc(var(--spacer) * 32);--rhythm-36:calc(var(--spacer) * 36);--rhythm-39:calc(var(--spacer) * 39);--rhythm-40:calc(var(--spacer) * 40);--rhythm-46:calc(var(--spacer) * 46);--rhythm-48:calc(var(--spacer) * 48);--rhythm-53:calc(var(--spacer) * 53);--rhythm-56:calc(var(--spacer) * 56);--rhythm-64:calc(var(--spacer) * 64);--rhythm-75:calc(var(--spacer) * 75);--rhythm-80:calc(var(--spacer) * 80);--font-size-base:16px;--font-size-medium:14px;--font-size-small:12px;--font-size-xsmall:10px;--font-weight-body:300;--font-weight-medium:500;--font-weight-semi-bold:600;--font-weight-bold:700;--nuclia-family:Inter, sans-serif;--font-family-body:var(--custom-font-family-body, var(--nuclia-family));--font-size-title-m:var(--font-size-base);--font-size-title-s:var(--font-size-medium);--font-weight-title-m:var(--font-weight-semi-bold);--line-height-body-xs:var(--font-size-base);--line-height-body-s:calc(var(--font-size-base) * 1.125);--line-height-body:calc(var(--font-size-base) * 1.25);--line-height-title-m-mobile:calc(var(--font-size-base) * 1.625);--line-height-title-m:calc(var(--font-size-base) * 1.75);--line-height-title-s:calc(var(--font-size-base) * 1.375);--line-height-title-xs:calc(var(--font-size-base) * 1.375);--line-height-title-xxs:calc(var(--font-size-base) * 1.375);--duration--superfast:0.16s;--duration--fast:0.24s;--duration--moderate:0.48s;--duration--slow:0.8s;--transition-superfast:var(--duration--superfast) ease-in-out;--transition-fast:var(--duration--fast) ease;--transition-moderate:var(--duration--moderate) ease;--transition-slow:var(--duration--slow) cubic-bezier(0.6, 0, 0.4, 1);--border-radius:var(--rhythm-0_25);--color-backdrop:rgba(var(--color-dark-stronger-rgb), 0.5);--default-modal-width:calc(100vw - var(--rhythm-1_5));--shadow-modal:0 var(--rhythm-0_25) var(--rhythm-1) rgba(var(--color-dark-stronger-rgb), 0.2);--z-index-modal:10010;--z-index-modal-backdrop:10000;--resource-modal-width:var(--default-modal-width);--resource-modal-width-md:80vw;--resource-modal-height:calc(100vh - var(--rhythm-16));--resource-modal-height-md:85vh;--color-scrollbar-track:var(--color-light-stronger);--color-scrollbar-thumb:var(--color-dark-stronger);--focus-shadow:inset 0 0 0 var(--rhythm-0_25) var(--color-primary-lighter);--search-bar-border-color:var(--border-color);--search-bar-border-focus-color:var(--border-focus-color);--search-bar-border:1px solid var(--search-bar-border-color);--search-bar-border-focus:1px solid var(--search-bar-border-focus-color);--search-bar-border-radius:0;--search-bar-max-width:var(--rhythm-56);--expander-header-height:var(--rhythm-5);--player-bar-height:var(--rhythm-5);--border-color:var(--custom-border-color, var(--color-dark-stronger));--border-focus-color:var(--custom-border-focus-color, var(--color-primary-regular));--link-color:var(--custom-link-color, var(--color-primary-regular));--text-color:var(--custom-text-color, var(--color-dark-stronger));--selected-text-color:var(--custom-selected-text-color, inherit);--selected-background-color:var(--custom-selected-background-color, var(--color-primary-lightest));--hover-background-color:var(--custom-hover-background-color, var(--color-neutral-lightest));--thumbnail-background-color:var(--custom-thumbnail-background-color, var(--color-neutral-lightest));--modal-background-color:var(--custom-modal-background-color, var(--color-neutral-lighter));--dropdown-background-color:var(--custom-dropdown-background-color, var(--color-light-stronger));--container-background-color:var(--custom-container-background-color, var(--color-light-stronger));box-sizing:border-box;color:var(--text-color);font-family:var(--font-family-body);font-size:var(--font-size-base);font-weight:var(--font-weight-body);line-height:var(--line-height-body);text-align:left}.nuclia-widget.dark-mode{--border-color:var(--color-neutral-lightest);--text-color:var(--color-neutral-lightest);--selected-text-color:var(--color-dark-stronger);--hover-background-color:#2b2d30;--thumbnail-background-color:#2b2d30;--modal-background-color:#303136;--dropdown-background-color:#26282b;--container-background-color:#1f2023}.backdrop{--top-spacing:var(--rhythm-8);--side-spacing:var(--rhythm-2);align-items:start;background:rgba(0, 0, 0, 0.5);bottom:0;display:flex;justify-content:center;left:0;padding-top:var(--top-spacing);position:fixed;right:0;top:0;z-index:10000}.search-container{--search-bar-height:var(--rhythm-6);background:#fff;max-height:calc(100vh - var(--top-spacing) * 2);overflow:hidden;width:calc(100% - var(--side-spacing) * 2)}.search-container:not(.with-results){height:var(--search-bar-height)}.search-container.with-results .search-bar-container{border-bottom:1px solid var(--color-neutral-light)}.search-container .search-bar-container{position:sticky;top:0;z-index:1}.search-container .search-bar-container,.search-container .search-results-container{background:inherit}.search-container .search-results-container{--vertical-spacing:var(--rhythm-1)}.search-container .search-results-container .results{max-height:calc(100vh - var(--top-spacing) * 2 - var(--search-bar-height));overflow:auto}.search-container .search-results-container .search-results{padding:var(--vertical-spacing) 0}@media(max-width: 639px){.backdrop{max-height:calc(100vh - var(--top-spacing) * 2 - var(--rhythm-2))}}@media(min-width: 640px){.backdrop{--top-spacing:var(--rhythm-14)}.search-container{max-width:784px;width:80%}}",this.shadowRoot.appendChild(n),Oe(this,{target:this.shadowRoot,props:Ul(this.attributes),customElement:!0},Mp,jp,Pe,{backend:24,zone:25,knowledgebox:26,placeholder:27,lang:23,cdn:28,apikey:29,kbslug:30,account:31,client:32,state:33,features:34,standalone:35,mode:36,search:37,reloadSearch:38},null,[-1,-1]),e&&(e.target&&R(e.target,this,e.anchor),e.props&&(this.$set(e.props),ke()))}static get observedAttributes(){return["backend","zone","knowledgebox","placeholder","lang","cdn","apikey","kbslug","account","client","state","features","standalone","mode","search","reloadSearch"]}get backend(){return this.$$.ctx[24]}set backend(e){this.$$set({backend:e}),ke()}get zone(){return this.$$.ctx[25]}set zone(e){this.$$set({zone:e}),ke()}get knowledgebox(){return this.$$.ctx[26]}set knowledgebox(e){this.$$set({knowledgebox:e}),ke()}get placeholder(){return this.$$.ctx[27]}set placeholder(e){this.$$set({placeholder:e}),ke()}get lang(){return this.$$.ctx[23]}set lang(e){this.$$set({lang:e}),ke()}get cdn(){return this.$$.ctx[28]}set cdn(e){this.$$set({cdn:e}),ke()}get apikey(){return this.$$.ctx[29]}set apikey(e){this.$$set({apikey:e}),ke()}get kbslug(){return this.$$.ctx[30]}set kbslug(e){this.$$set({kbslug:e}),ke()}get account(){return this.$$.ctx[31]}set account(e){this.$$set({account:e}),ke()}get client(){return this.$$.ctx[32]}set client(e){this.$$set({client:e}),ke()}get state(){return this.$$.ctx[33]}set state(e){this.$$set({state:e}),ke()}get features(){return this.$$.ctx[34]}set features(e){this.$$set({features:e}),ke()}get standalone(){return this.$$.ctx[35]}set standalone(e){this.$$set({standalone:e}),ke()}get mode(){return this.$$.ctx[36]}set mode(e){this.$$set({mode:e}),ke()}get search(){return this.$$.ctx[37]}get reloadSearch(){return this.$$.ctx[38]}}customElements.define("nuclia-global-search",Np)});
